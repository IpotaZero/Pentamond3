{"version":3,"file":"Run.js","sources":["../src/BGM.ts","../src/EventManager.ts","../src/PageManager.ts","../src/Sound.ts","../src/Utils.ts","../src/TimeManager.ts","../src/LoopManager.ts","../src/Interaction/AutoKeyboardManager.ts","../src/Interaction/GamepadInput.ts","../src/Interaction/GamepadManager.ts","../src/Interaction/KeyboardManager.ts","../src/Interaction/Input.ts","../src/Interaction/InputManager.ts","../src/Game/GameMode.ts","../src/Settings.ts","../src/PlayBackground.ts","../src/Game/Modes/Mode1.ts","../src/Game/Modes/Mode2.ts","../src/BlockOperate/Block.ts","../src/BlockOperate/MondInfo.ts","../src/Trick.ts","../src/BlockOperate/BlockManager.ts","../src/BlockOperate/NextManager.ts","../src/BlockOperate/Monoiamond.ts","../src/BlockOperate/Pentiamond.ts","../src/BlockOperate/MondOperator.ts","../src/Game/NuisanceMondManager.ts","../src/CanvasManager.ts","../src/Game/InformationLabelManager.ts","../src/Game/GamePlayer.ts","../node_modules/lz-string/libs/lz-string.js","../src/DataCompression.ts","../src/ScreenInteraction.ts","../src/Run.ts"],"sourcesContent":["export class BGM {\r\n    private static context: AudioContext;\r\n    private static gain: GainNode;\r\n    private static audio: AudioBufferSourceNode;\r\n    private static audioBuffer: AudioBuffer;\r\n    private static reversedBuffer: AudioBuffer;\r\n\r\n    /**\r\n     * BGM自体のボリューム\r\n     */\r\n    private static volume = 1;\r\n    /**\r\n     * 音声ファイルそれぞれのボリューム\r\n     */\r\n    private static sourceVolume = 1;\r\n\r\n    static onEnded = {\r\n        promise: Promise.resolve(),\r\n        cancel: () => {},\r\n    };\r\n\r\n    // 現在の論理的な再生位置を追跡\r\n    private static logicalTime: typeof BGM.Time;\r\n\r\n    private static initialized = false;\r\n    static init(): void {\r\n        if (this.initialized) throw new Error(\"BGM is already initialized! Ensure that you are not calling BGM.init() multiple times.\");\r\n        this.initialized = true;\r\n\r\n        this.context = new AudioContext();\r\n        this.context.suspend();\r\n        this.gain = this.context.createGain();\r\n        this.gain.connect(this.context.destination);\r\n\r\n        this.logicalTime = BGM.Time;\r\n    }\r\n\r\n    // 音源を読み込む\r\n    static async fetch({ src, loopStart, loopEnd, sourceVolume = 1 }: { src: string; loopStart?: number; loopEnd?: number; sourceVolume?: number }): Promise<void> {\r\n        this.checkInit();\r\n\r\n        this.context.suspend();\r\n\r\n        this.sourceVolume = sourceVolume;\r\n        this.setVolume(this.volume);\r\n\r\n        const audioData = await (await fetch(src)).arrayBuffer();\r\n        this.audioBuffer = await this.context.decodeAudioData(audioData);\r\n        this.reversedBuffer = this.reverseBuffer(this.audioBuffer);\r\n\r\n        // 時間管理をリセット\r\n        this.logicalTime.isReversed = false;\r\n\r\n        this.logicalTime.currentTime = 0;\r\n        this.logicalTime.lastUpdateTime = 0;\r\n        this.logicalTime.lastUpdateContextTime = this.context.currentTime;\r\n\r\n        this.logicalTime.loopStart = loopStart ?? 0;\r\n        this.logicalTime.loopEnd = loopEnd ?? this.audioBuffer.duration;\r\n        this.logicalTime.duration = this.audioBuffer.duration;\r\n\r\n        this.reconnect();\r\n    }\r\n\r\n    static play(): Promise<void> {\r\n        this.checkInit();\r\n\r\n        return this.context.resume();\r\n    }\r\n\r\n    static pause(): Promise<void> {\r\n        this.checkInit();\r\n        return this.context.suspend();\r\n    }\r\n\r\n    /**\r\n     * second秒かけてフェードアウトした後、止める\r\n     * @param second 秒\r\n     * @returns\r\n     */\r\n    static async fadeOut(second: number): Promise<void> {\r\n        this.checkInit();\r\n\r\n        await this.fade(0.001, second);\r\n        await this.pause();\r\n    }\r\n\r\n    /**\r\n     * play開始した後、second秒かけてフェードインする\r\n     * @param second 秒\r\n     * @returns\r\n     */\r\n    static async fadeIn(second: number): Promise<void> {\r\n        this.checkInit();\r\n\r\n        const volume = this.volume;\r\n        this.setVolume(0.001);\r\n        await this.play();\r\n        await this.fade(volume, second);\r\n    }\r\n\r\n    /**\r\n     * second秒かけてフェードする\r\n     * @param volume 目標ボリューム\r\n     * @param second 秒\r\n     * @returns\r\n     */\r\n    static fade(volume: number, second: number): Promise<void> {\r\n        this.checkInit();\r\n\r\n        this.gain.gain.cancelScheduledValues(0);\r\n        this.gain.gain.linearRampToValueAtTime(volume * this.sourceVolume, this.context.currentTime + second);\r\n\r\n        return new Promise<void>((resolve) => {\r\n            setTimeout(() => {\r\n                resolve();\r\n            }, second * 1000);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 再生方向を切り替える\r\n     */\r\n    static reverse(): void {\r\n        this.checkInit();\r\n\r\n        this.logicalTime.isReversed = !this.logicalTime.isReversed;\r\n        this.reconnect();\r\n    }\r\n\r\n    static setCurrentTime(second: number) {\r\n        this.checkInit();\r\n\r\n        this.logicalTime.setCurrentTime(this.context.currentTime, second);\r\n        this.reconnect();\r\n    }\r\n\r\n    static getCurrentTime(): number {\r\n        this.checkInit();\r\n\r\n        this.logicalTime.updateCurrentTime(this.context.currentTime);\r\n        return this.logicalTime.currentTime;\r\n    }\r\n\r\n    static isPlaying(): boolean {\r\n        this.checkInit();\r\n        return this.context.state === \"running\";\r\n    }\r\n\r\n    static setVolume(volume: number): void {\r\n        this.checkInit();\r\n\r\n        this.gain.gain.cancelScheduledValues(0);\r\n\r\n        this.volume = volume;\r\n        this.gain.gain.value = this.volume * this.sourceVolume;\r\n    }\r\n\r\n    // AudioBufferを反転させる（逆再生用）\r\n    private static reverseBuffer(buffer: AudioBuffer) {\r\n        const reversedBuffer = this.context.createBuffer(buffer.numberOfChannels, buffer.length, buffer.sampleRate);\r\n\r\n        for (let channel = 0; channel < buffer.numberOfChannels; channel++) {\r\n            const originalData = buffer.getChannelData(channel);\r\n            const reversedData = reversedBuffer.getChannelData(channel);\r\n            for (let i = 0; i < originalData.length; i++) {\r\n                reversedData[i] = originalData[originalData.length - i - 1];\r\n            }\r\n        }\r\n\r\n        return reversedBuffer;\r\n    }\r\n\r\n    private static reconnect() {\r\n        this.checkInit();\r\n\r\n        if (this.audio) {\r\n            this.audio.stop();\r\n            this.audio.disconnect();\r\n            this.onEnded.cancel();\r\n        }\r\n\r\n        this.audio = this.context.createBufferSource();\r\n        this.audio.loop = true;\r\n        this.audio.buffer = this.logicalTime.isReversed ? this.reversedBuffer : this.audioBuffer;\r\n        [this.audio.loopStart, this.audio.loopEnd] = this.logicalTime.getActualLoopTime();\r\n        this.audio.connect(this.gain);\r\n\r\n        this.onEnded.promise = new Promise((resolve) => {\r\n            this.onEnded.cancel = resolve;\r\n            this.audio.onended = () => {\r\n                resolve();\r\n            };\r\n        });\r\n\r\n        // 現在の論理時間を更新\r\n        this.logicalTime.updateCurrentTime(this.context.currentTime);\r\n        this.audio.start(0, this.logicalTime.getActualOffset());\r\n    }\r\n\r\n    private static checkInit() {\r\n        if (!this.context) {\r\n            throw new Error(\"BGM is not initialized. Call BGM.init() before using BGM.\");\r\n        }\r\n    }\r\n}\r\n\r\nexport namespace BGM {\r\n    export class Time {\r\n        static currentTime = 0;\r\n        static lastUpdateTime = 0;\r\n        static lastUpdateContextTime = 0;\r\n\r\n        static loopStart = 0;\r\n        static loopEnd = 0;\r\n        static duration = 0;\r\n\r\n        static isReversed = false;\r\n\r\n        static setCurrentTime(contextTime: number, currentTime: number) {\r\n            currentTime = this.bound(currentTime);\r\n\r\n            this.currentTime = currentTime;\r\n            this.lastUpdateTime = currentTime;\r\n            this.lastUpdateContextTime = contextTime;\r\n        }\r\n\r\n        static getActualOffset() {\r\n            if (this.isReversed) {\r\n                // 逆再生の場合、論理時間を反転させる\r\n                return this.duration - this.currentTime;\r\n            } else {\r\n                // 通常再生の場合\r\n                return this.currentTime;\r\n            }\r\n        }\r\n\r\n        static getActualLoopTime(): [number, number] {\r\n            if (this.isReversed) {\r\n                return [this.duration - this.loopEnd, this.duration - this.loopStart];\r\n            } else {\r\n                return [this.loopStart, this.loopEnd];\r\n            }\r\n        }\r\n\r\n        static updateCurrentTime(contextTime: number) {\r\n            // 必ず0以上\r\n            const elapsedContextTime = contextTime - this.lastUpdateContextTime;\r\n\r\n            if (this.isReversed) {\r\n                // 逆再生の場合、時間が逆向きに進む\r\n                this.currentTime = this.lastUpdateTime - elapsedContextTime;\r\n            } else {\r\n                // 通常再生の場合\r\n                this.currentTime = this.lastUpdateTime + elapsedContextTime;\r\n            }\r\n\r\n            this.currentTime = this.bound(this.currentTime);\r\n\r\n            this.lastUpdateTime = this.currentTime;\r\n            this.lastUpdateContextTime = contextTime;\r\n        }\r\n\r\n        // ループ範囲内に収める\r\n        private static bound(currentTime: number) {\r\n            const loopDuration = this.loopEnd - this.loopStart;\r\n\r\n            // ループ範囲外へ向かおうとするときだけ修正する\r\n            // ループ範囲外から範囲内へ向かっているときは修正しない\r\n            if (this.isReversed && currentTime < this.loopStart) {\r\n                return this.loopEnd - ((this.loopStart - currentTime) % loopDuration);\r\n            }\r\n\r\n            if (!this.isReversed && currentTime > this.loopEnd) {\r\n                return this.loopStart + ((currentTime - this.loopStart) % loopDuration);\r\n            }\r\n\r\n            return currentTime;\r\n        }\r\n    }\r\n}\r\n","/**\r\n * MyEventに用いられる一意のid\r\n */\r\nexport type EventId = number | string;\r\n\r\n/**\r\n * イベント情報\r\n */\r\nexport type MyEvent = {\r\n    id: EventId;\r\n    handler: Function;\r\n    classNames: string[];\r\n};\r\n\r\n/**\r\n * MyEventListenerが実装されたクラスが呼び出すイベントを管理する\r\n */\r\nexport class EventManager {\r\n    /**\r\n     * 登録されているイベント\r\n     */\r\n    private static eventList: MyEvent[] = [];\r\n\r\n    /**\r\n     * 登録されているイベントのid\r\n     */\r\n    static get ids() {\r\n        return this.eventList.map(({ id }) => id);\r\n    }\r\n\r\n    /**\r\n     * @param id イベントのid　すでに存在すると失敗する　指定しない場合は自動で割り振る\r\n     * @param handler イベントの処理　必須\r\n     * @param classNames イベントのクラス\r\n     * @returns 追加された/しようとしたイベントのid\r\n     */\r\n    //指定されたhandlerやその他の情報を持つeventを追加する\r\n    //idは指定しなかった場合、被らないように自動的に設定される\r\n    static addEvent({ id, handler, classNames = [] }: { id?: EventId; handler: Function; classNames?: string[] }): EventId {\r\n        if (id) {\r\n            if (!this.ids.includes(id)) {\r\n                this.eventList.push({ id, handler, classNames });\r\n            } else {\r\n                console.error(\"idが重複しているため、このEventは登録に失敗しました\");\r\n            }\r\n            return id;\r\n        } else {\r\n            id = Date.now();\r\n            const ids = this.ids;\r\n            while (ids.includes(id)) {\r\n                id++;\r\n            }\r\n            this.eventList.push({ id, handler, classNames });\r\n            return id;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * イベントの登録解除\r\n     * @param eventId 登録を解除したいイベントのid\r\n     */\r\n    static removeEvent(eventId: EventId): void {\r\n        this.eventList = this.eventList.filter(({ id }) => id != eventId);\r\n    }\r\n\r\n    /**\r\n     * イベントの登録解除\r\n     * @param eventIds 登録を解除したいイベントのidの配列\r\n     */\r\n    static removeEvents(eventIds: EventId[]): void {\r\n        this.eventList = this.eventList.filter(({ id }) => !eventIds.includes(id));\r\n    }\r\n\r\n    /**\r\n     * イベントの一括登録解除\r\n     * @param className 登録を解除したいイベントのclassName\r\n     */\r\n    static removeEventsByClassName(className: string): void {\r\n        this.eventList = this.eventList.filter(({ classNames }) => !classNames.includes(className));\r\n    }\r\n\r\n    /**\r\n     * @param eventId イベントのid\r\n     * @returns idが登録されているか\r\n     */\r\n    static hasAlreadyAdded(eventId: EventId): boolean {\r\n        if (!this.ids.includes(eventId)) {\r\n            console.error(\"指定されたidのEventは登録されていません\");\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * イベントの実行\r\n     * @param eventId 実行したいイベントのid\r\n     */\r\n    static executeEvent(eventId: EventId): void {\r\n        if (this.hasAlreadyAdded(eventId)) {\r\n            return;\r\n        }\r\n        this.eventList.filter(({ id }) => id == eventId)[0].handler();\r\n    }\r\n\r\n    /**\r\n     * イベントの一括実行\r\n     * @param className 実行したいイベントのclassName\r\n     */\r\n    static executeEventsByClassName(className: string) {\r\n        this.eventList\r\n            .filter(({ classNames }) => classNames.includes(className))\r\n            .forEach(({ handler }) => {\r\n                handler();\r\n            });\r\n    }\r\n\r\n    //MyEventListenerを実装しているクラスで呼ばれることを想定している\r\n    /**\r\n     * イベントの一括実行\r\n     * @param className 実行したいイベントのclassName\r\n     * @param eventIds 実行したいイベントのidが入った配列\r\n     */\r\n    static executeListeningEvents(className: string, eventIds: EventId[]) {\r\n        this.eventList\r\n            .filter(({ id, classNames }) => eventIds.includes(id) && classNames.includes(className))\r\n            .forEach(({ handler }) => {\r\n                handler();\r\n            });\r\n    }\r\n\r\n    static consoleEventClasses() {\r\n        console.log(this.eventList.map(({ classNames }) => classNames));\r\n    }\r\n}\r\n\r\n/**\r\n * イベントを呼ぶことがあるクラス用のインターフェース\r\n */\r\nexport type MyEventListener = {\r\n    eventClassNames: string[];\r\n    eventIds?: EventId[];\r\n    addEvent: (classNames: string[], handler: Function) => EventId;\r\n};\r\n","import { EventId, EventManager, MyEventListener } from \"./EventManager.js\";\r\n\r\nexport type PageManagerOption = {\r\n    eventIgnore?: boolean;\r\n};\r\n\r\nexport class PageManager implements MyEventListener {\r\n    private initialized: boolean = false;\r\n    private currentPage: HTMLElement | null = null;\r\n    private displayingPages: HTMLElement[] = [];\r\n    private pageMemory: string[][] = [];\r\n    private static instance: PageManager;\r\n    /**\r\n     * @param pageIsReady initが終了したとき\r\n     * @param pageOpened -ページ名　ページが進んだとき　または　同一レイヤーのページに戻るとき\r\n     * @param pageChanged -ページ名　ページが変更されたとき\r\n     * @param setPage -ページ名　ページを進んだ時\r\n     * @param backPages ページを戻った時\r\n     * @param pageBecomeValid ページが有効になったとき\r\n     * @param pageBecomeInvalid ページが無効になったとき\r\n     */\r\n    readonly eventClassNames: string[] = [\"pageIsReady\", \"pageOpened\", \"pageChanged\", \"setPage\", \"backPages\", \"pageBecomeValid\", \"pageBecomeInvalid\", \"setSubPage\"];\r\n    //setPage-ページ名、pageChanged-ページ名\r\n    addEvent(classNames: string[], handler: Function): EventId {\r\n        return EventManager.addEvent({ classNames, handler });\r\n    }\r\n\r\n    //シングルトン\r\n    constructor() {\r\n        if (PageManager.instance) {\r\n            return PageManager.instance;\r\n        }\r\n        PageManager.instance = this;\r\n    }\r\n\r\n    /**\r\n     * 初期化されているか\r\n     */\r\n    get g$initialized(): boolean {\r\n        return this.initialized;\r\n    }\r\n\r\n    /**\r\n     * 現在のページの要素\r\n     */\r\n    get g$currentPage(): HTMLElement | null {\r\n        return this.currentPage;\r\n    }\r\n\r\n    /**\r\n     * 現在のページのid\r\n     */\r\n    get g$currentPageId(): string | null {\r\n        return this.currentPage ? this.currentPage.id : null;\r\n    }\r\n\r\n    /**\r\n     * 表示されているページの配列\r\n     */\r\n    get g$displayingPages(): HTMLElement[] {\r\n        return [...this.displayingPages];\r\n    }\r\n\r\n    /**\r\n     * ページの遷移記録\r\n     */\r\n    get g$pageMemory(): string[][] {\r\n        return structuredClone(this.pageMemory);\r\n    }\r\n\r\n    /**\r\n     * 現在のページのレイヤー\r\n     */\r\n    get g$currentLayer(): number | null {\r\n        return parseInt(this.currentPage!.dataset.layer || \"0\");\r\n    }\r\n\r\n    //DOMが読み込まれてから読み込んでね\r\n    init() {\r\n        if (this.initialized) {\r\n            return;\r\n        }\r\n        //最初に開くページ\r\n        const initialPageId = document.body.dataset.initialPage || \"title\";\r\n        this.setPage(initialPageId);\r\n\r\n        //pageを戻る処理\r\n        document.querySelectorAll(\".back, [data-back]\").forEach((element) => {\r\n            element.addEventListener(\"click\", () => {\r\n                const back = parseInt((element as HTMLElement).dataset.back || \"1\");\r\n                this.backPages(back);\r\n            });\r\n        });\r\n\r\n        //page遷移処理\r\n        document.querySelectorAll(\"[data-page]\").forEach((element) => {\r\n            element.addEventListener(\"click\", () => {\r\n                const pageId = (element as HTMLElement).dataset.page;\r\n                if (pageId) {\r\n                    this.setPage(pageId);\r\n                }\r\n            });\r\n        });\r\n\r\n        //layerの反映\r\n        document.querySelectorAll(\".page[data-layer]\").forEach((element) => {\r\n            const layer = (element as HTMLElement).dataset.layer;\r\n            (element as HTMLElement).style.zIndex = layer || \"0\";\r\n        });\r\n\r\n        //subPageの挙動\r\n        document.querySelectorAll<HTMLElement>(\".page:has(.subPageNext)\").forEach((element) => {\r\n            const prevElements = Array.from(element.querySelectorAll<HTMLElement>(\".subPagePrev\"));\r\n            const nextElements = Array.from(element.querySelectorAll<HTMLElement>(\".subPageNext\"));\r\n            prevElements.forEach((prev) => {\r\n                prev.addEventListener(\"click\", () => {\r\n                    const length = Array.from(element.querySelectorAll<HTMLElement>(\".subPage\")).length;\r\n                    const prevIndex = (length + this.getSubPageIndex(element)! - 1) % length;\r\n                    this.setSubPage(prevIndex);\r\n                });\r\n            });\r\n            nextElements.forEach((next) => {\r\n                next.addEventListener(\"click\", () => {\r\n                    const length = Array.from(element.querySelectorAll<HTMLElement>(\".subPage\")).length;\r\n                    const nextIndex = (this.getSubPageIndex(element)! + 1) % length;\r\n                    this.setSubPage(nextIndex);\r\n                });\r\n            });\r\n        });\r\n\r\n        this.initialized = true;\r\n        EventManager.executeEventsByClassName(\"pageIsReady\");\r\n    }\r\n\r\n    //すべてのページの表示状態を設定する\r\n    private setPages(pageIds: string[], options?: PageManagerOption) {\r\n        // 新しいページを取得\r\n        const nextPages = pageIds.map((pageId) => document.getElementById(pageId) || null);\r\n        if (nextPages.includes(null)) {\r\n            console.error(\"指定されたpageIdsに存在しないページが含まれていました\");\r\n            return;\r\n        }\r\n\r\n        this.displayingPages.forEach((page) => {\r\n            page.style.display = \"none\";\r\n        });\r\n\r\n        nextPages.forEach((page) => {\r\n            page!.style.display = \"flex\";\r\n        });\r\n\r\n        let preliminaryCurrentPage: HTMLElement | null = null;\r\n        nextPages.forEach((page) => {\r\n            const layer = parseInt(page!.dataset.layer || \"0\");\r\n            let preliminaryMaxLayer = preliminaryCurrentPage ? parseInt(preliminaryCurrentPage.dataset.layer || \"0\") : 0;\r\n            if (preliminaryMaxLayer < layer || preliminaryCurrentPage == null) {\r\n                preliminaryCurrentPage = page;\r\n                preliminaryMaxLayer = layer;\r\n            } else if (preliminaryMaxLayer == layer && preliminaryCurrentPage != null) {\r\n                console.error(\"最大layerが一意になっていません\");\r\n            }\r\n        });\r\n\r\n        this.currentPage = preliminaryCurrentPage as HTMLElement | null;\r\n        this.displayingPages = nextPages as HTMLElement[];\r\n        this.pageMemory.push(pageIds);\r\n        this.setSubPage(0, { eventIgnore: true });\r\n        if (!(options && options.eventIgnore)) {\r\n            EventManager.executeEventsByClassName(\"pageChanged\");\r\n            EventManager.executeEventsByClassName(\"pageChanged-\" + (this.currentPage ? this.currentPage.id : \"\"));\r\n        }\r\n    }\r\n\r\n    //指定したpageIdのページを開く\r\n    //現在のページと同じlayerを開く場合は現在のページは閉じ、上のlayerを開く場合は開いたままにする\r\n    setPage(pageId: string, options?: PageManagerOption) {\r\n        // 新しいページを取得\r\n        const nextPage = document.getElementById(pageId);\r\n        if (!nextPage) {\r\n            console.error(\"指定されたpageIdのページは存在しません:\" + pageId);\r\n            return;\r\n        }\r\n\r\n        let nextDisplayingPages = [...this.displayingPages];\r\n\r\n        // 現在のページを非表示にする\r\n        if (this.currentPage) {\r\n            const currentLayer = parseInt(this.currentPage.dataset.layer || \"0\");\r\n            const nextLayer = parseInt(nextPage.dataset.layer || \"0\");\r\n            //同じlayerなら元のページは非表示\r\n            if (nextLayer == currentLayer) {\r\n                nextDisplayingPages = nextDisplayingPages.filter((page) => page.id != this.currentPage!.id);\r\n            } else if (nextLayer < currentLayer) {\r\n                throw new Error(\"現在のlayerを下回るlayerのページには遷移できません\");\r\n            }\r\n        }\r\n        nextDisplayingPages.push(nextPage);\r\n        this.setPages(\r\n            nextDisplayingPages.map((page) => page.id),\r\n            options\r\n        );\r\n        if (!(options && options.eventIgnore)) {\r\n            EventManager.executeEventsByClassName(\"setPage\");\r\n            EventManager.executeEventsByClassName(\"setPage-\" + pageId);\r\n            EventManager.executeEventsByClassName(\"pageOpened\");\r\n            EventManager.executeEventsByClassName(\"pageOpened-\" + pageId);\r\n        }\r\n    }\r\n\r\n    //numberの数だけ前のページの状態に戻る\r\n    backPages(number: number, options?: PageManagerOption) {\r\n        if (number == -1) {\r\n            number = this.pageMemory.length - 1;\r\n        }\r\n        if (this.pageMemory.length < number + 1 || number < -1) {\r\n            console.log(\"ページ遷移の記録がないため戻ることはできません\");\r\n            return;\r\n        }\r\n        const currentLayer = this.g$currentLayer!;\r\n        this.setPages(this.pageMemory[this.pageMemory.length - number - 1], options);\r\n        this.pageMemory = this.pageMemory.slice(0, -number - 1);\r\n        if (!(options && options.eventIgnore)) {\r\n            if (currentLayer == this.g$currentLayer) {\r\n                EventManager.executeEventsByClassName(\"pageOpened\");\r\n                EventManager.executeEventsByClassName(\"pageOpened-\" + this.currentPage!.id);\r\n            }\r\n            EventManager.executeEventsByClassName(\"backPages\");\r\n        }\r\n    }\r\n\r\n    //すべてのページを非表示にする\r\n    //invalidPanelが存在する場合は表示する\r\n    set s$valid(valid: boolean) {\r\n        this.displayingPages.forEach((page) => {\r\n            page.style.display = valid ? \"flex\" : \"none\";\r\n        });\r\n        const invalidPanel = document.getElementById(\"invalidPanel\");\r\n        if (invalidPanel) {\r\n            invalidPanel.style.display = valid ? \"none\" : \"flex\";\r\n        }\r\n        EventManager.executeEventsByClassName(valid ? \"pageBecomeValid\" : \"pageBecomeInvalid\");\r\n    }\r\n\r\n    /**\r\n     * @param pageId 指定するpageId\r\n     * @returns 最後に指定したpageを開いている状態は何回前か 存在しなければ-1\r\n     */\r\n    getLatestBackIndex(pageId: string): number {\r\n        const index =\r\n            this.pageMemory.length -\r\n            1 -\r\n            this.pageMemory.findLastIndex((memory) => {\r\n                return memory.includes(pageId);\r\n            });\r\n        return index == this.pageMemory.length ? -1 : index;\r\n    }\r\n\r\n    /**\r\n     * 最後に指定したpageを開いている状態まで戻す　存在しなければ何もしない\r\n     * @param pageId 指定するpageId\r\n     */\r\n    backLatestPage(pageId: string, options?: PageManagerOption) {\r\n        const index = this.getLatestBackIndex(pageId);\r\n        if (index == -1) {\r\n            return;\r\n        }\r\n        this.backPages(index, options);\r\n    }\r\n\r\n    setSubPage(index: number, options?: PageManagerOption) {\r\n        if (!this.currentPage || !this.currentPage.querySelector(`.subPage`)) {\r\n            return;\r\n        }\r\n        const subPages = Array.from(this.currentPage.querySelectorAll<HTMLElement>(\".subPage\"));\r\n        const subPageLabel = this.currentPage.querySelector(\".subPageLabel\");\r\n        subPages.forEach((subPage, i) => {\r\n            if (i == index) {\r\n                subPage.style.display = \"\";\r\n                if (subPageLabel) {\r\n                    subPageLabel.innerHTML = `${index + 1} / ${subPages.length}`;\r\n                }\r\n            } else {\r\n                subPage.style.display = \"none\";\r\n            }\r\n        });\r\n        if (!(options && options.eventIgnore)) {\r\n            EventManager.executeEventsByClassName(\"setSubPage\");\r\n        }\r\n    }\r\n\r\n    getSubPageIndex(page: HTMLElement): number | null {\r\n        if (!page || !page.querySelector(`.subPage`)) {\r\n            return null;\r\n        }\r\n        const subPages = Array.from(page.querySelectorAll<HTMLElement>(\".subPage\"));\r\n        return subPages.findIndex((subPage) => subPage.style.display != \"none\");\r\n    }\r\n}\r\n\r\nexport const pageManager: PageManager = new PageManager();\r\n","export class Sound {\r\n    private static context: AudioContext;\r\n    /**\r\n     * SE全体のボリューム\r\n     */\r\n    private static gain: GainNode;\r\n    /**\r\n     * それぞれのSEのボリューム\r\n     */\r\n    private gain: GainNode;\r\n\r\n    private audioBuffer!: AudioBuffer;\r\n    private reversedBuffer!: AudioBuffer;\r\n\r\n    private isReversed = false;\r\n\r\n    private lastPlayTime = Date.now();\r\n\r\n    readonly isReady;\r\n\r\n    private static initialized = false;\r\n    static init() {\r\n        if (this.initialized) {\r\n            throw new Error(\"Sound is already initialized! Ensure that you are not calling Sound.init() multiple times.\");\r\n        }\r\n        this.initialized = true;\r\n\r\n        this.context = new AudioContext();\r\n        this.gain = this.context.createGain();\r\n        this.gain.connect(this.context.destination);\r\n    }\r\n\r\n    /**\r\n     * SE全体のボリュームを設定\r\n     * @param volume\r\n     */\r\n    static setWholeVolume(volume: number) {\r\n        Sound.checkInit();\r\n        this.gain.gain.value = volume;\r\n    }\r\n\r\n    constructor({ src, volume = 0.4 }: { src: string; volume?: number }) {\r\n        Sound.checkInit();\r\n\r\n        this.gain = Sound.context.createGain();\r\n        this.gain.connect(Sound.gain);\r\n        this.gain.gain.value = volume;\r\n\r\n        this.isReady = this.fetch(src);\r\n    }\r\n\r\n    play() {\r\n        // 連打はNG\r\n        if (Date.now() - this.lastPlayTime < 32) {\r\n            return;\r\n        }\r\n        this.lastPlayTime = Date.now();\r\n\r\n        this.reconnect();\r\n    }\r\n\r\n    // 再生方向を切り替える\r\n    reverse() {\r\n        this.isReversed = !this.isReversed;\r\n    }\r\n\r\n    clearReversal() {\r\n        this.isReversed = false;\r\n    }\r\n\r\n    // 音源を読み込む\r\n    private async fetch(src: string) {\r\n        Sound.checkInit();\r\n\r\n        const arrayBuffer = await (await fetch(src)).arrayBuffer();\r\n        const audioBuffer = await Sound.context.decodeAudioData(arrayBuffer);\r\n\r\n        this.audioBuffer = audioBuffer;\r\n        const reversedBuffer = this.reverseBuffer(this.audioBuffer);\r\n        this.reversedBuffer = reversedBuffer;\r\n    }\r\n\r\n    // AudioBufferを反転させる（逆再生用）\r\n    private reverseBuffer(buffer: AudioBuffer) {\r\n        Sound.checkInit();\r\n\r\n        const reversedBuffer = Sound.context.createBuffer(buffer.numberOfChannels, buffer.length, buffer.sampleRate);\r\n\r\n        for (let channel = 0; channel < buffer.numberOfChannels; channel++) {\r\n            const originalData = buffer.getChannelData(channel);\r\n            const reversedData = reversedBuffer.getChannelData(channel);\r\n            for (let i = 0; i < originalData.length; i++) {\r\n                reversedData[i] = originalData[originalData.length - i - 1];\r\n            }\r\n        }\r\n\r\n        return reversedBuffer;\r\n    }\r\n\r\n    // play前の処理\r\n    private reconnect() {\r\n        Sound.checkInit();\r\n\r\n        const audio = Sound.context.createBufferSource();\r\n        audio.buffer = this.isReversed ? this.reversedBuffer : this.audioBuffer;\r\n        audio.connect(this.gain);\r\n        audio.start();\r\n    }\r\n\r\n    private static checkInit() {\r\n        if (!this.context) {\r\n            throw new Error(\"Sound is not initialized. Call Sound.init() before using Sound.\");\r\n        }\r\n    }\r\n}\r\n","import { EventManager } from \"./EventManager\";\r\n// import { gameManager } from \"./Run\";\r\n\r\n// function sleepGame(ms: number): Promise<void> {\r\n//     if (!gameManager) {\r\n//         return sleep(ms);\r\n//     }\r\n//     return new Promise((resolve) => {\r\n//         const sleepStartTime = gameManager.g$elapsedTime;\r\n//         const eventId = gameManager.addEvent([\"gameLoop\"], () => {\r\n//             if (sleepStartTime + ms <= gameManager.g$elapsedTime) {\r\n//                 resolve();\r\n//                 EventManager.removeEvent(eventId);\r\n//             }\r\n//         });\r\n//     });\r\n// }\r\n\r\n/**\r\n * 簡易的スリープ\r\n * @param ms 処理を止めるミリ秒数\r\n */\r\nfunction sleep(ms: number): Promise<void> {\r\n    return new Promise((resolve) => {\r\n        setTimeout(resolve, ms);\r\n    });\r\n}\r\n\r\nfunction printDotToVertices(left: number, top: number, color?: string) {\r\n    const printDots = document.getElementsByClassName(\"printDot\");\r\n    if (printDots.length >= 100) {\r\n        [...printDots].forEach((element) => {\r\n            element.remove();\r\n        });\r\n    }\r\n    const dot = document.createElement(\"div\");\r\n    dot.className = \"printDot\";\r\n    dot.style.width = \"8px\";\r\n    dot.style.height = \"8px\";\r\n    dot.style.position = \"absolute\";\r\n    dot.style.top = top - 1 + \"px\";\r\n    dot.style.left = left - 1 + \"px\";\r\n    dot.style.backgroundColor = color || \"#ff0000\";\r\n    let dotZIndex = 100;\r\n    dot.style.zIndex = dotZIndex + \"\";\r\n    document.querySelector(\"#play\")!.appendChild(dot);\r\n}\r\n\r\n/**\r\n * 画面上の指定した座標に点を表示する(デバッグ用)\r\n * @param left 画面左端からの距離(px)\r\n * @param top 画面上端からの距離(px)\r\n * @param color 点の色\r\n */\r\nfunction printDot(left: number, top: number, color?: string) {\r\n    const printDots = document.getElementsByClassName(\"printDot\");\r\n    if (printDots.length >= 100) {\r\n        [...printDots].forEach((element) => {\r\n            element.remove();\r\n        });\r\n    }\r\n    const dot = document.createElement(\"div\");\r\n    dot.className = \"printDot\";\r\n    dot.style.width = \"5px\";\r\n    dot.style.height = \"5px\";\r\n    dot.style.position = \"absolute\";\r\n    dot.style.top = top - 1 + \"px\";\r\n    dot.style.left = left - 1 + \"px\";\r\n    dot.style.backgroundColor = color || \"#ff0000\";\r\n    let dotZIndex = 100;\r\n    dot.style.zIndex = dotZIndex + \"\";\r\n    document.body.appendChild(dot);\r\n}\r\n\r\n/**\r\n * 配列の中身を混ぜる\r\n * @param array 混ぜる配列\r\n */\r\nfunction mixArray(array: any[]) {\r\n    const mixCount = (array.length * Math.log(array.length)) / 2;\r\n    let a, b;\r\n    let i, j;\r\n    for (let k = 0; k < mixCount; k++) {\r\n        i = Math.floor(Math.random() * array.length);\r\n        j = Math.floor(Math.random() * array.length);\r\n        a = array[i];\r\n        b = array[j];\r\n        array[i] = b;\r\n        array[j] = a;\r\n    }\r\n}\r\n\r\n/**\r\n * document.querySelectorAllのHTMLElement限定の略記\r\n * @param selector セレクタ\r\n * @returns 指定したHTMLElementの配列\r\n */\r\nfunction qsAll(selector: string): HTMLElement[] {\r\n    return Array.from(document.querySelectorAll(selector)) as HTMLElement[];\r\n}\r\n\r\n/**\r\n * document.querySelectorのHTMLElement限定の略記\r\n * @param selector セレクタ\r\n * @returns 指定したHTMLElement\r\n */\r\nfunction qs(selector: string): HTMLElement {\r\n    return document.querySelector(selector) as HTMLElement;\r\n}\r\n\r\n/**\r\n * HTMLElementにイベントを追加する\r\n * @param selector セレクタ\r\n * @param eventName イベントの名前\r\n * @param handler クリック時に行う処理\r\n */\r\nfunction qsAddEvent(selector: string, eventName: string, handler: (element: HTMLElement) => any) {\r\n    qsAll(selector).forEach((element) => {\r\n        element.addEventListener(eventName, () => {\r\n            handler(element);\r\n        });\r\n    });\r\n}\r\n\r\nfunction debounce(fn: Function, delay: number) {\r\n    let timeout: number | undefined;\r\n    return () => {\r\n        clearTimeout(timeout);\r\n        timeout = setTimeout(fn, delay);\r\n    };\r\n}\r\n\r\nfunction arrayPlus(a: number[], b: number[]): number[] {\r\n    if (a.length <= b.length) {\r\n        return a.map((n, i) => n + b[i]);\r\n    } else {\r\n        return b.map((n, i) => n + a[i]);\r\n    }\r\n}\r\n\r\nfunction getMinElement(array: { element: any; value: number }[]) {\r\n    if (array.length == 0) {\r\n        return null;\r\n    }\r\n    let minValue = Infinity;\r\n    let result: any = null;\r\n    array.forEach(({ element, value }) => {\r\n        if (value < minValue) {\r\n            minValue = value;\r\n            result = element;\r\n        }\r\n    });\r\n    return result;\r\n}\r\n\r\nfunction removeMousePointerTemporary() {\r\n    if (document.body.style.cursor != \"none\") {\r\n        document.body.style.cursor = \"none\";\r\n        window.addEventListener(\r\n            \"mousemove\",\r\n            () => {\r\n                document.body.style.cursor = \"\";\r\n            },\r\n            { once: true }\r\n        );\r\n    }\r\n}\r\n\r\nexport { sleep, printDotToVertices as printDot, mixArray, qsAll, qs, qsAddEvent, debounce, arrayPlus, getMinElement, removeMousePointerTemporary };\r\n","/**\r\n * 実際の時間に即したタイマー\r\n */\r\nexport class TimeManager {\r\n    //時間はすべてmsで管理される\r\n\r\n    private startTime: number | null = null;\r\n    private lastPauseTime: number | null = null;\r\n    private pauseSpan: number = 0;\r\n    private hasStarted: boolean = false;\r\n    private isPausing: boolean = false;\r\n\r\n    /**\r\n     * @param startImmediately インスタンス生成後すぐに開始するかどうか\r\n     */\r\n    constructor(startImmediately: boolean = false) {\r\n        if (startImmediately) {\r\n            this.start();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 開始時間\r\n     * まだ開始していない場合はnull\r\n     */\r\n    get g$startTime(): number | null {\r\n        return this.startTime;\r\n    }\r\n\r\n    /**\r\n     * 最後に中断した時間\r\n     * まだ中断したことがない場合はnull\r\n     */\r\n    get g$lastPauseTime(): number | null {\r\n        return this.lastPauseTime;\r\n    }\r\n\r\n    /**\r\n     * 開始されているかどうか\r\n     */\r\n    get g$hasStarted(): boolean {\r\n        return this.hasStarted;\r\n    }\r\n\r\n    /**\r\n     * 中断中かどうか\r\n     */\r\n    get g$isPausing(): boolean {\r\n        return this.isPausing;\r\n    }\r\n\r\n    /**\r\n     * 中断時間の合計\r\n     */\r\n    get g$pauseSpan(): number {\r\n        return this.pauseSpan;\r\n    }\r\n\r\n    /**\r\n     * 時間の計測を開始する\r\n     */\r\n    start(): void {\r\n        if (this.hasStarted) {\r\n            return;\r\n        }\r\n        this.startTime = Date.now();\r\n        this.hasStarted = true;\r\n        this.isPausing = false;\r\n    }\r\n\r\n    /**\r\n     * 時間の計測を中断する\r\n     */\r\n    pause(): void {\r\n        if (!this.hasStarted || this.isPausing) {\r\n            return;\r\n        }\r\n        this.lastPauseTime = Date.now();\r\n        this.isPausing = true;\r\n    }\r\n\r\n    /**\r\n     * 時間の計測を再開する\r\n     */\r\n    resume(): void {\r\n        if (!this.hasStarted || !this.isPausing) {\r\n            return;\r\n        }\r\n        this.pauseSpan += Date.now() - this.lastPauseTime!;\r\n        this.isPausing = false;\r\n    }\r\n\r\n    /**\r\n     * 時間の計測をリセットする\r\n     * @param startImmediately リセット後すぐに開始するかどうか\r\n     */\r\n    reset(startImmediately: boolean = false): void {\r\n        this.startTime = null;\r\n        this.lastPauseTime = null;\r\n        this.pauseSpan = 0;\r\n        this.hasStarted = false;\r\n        this.isPausing = false;\r\n        if (startImmediately) {\r\n            this.start();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 経過時間\r\n     * 開始していなければnullを返す\r\n     * @returns 経過時間\r\n     */\r\n    get g$elapsedTime(): number | null {\r\n        if (!this.hasStarted) {\r\n            return null;\r\n        }\r\n        if (this.isPausing) {\r\n            return this.lastPauseTime! - this.pauseSpan - this.startTime!;\r\n        }\r\n        return Date.now() - this.pauseSpan - this.startTime!;\r\n    }\r\n\r\n    /**\r\n     * @param goal 目標経過時間\r\n     * @returns 目標経過時間の達成回数\r\n     */\r\n    getGoalCount(goal: number): number {\r\n        if (!this.hasStarted) {\r\n            return 0;\r\n        }\r\n        return Math.floor(this.g$elapsedTime! / goal);\r\n    }\r\n}\r\n","import { MyEventListener, EventId, EventManager } from \"./EventManager.js\";\r\nimport { TimeManager } from \"./TimeManager.js\";\r\n\r\nexport class LoopManager implements MyEventListener {\r\n    /**\r\n     * 目標ループ頻度(ms)\r\n     * requestAnimationFrameの頻度が最速\r\n     * 0なら自動的に最速\r\n     */\r\n    private loopFrequency: number = 0;\r\n    private loopTimer: TimeManager | null = null;\r\n    private lastLoopCount = 0;\r\n    private loopId: number | null = null;\r\n    private isLooping: boolean = false;\r\n    /**\r\n     * @param loop ループをしたとき\r\n     */\r\n    readonly eventClassNames: string[] = [\"loop\"];\r\n    eventIds: EventId[] = [];\r\n    addEvent(classNames: string[], handler: Function): EventId {\r\n        const eventId = EventManager.addEvent({ classNames: classNames.filter((className) => this.eventClassNames.includes(className)), handler });\r\n        this.eventIds.push(eventId);\r\n        return eventId;\r\n    }\r\n\r\n    /**\r\n     * @param startImmediately インスタンス生成後すぐに開始するかどうか\r\n     */\r\n    constructor(startImmediately: boolean = false) {\r\n        if (startImmediately) {\r\n            this.start();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * ループ中かどうか\r\n     */\r\n    get g$isLooping() {\r\n        return this.isLooping;\r\n    }\r\n\r\n    /**\r\n     * ループ頻度\r\n     */\r\n    get g$loopFrequency(): number {\r\n        return this.loopFrequency;\r\n    }\r\n\r\n    /**\r\n     * @param frequency 設定したいループ頻度\r\n     */\r\n    set s$loopFrequency(frequency: number) {\r\n        if (!Number.isSafeInteger(frequency) || frequency <= 0) {\r\n            throw new Error(\"不正な値が入力されました: \" + frequency);\r\n        }\r\n        this.loopFrequency = frequency;\r\n    }\r\n\r\n    /**\r\n     * ループを開始する\r\n     */\r\n    start(): void {\r\n        if (this.isLooping) {\r\n            return;\r\n        }\r\n        this.loopId = requestAnimationFrame(this.loop.bind(this));\r\n        if (this.loopTimer) {\r\n            this.loopTimer.resume();\r\n        } else {\r\n            this.loopTimer = new TimeManager(true);\r\n        }\r\n        this.isLooping = true;\r\n    }\r\n\r\n    /**\r\n     * ループを停止する\r\n     */\r\n    stop(): void {\r\n        if (this.loopTimer) {\r\n            this.loopTimer.pause();\r\n        }\r\n        if (this.loopId) {\r\n            cancelAnimationFrame(this.loopId);\r\n        }\r\n        this.isLooping = false;\r\n    }\r\n\r\n    /**\r\n     * ループをリセットする\r\n     */\r\n    reset(): void {\r\n        this.stop();\r\n        if (this.loopTimer) {\r\n            this.loopTimer.reset();\r\n            this.loopTimer = null;\r\n        }\r\n        this.lastLoopCount = 0;\r\n    }\r\n\r\n    /**\r\n     * ループの中身\r\n     */\r\n    private loop() {\r\n        if (!this.loopTimer) {\r\n            return;\r\n        }\r\n        if (!this.isLooping) {\r\n            this.stop();\r\n            return;\r\n        }\r\n        const loopCount = this.loopTimer!.getGoalCount(this.loopFrequency);\r\n        if (this.lastLoopCount != loopCount || loopCount == Infinity) {\r\n            this.lastLoopCount = loopCount;\r\n            EventManager.executeListeningEvents(\"loop\", this.eventIds);\r\n        }\r\n        this.loopId = requestAnimationFrame(this.loop.bind(this));\r\n    }\r\n\r\n    /**\r\n     * @returns ループの合計駆動時間\r\n     */\r\n    get g$elapsedTime(): number {\r\n        if (!this.loopTimer) {\r\n            return 0;\r\n        }\r\n        return this.loopTimer.g$elapsedTime!;\r\n    }\r\n\r\n    /**\r\n     * @param goal 目標経過時間\r\n     * @returns 目標経過時間の達成回数\r\n     */\r\n    getGoalCount(goal: number): number {\r\n        if (!this.loopTimer) {\r\n            return 0;\r\n        }\r\n        return Math.floor(this.g$elapsedTime / goal);\r\n    }\r\n}\r\n","import { MyEventListener, EventId, EventManager } from \"../EventManager\";\r\nimport { LoopManager } from \"../LoopManager\";\r\n\r\nexport type AutoKeyboardInputData = {\r\n    time: number;\r\n    keyCode: string;\r\n    type: \"keydown\" | \"keyup\" | \"downup\";\r\n};\r\n\r\nexport class AutoKeyboardManager implements MyEventListener {\r\n    private loop: LoopManager = new LoopManager();\r\n    private inputData: AutoKeyboardInputData[] = [];\r\n    private inputDataTask: AutoKeyboardInputData[] = [];\r\n    private pressingKeys: string[] = [];\r\n    private pressTimes: number[] = [];\r\n    private valid: boolean = false;\r\n    readonly eventClassNames: string[] = [\"onKeydown\", \"onKeyup\"];\r\n    eventIds: EventId[] = [];\r\n    addEvent(classNames: string[], handler: Function): EventId {\r\n        const eventId = EventManager.addEvent({ classNames: classNames.filter((className) => this.eventClassNames.includes(className)), handler });\r\n        this.eventIds.push(eventId);\r\n        return eventId;\r\n    }\r\n\r\n    constructor() {}\r\n\r\n    //有効かどうか\r\n    get g$isValid(): boolean {\r\n        return this.valid;\r\n    }\r\n\r\n    //押された最新のキー\r\n    get g$latestPressingKey(): string {\r\n        return this.pressingKeys.length != 0 ? this.pressingKeys[this.pressingKeys.length - 1] : \"\";\r\n    }\r\n\r\n    //押された最古のキー\r\n    get g$oldestPressingKey(): string {\r\n        return this.pressingKeys.length != 0 ? this.pressingKeys[0] : \"\";\r\n    }\r\n\r\n    //まだ押されているキーのうちの押された最古の時間\r\n    get g$latestPressTime(): number {\r\n        return this.pressTimes.length != 0 ? this.pressTimes[this.pressTimes.length - 1] : -1;\r\n    }\r\n\r\n    //まだ押されているキーのうちの押された最新の時間\r\n    get g$oldestPressTime(): number {\r\n        return this.pressTimes.length != 0 ? this.pressTimes[0] : -1;\r\n    }\r\n\r\n    get g$inputData() {\r\n        return this.inputData;\r\n    }\r\n\r\n    set s$inputData(inputData: AutoKeyboardInputData[]) {\r\n        if (this.loop.g$isLooping) {\r\n            return;\r\n        }\r\n        this.inputData = inputData;\r\n        this.inputDataTask = window.structuredClone(inputData);\r\n\r\n        const keydownEvent = (keyCode: string) => {\r\n            if (!this.pressingKeys.includes(keyCode)) {\r\n                this.pressingKeys.push(keyCode);\r\n                this.pressTimes.push(Date.now());\r\n                EventManager.executeListeningEvents(\"onKeydown\", this.eventIds);\r\n                // console.log(\"Pressed:\" + keyCode);\r\n            }\r\n        };\r\n        const keyupEvent = (keyCode: string) => {\r\n            this.pressingKeys = this.pressingKeys.filter((keys, i) => {\r\n                if (keys == keyCode) {\r\n                    this.pressTimes[i] = -1;\r\n                }\r\n                return keys != keyCode;\r\n                //console.log(\"Unpressed:\" + keyCode);\r\n            });\r\n            this.pressTimes = this.pressTimes.filter((time) => time != -1);\r\n            EventManager.executeListeningEvents(\"onKeyup\", this.eventIds);\r\n        };\r\n\r\n        EventManager.removeEvents(this.loop.eventIds);\r\n        this.loop.addEvent([\"loop\"], () => {\r\n            while (true) {\r\n                if (this.inputDataTask.length) {\r\n                    if (this.inputDataTask[0].time <= this.loop.g$elapsedTime) {\r\n                        if ([\"keydown\", \"downup\"].includes(this.inputDataTask[0].type)) {\r\n                            keydownEvent(this.inputDataTask[0].keyCode);\r\n                        }\r\n                        if ([\"keyup\", \"downup\"].includes(this.inputDataTask[0].type)) {\r\n                            keyupEvent(this.inputDataTask[0].keyCode);\r\n                        }\r\n                        this.inputDataTask.shift();\r\n                    } else {\r\n                        break;\r\n                    }\r\n                } else {\r\n                    this.loop.stop();\r\n                    return;\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    //入力を受け取るのを開始する\r\n    start() {\r\n        // console.log(this.loop.g$elapsedTime, this.inputDataTask.length);\r\n        if (this.loop.g$elapsedTime && this.inputDataTask.length) {\r\n            this.loop.start();\r\n        }\r\n        this.valid = true;\r\n    }\r\n\r\n    //入力を受け取るのを停止する\r\n    stop() {\r\n        this.valid = false;\r\n        this.loop.stop();\r\n        this.pressingKeys = [];\r\n        this.pressTimes = [];\r\n    }\r\n\r\n    playStart() {\r\n        if (!this.inputDataTask.length) {\r\n            return;\r\n        }\r\n        this.loop.start();\r\n    }\r\n\r\n    playReset() {\r\n        this.loop.reset();\r\n        this.s$inputData = this.inputData;\r\n    }\r\n\r\n    //指定したキーが押されているか\r\n    isPressing(keyCode: string): boolean {\r\n        return this.pressingKeys.includes(keyCode);\r\n    }\r\n\r\n    //指定した複数のキーがすべて押されているか\r\n    arePressing(keyCodes: string[]): boolean {\r\n        let arePressing = true;\r\n        keyCodes.forEach((keyCode) => {\r\n            arePressing = arePressing && this.isPressing(keyCode);\r\n        });\r\n        return arePressing;\r\n    }\r\n\r\n    //指定した複数のキーのどれかが押されているか\r\n    existsPressingKey(keyCodes: string[]) {\r\n        let existsPressingKey = false;\r\n        keyCodes.forEach((keyCode) => {\r\n            existsPressingKey = existsPressingKey || this.isPressing(keyCode);\r\n        });\r\n        return existsPressingKey;\r\n    }\r\n\r\n    //指定したキーが押された時間を返す\r\n    //選択されていない場合は-1を返す\r\n    getPressTime(keyCode: string): number {\r\n        if (this.pressingKeys.indexOf(keyCode) == -1) {\r\n            return -1;\r\n        }\r\n        return this.pressTimes[this.pressingKeys.indexOf(keyCode)];\r\n    }\r\n\r\n    //指定した複数のキーの中で最も遅くに押されたものを返す\r\n    //どれも押されていない場合は空文字を返す\r\n    getLatestPressingKey(keyCodes: string[]): string {\r\n        let index = -1;\r\n        keyCodes.forEach((keyCode) => {\r\n            const i = this.pressingKeys.indexOf(keyCode);\r\n            if (index < i) {\r\n                index = i;\r\n            }\r\n        });\r\n        return index == -1 ? \"\" : this.pressingKeys[index];\r\n    }\r\n\r\n    //指定した複数のキーの中で最も早くに押されたものを返す\r\n    //どれも押されていない場合は空文字を返す\r\n    getOldestPressingKey(keyCodes: string[]): string {\r\n        let index = Infinity;\r\n        keyCodes.forEach((keyCode) => {\r\n            const i = this.pressingKeys.indexOf(keyCode);\r\n            if (i < index && i != -1) {\r\n                index = i;\r\n            }\r\n        });\r\n        return index == -1 ? \"\" : this.pressingKeys[index];\r\n    }\r\n\r\n    //指定した複数のキーの中で押されているものをすべて返す\r\n    getAllPressingKeys(keyCodes: string[]): string[] {\r\n        return this.pressingKeys.filter((keyCode) => keyCodes.includes(keyCode));\r\n    }\r\n}\r\n","import { LoopManager } from \"../LoopManager\";\r\n\r\nexport interface GamepadButtonEvent {\r\n    /**\r\n     * gamepadのindex\r\n     */\r\n    gamepadIndex: number;\r\n    /**\r\n     * buttonのindex\r\n     */\r\n    buttonIndex: number;\r\n    /**\r\n     * 押されているかどうか\r\n     */\r\n    pressed: boolean;\r\n}\r\n\r\nexport interface GamepadAxisEvent {\r\n    /**\r\n     * gamepadのindex\r\n     */\r\n    gamepadIndex: number;\r\n    /**\r\n     * axisのindex\r\n     */\r\n    axisIndex: number;\r\n    /**\r\n     * axisの傾き具合(-1~1)\r\n     */\r\n    value: number;\r\n    /**\r\n     * 閾値を超えて有効と判定されているか\r\n     */\r\n    active: boolean;\r\n}\r\n\r\nexport class GamepadInput {\r\n    private index: number;\r\n    private axisThreshold: number;\r\n    private loop = new LoopManager();\r\n    private lastButtons: boolean[] = [];\r\n    private lastAxesInfo: GamepadAxisEvent[] = [];\r\n\r\n    // コールバック\r\n    onButtonDown: ((ev: GamepadButtonEvent) => void) | null = null;\r\n    onButtonUp: ((ev: GamepadButtonEvent) => void) | null = null;\r\n    onAxisActive: ((ev: GamepadAxisEvent) => void) | null = null;\r\n    onAxisInactive: ((ev: GamepadAxisEvent) => void) | null = null;\r\n\r\n    constructor(index: number, axisThreshold: number = 0.4) {\r\n        this.index = index;\r\n        this.axisThreshold = axisThreshold;\r\n\r\n        const loop = () => {\r\n            const gamepad = navigator.getGamepads()[this.index];\r\n            if (!gamepad) {\r\n                // 切断状態\r\n                return;\r\n            }\r\n\r\n            this.processGamepad(gamepad);\r\n        };\r\n\r\n        this.loop.addEvent([\"loop\"], loop.bind(this));\r\n    }\r\n\r\n    get g$connecting(): boolean {\r\n        return navigator.getGamepads()[this.index] != null;\r\n    }\r\n\r\n    /**\r\n     * ループ開始\r\n     */\r\n    start() {\r\n        this.loop.start();\r\n    }\r\n\r\n    /**\r\n     * ボタン/スティックの状態変化を処理\r\n     */\r\n    private processGamepad(gp: Gamepad) {\r\n        // ボタン\r\n        gp.buttons.forEach((btn, i) => {\r\n            const isPressed = btn.pressed;\r\n            const wasPressed = this.lastButtons[i] ?? false;\r\n\r\n            if (isPressed !== wasPressed) {\r\n                if (isPressed) {\r\n                    this.onButtonDown?.({\r\n                        gamepadIndex: this.index,\r\n                        buttonIndex: i,\r\n                        pressed: true,\r\n                    });\r\n                } else {\r\n                    this.onButtonUp?.({\r\n                        gamepadIndex: this.index,\r\n                        buttonIndex: i,\r\n                        pressed: false,\r\n                    });\r\n                }\r\n            }\r\n\r\n            this.lastButtons[i] = isPressed;\r\n        });\r\n\r\n        // スティック\r\n        gp.axes.forEach((value, i) => {\r\n            const isActive = Math.abs(value) >= this.axisThreshold;\r\n            const wasActive = this.lastAxesInfo[i] ? this.lastAxesInfo[i].active : false;\r\n\r\n            if (isActive !== wasActive) {\r\n                if (isActive) {\r\n                    this.onAxisActive?.({\r\n                        gamepadIndex: this.index,\r\n                        axisIndex: i,\r\n                        value,\r\n                        active: true,\r\n                    });\r\n                } else {\r\n                    this.onAxisInactive?.({\r\n                        gamepadIndex: this.index,\r\n                        axisIndex: i,\r\n                        value: this.lastAxesInfo[i].value ?? 0,\r\n                        active: false,\r\n                    });\r\n                }\r\n            } else if ((this.lastAxesInfo[i] ? this.lastAxesInfo[i].value : 0) * value < 0) {\r\n                if (wasActive) {\r\n                    this.onAxisInactive?.({\r\n                        gamepadIndex: this.index,\r\n                        axisIndex: i,\r\n                        value: this.lastAxesInfo[i].value ?? 0,\r\n                        active: false,\r\n                    });\r\n                }\r\n                if (isActive) {\r\n                    this.onAxisActive?.({\r\n                        gamepadIndex: this.index,\r\n                        axisIndex: i,\r\n                        value,\r\n                        active: true,\r\n                    });\r\n                }\r\n            }\r\n\r\n            this.lastAxesInfo[i] = {\r\n                gamepadIndex: this.index,\r\n                axisIndex: i,\r\n                value,\r\n                active: isActive,\r\n            };\r\n        });\r\n    }\r\n\r\n    /**\r\n     * ループ停止\r\n     */\r\n    stop() {\r\n        this.loop.stop();\r\n    }\r\n}\r\n","import { MyEventListener, EventId, EventManager } from \"../EventManager\";\r\nimport { GamepadInput } from \"./GamepadInput\";\r\n\r\nexport class GamepadManager implements MyEventListener {\r\n    private input: GamepadInput;\r\n    private pressingKeys: string[] = [];\r\n    private pressTimes: number[] = [];\r\n    private valid: boolean = false;\r\n    //keyCodeはbutton:*buttonIndex*、stick:+*axisIndex*、stick:-*axisIndex*の形\r\n\r\n    readonly eventClassNames: string[] = [\"onButtondown\", \"onButtonup\", \"onStickActive\", \"onStickInactive\"];\r\n    eventIds: EventId[] = [];\r\n    addEvent(classNames: string[], handler: Function): EventId {\r\n        const eventId = EventManager.addEvent({ classNames: classNames.filter((className) => this.eventClassNames.includes(className)), handler });\r\n        this.eventIds.push(eventId);\r\n        return eventId;\r\n    }\r\n\r\n    constructor(index: number) {\r\n        this.input = new GamepadInput(index);\r\n        this.input.onButtonDown = (e) => {\r\n            if (!this.pressingKeys.includes(\"button:\" + e.buttonIndex)) {\r\n                this.pressingKeys.push(\"button:\" + e.buttonIndex);\r\n                this.pressTimes.push(Date.now());\r\n                EventManager.executeListeningEvents(\"onButtondown\", this.eventIds);\r\n                // console.log(\"Pressed:\" + e.buttonIndex);\r\n            }\r\n        };\r\n        this.input.onButtonUp = (e) => {\r\n            this.pressingKeys = this.pressingKeys.filter((keys, i) => {\r\n                if (keys == \"button:\" + e.buttonIndex) {\r\n                    this.pressTimes[i] = -1;\r\n                }\r\n                return keys != \"button:\" + e.buttonIndex;\r\n            });\r\n            this.pressTimes = this.pressTimes.filter((time) => time != -1);\r\n            EventManager.executeListeningEvents(\"onButtonup\", this.eventIds);\r\n            // console.log(\"Unpressed:\" + e.buttonIndex);\r\n        };\r\n        this.input.onAxisActive = (e) => {\r\n            if (e.value > 0) {\r\n                if (!this.pressingKeys.includes(\"stick:+\" + e.axisIndex)) {\r\n                    this.pressingKeys.push(\"stick:+\" + e.axisIndex);\r\n                    this.pressTimes.push(Date.now());\r\n                    EventManager.executeListeningEvents(\"onStickActive\", this.eventIds);\r\n                    // console.log(\"Activated:+\" + e.axisIndex);\r\n                }\r\n            } else {\r\n                if (!this.pressingKeys.includes(\"stick:-\" + e.axisIndex)) {\r\n                    this.pressingKeys.push(\"stick:-\" + e.axisIndex);\r\n                    this.pressTimes.push(Date.now());\r\n                    EventManager.executeListeningEvents(\"onStickActive\", this.eventIds);\r\n                    // console.log(\"Activated:-\" + e.axisIndex);\r\n                }\r\n            }\r\n        };\r\n        this.input.onAxisInactive = (e) => {\r\n            if (e.value > 0) {\r\n                this.pressingKeys = this.pressingKeys.filter((keys, i) => {\r\n                    if (keys == \"stick:+\" + e.axisIndex) {\r\n                        this.pressTimes[i] = -1;\r\n                    }\r\n                    return keys != \"stick:+\" + e.axisIndex;\r\n                });\r\n                this.pressTimes = this.pressTimes.filter((time) => time != -1);\r\n                EventManager.executeListeningEvents(\"onStickInactive\", this.eventIds);\r\n                // console.log(\"Inactivated:+\" + e.axisIndex);\r\n            } else {\r\n                this.pressingKeys = this.pressingKeys.filter((keys, i) => {\r\n                    if (keys == \"stick:-\" + e.axisIndex) {\r\n                        this.pressTimes[i] = -1;\r\n                    }\r\n                    return keys != \"stick:-\" + e.axisIndex;\r\n                });\r\n                this.pressTimes = this.pressTimes.filter((time) => time != -1);\r\n                EventManager.executeListeningEvents(\"onStickInactive\", this.eventIds);\r\n                // console.log(\"Inactivated:-\" + e.axisIndex);\r\n            }\r\n        };\r\n    }\r\n\r\n    //有効かどうか\r\n    get g$isValid(): boolean {\r\n        return this.valid;\r\n    }\r\n\r\n    //押された最新のキー\r\n    get g$latestPressingKey(): string {\r\n        return this.pressingKeys.length != 0 ? this.pressingKeys[this.pressingKeys.length - 1] : \"\";\r\n    }\r\n\r\n    //押された最古のキー\r\n    get g$oldestPressingKey(): string {\r\n        return this.pressingKeys.length != 0 ? this.pressingKeys[0] : \"\";\r\n    }\r\n\r\n    //まだ押されているキーのうちの押された最古の時間\r\n    get g$latestPressTime(): number {\r\n        return this.pressTimes.length != 0 ? this.pressTimes[this.pressTimes.length - 1] : -1;\r\n    }\r\n\r\n    //まだ押されているキーのうちの押された最新の時間\r\n    get g$oldestPressTime(): number {\r\n        return this.pressTimes.length != 0 ? this.pressTimes[0] : -1;\r\n    }\r\n\r\n    //入力を受け取るのを開始する\r\n    start() {\r\n        if (this.valid) {\r\n            return;\r\n        }\r\n        this.input.start();\r\n        this.valid = true;\r\n    }\r\n\r\n    //入力を受け取るのを停止する\r\n    stop() {\r\n        if (!this.valid) {\r\n            return;\r\n        }\r\n        this.valid = false;\r\n        this.input.stop();\r\n        this.pressingKeys = [];\r\n        this.pressTimes = [];\r\n    }\r\n\r\n    //指定したキーが押されているか\r\n    isPressing(keyCode: string): boolean {\r\n        return this.pressingKeys.includes(keyCode);\r\n    }\r\n\r\n    //指定した複数のキーがすべて押されているか\r\n    arePressing(keyCodes: string[]): boolean {\r\n        let arePressing = true;\r\n        keyCodes.forEach((keyCode) => {\r\n            arePressing = arePressing && this.isPressing(keyCode);\r\n        });\r\n        return arePressing;\r\n    }\r\n\r\n    //指定した複数のキーのどれかが押されているか\r\n    existsPressingKey(keyCodes: string[]) {\r\n        let existsPressingKey = false;\r\n        keyCodes.forEach((keyCode) => {\r\n            existsPressingKey = existsPressingKey || this.isPressing(keyCode);\r\n        });\r\n        return existsPressingKey;\r\n    }\r\n\r\n    //指定したキーが押された時間を返す\r\n    //選択されていない場合は-1を返す\r\n    getPressTime(keyCode: string): number {\r\n        if (this.pressingKeys.indexOf(keyCode) == -1) {\r\n            return -1;\r\n        }\r\n        return this.pressTimes[this.pressingKeys.indexOf(keyCode)];\r\n    }\r\n\r\n    //指定した複数のキーの中で最も遅くに押されたものを返す\r\n    //どれも押されていない場合は空文字を返す\r\n    getLatestPressingKey(keyCodes: string[]): string {\r\n        let index = -1;\r\n        keyCodes.forEach((keyCode) => {\r\n            const i = this.pressingKeys.indexOf(keyCode);\r\n            if (index < i) {\r\n                index = i;\r\n            }\r\n        });\r\n        return index == -1 ? \"\" : this.pressingKeys[index];\r\n    }\r\n\r\n    //指定した複数のキーの中で最も早くに押されたものを返す\r\n    //どれも押されていない場合は空文字を返す\r\n    getOldestPressingKey(keyCodes: string[]): string {\r\n        let index = Infinity;\r\n        keyCodes.forEach((keyCode) => {\r\n            const i = this.pressingKeys.indexOf(keyCode);\r\n            if (i < index && i != -1) {\r\n                index = i;\r\n            }\r\n        });\r\n        return index == -1 ? \"\" : this.pressingKeys[index];\r\n    }\r\n\r\n    //指定した複数のキーの中で押されているものをすべて返す\r\n    getAllPressingKeys(keyCodes: string[]): string[] {\r\n        return this.pressingKeys.filter((keyCode) => keyCodes.includes(keyCode));\r\n    }\r\n}\r\n","import { MyEventListener, EventId, EventManager } from \"../EventManager\";\r\n\r\nexport class KeyboardManager implements MyEventListener {\r\n    private pressingKeys: string[] = [];\r\n    private pressTimes: number[] = [];\r\n    private valid: boolean = false;\r\n    private keydownEvent: (e: KeyboardEvent) => any;\r\n    private keyupEvent: (e: KeyboardEvent) => any;\r\n    readonly eventClassNames: string[] = [\"onKeydown\", \"onKeyup\"];\r\n    eventIds: EventId[] = [];\r\n    addEvent(classNames: string[], handler: Function): EventId {\r\n        const eventId = EventManager.addEvent({ classNames: classNames.filter((className) => this.eventClassNames.includes(className)), handler });\r\n        this.eventIds.push(eventId);\r\n        return eventId;\r\n    }\r\n\r\n    constructor() {\r\n        this.keydownEvent = (e: KeyboardEvent) => {\r\n            if (!this.pressingKeys.includes(e.code)) {\r\n                this.pressingKeys.push(e.code);\r\n                this.pressTimes.push(Date.now());\r\n                EventManager.executeListeningEvents(\"onKeydown\", this.eventIds);\r\n                //console.log(\"Pressed:\" + e.code);\r\n            }\r\n        };\r\n        this.keyupEvent = (e: KeyboardEvent) => {\r\n            this.pressingKeys = this.pressingKeys.filter((keys, i) => {\r\n                if (keys == e.code) {\r\n                    this.pressTimes[i] = -1;\r\n                }\r\n                return keys != e.code;\r\n                //console.log(\"Unpressed:\" + e.code);\r\n            });\r\n            this.pressTimes = this.pressTimes.filter((time) => time != -1);\r\n            EventManager.executeListeningEvents(\"onKeyup\", this.eventIds);\r\n        };\r\n    }\r\n\r\n    //有効かどうか\r\n    get g$isValid(): boolean {\r\n        return this.valid;\r\n    }\r\n\r\n    //押された最新のキー\r\n    get g$latestPressingKey(): string {\r\n        return this.pressingKeys.length != 0 ? this.pressingKeys[this.pressingKeys.length - 1] : \"\";\r\n    }\r\n\r\n    //押された最古のキー\r\n    get g$oldestPressingKey(): string {\r\n        return this.pressingKeys.length != 0 ? this.pressingKeys[0] : \"\";\r\n    }\r\n\r\n    //まだ押されているキーのうちの押された最古の時間\r\n    get g$latestPressTime(): number {\r\n        return this.pressTimes.length != 0 ? this.pressTimes[this.pressTimes.length - 1] : -1;\r\n    }\r\n\r\n    //まだ押されているキーのうちの押された最新の時間\r\n    get g$oldestPressTime(): number {\r\n        return this.pressTimes.length != 0 ? this.pressTimes[0] : -1;\r\n    }\r\n\r\n    //入力を受け取るのを開始する\r\n    start() {\r\n        if (this.valid) {\r\n            return;\r\n        }\r\n        document.addEventListener(\"keydown\", this.keydownEvent);\r\n        document.addEventListener(\"keyup\", this.keyupEvent);\r\n        this.valid = true;\r\n    }\r\n\r\n    //入力を受け取るのを停止する\r\n    stop() {\r\n        if (!this.valid) {\r\n            return;\r\n        }\r\n        this.valid = false;\r\n        document.removeEventListener(\"keydown\", this.keydownEvent);\r\n        document.removeEventListener(\"keyup\", this.keyupEvent);\r\n        this.pressingKeys = [];\r\n        this.pressTimes = [];\r\n    }\r\n\r\n    //指定したキーが押されているか\r\n    isPressing(keyCode: string): boolean {\r\n        return this.pressingKeys.includes(keyCode);\r\n    }\r\n\r\n    //指定した複数のキーがすべて押されているか\r\n    arePressing(keyCodes: string[]): boolean {\r\n        let arePressing = true;\r\n        keyCodes.forEach((keyCode) => {\r\n            arePressing = arePressing && this.isPressing(keyCode);\r\n        });\r\n        return arePressing;\r\n    }\r\n\r\n    //指定した複数のキーのどれかが押されているか\r\n    existsPressingKey(keyCodes: string[]) {\r\n        let existsPressingKey = false;\r\n        keyCodes.forEach((keyCode) => {\r\n            existsPressingKey = existsPressingKey || this.isPressing(keyCode);\r\n        });\r\n        return existsPressingKey;\r\n    }\r\n\r\n    //指定したキーが押された時間を返す\r\n    //選択されていない場合は-1を返す\r\n    getPressTime(keyCode: string): number {\r\n        if (this.pressingKeys.indexOf(keyCode) == -1) {\r\n            return -1;\r\n        }\r\n        return this.pressTimes[this.pressingKeys.indexOf(keyCode)];\r\n    }\r\n\r\n    //指定した複数のキーの中で最も遅くに押されたものを返す\r\n    //どれも押されていない場合は空文字を返す\r\n    getLatestPressingKey(keyCodes: string[]): string {\r\n        let index = -1;\r\n        keyCodes.forEach((keyCode) => {\r\n            const i = this.pressingKeys.indexOf(keyCode);\r\n            if (index < i) {\r\n                index = i;\r\n            }\r\n        });\r\n        return index == -1 ? \"\" : this.pressingKeys[index];\r\n    }\r\n\r\n    //指定した複数のキーの中で最も早くに押されたものを返す\r\n    //どれも押されていない場合は空文字を返す\r\n    getOldestPressingKey(keyCodes: string[]): string {\r\n        let index = Infinity;\r\n        keyCodes.forEach((keyCode) => {\r\n            const i = this.pressingKeys.indexOf(keyCode);\r\n            if (i < index && i != -1) {\r\n                index = i;\r\n            }\r\n        });\r\n        return index == -1 ? \"\" : this.pressingKeys[index];\r\n    }\r\n\r\n    //指定した複数のキーの中で押されているものをすべて返す\r\n    getAllPressingKeys(keyCodes: string[]): string[] {\r\n        return this.pressingKeys.filter((keyCode) => keyCodes.includes(keyCode));\r\n    }\r\n}\r\n","import { AutoKeyboardManager } from \"./AutoKeyboardManager\";\r\nimport { GamepadManager } from \"./GamepadManager\";\r\nimport { KeyboardManager } from \"./KeyboardManager\";\r\n\r\nexport class Input {\r\n    manager: KeyboardManager | GamepadManager | AutoKeyboardManager;\r\n    type: string;\r\n    index: number;\r\n    constructor(type: string = \"keyboard\", index = 0) {\r\n        this.type = type;\r\n        this.index = index;\r\n        if (type == \"keyboard\") {\r\n            this.manager = new KeyboardManager();\r\n        } else if (type == \"gamepad\") {\r\n            this.manager = new GamepadManager(index);\r\n        } else if (type == \"autoKeyboard\") {\r\n            this.manager = new AutoKeyboardManager();\r\n        } else {\r\n            console.log(\"不明なinput形式を指定されました\");\r\n            this.type = \"keyboard\";\r\n            this.manager = new KeyboardManager();\r\n        }\r\n    }\r\n\r\n    get g$manager() {\r\n        return this.manager;\r\n    }\r\n\r\n    get g$type() {\r\n        return this.type;\r\n    }\r\n}\r\n","import { EventId, EventManager } from \"../EventManager\";\r\nimport { Input } from \"./Input\";\r\n\r\nclass InputManager {\r\n    private static instance: InputManager;\r\n    private registering = false;\r\n    private inputTypes: string[] = [\"keyboard\"];\r\n    private inputs: Input[] = [new Input(\"keyboard\")];\r\n    private maxInputNumber: number = 4;\r\n    private registerEventIds: EventId[] = [];\r\n    private registeredInputs: Input[] = [];\r\n\r\n    readonly eventClassNames: string[] = [\"inputRegistered\", \"finishRegister\", \"inputAdded\"];\r\n    addEvent(classNames: string[], handler: Function): EventId {\r\n        return EventManager.addEvent({ classNames, handler });\r\n    }\r\n\r\n    constructor() {\r\n        if (InputManager.instance) {\r\n            return InputManager.instance;\r\n        }\r\n        InputManager.instance = this;\r\n\r\n        window.addEventListener(\"gamepadconnected\", (e) => {\r\n            if (!this.inputTypes.includes(`gamepad:${e.gamepad.index}`)) {\r\n                this.inputTypes.push(`gamepad:${e.gamepad.index}`);\r\n                const input = new Input(\"gamepad\", e.gamepad.index);\r\n                this.inputs.push(input);\r\n                input.g$manager.start();\r\n                if (this.registering) {\r\n                    this.addRegisterEvent(input);\r\n                }\r\n                EventManager.executeEventsByClassName(\"inputAdded\");\r\n            }\r\n        });\r\n        this.inputs[0].g$manager.start();\r\n    }\r\n\r\n    get g$registeredInputs() {\r\n        return this.registeredInputs;\r\n    }\r\n\r\n    get g$maxInputNumber() {\r\n        return this.maxInputNumber;\r\n    }\r\n\r\n    get g$registering() {\r\n        return this.registering;\r\n    }\r\n\r\n    get g$registeredInputNumber() {\r\n        return this.registeredInputs.length;\r\n    }\r\n\r\n    get g$inputs() {\r\n        return this.inputs;\r\n    }\r\n\r\n    set s$maxInputNumber(maxInputNumber: number) {\r\n        this.maxInputNumber = maxInputNumber;\r\n    }\r\n\r\n    startRegister() {\r\n        this.registering = true;\r\n        this.registeredInputs = [];\r\n        this.registerEventIds = [];\r\n        this.inputs.forEach((input) => {\r\n            this.addRegisterEvent(input);\r\n        });\r\n        this.start();\r\n    }\r\n\r\n    finishRegister() {\r\n        if (!this.registering) {\r\n            return;\r\n        }\r\n        EventManager.removeEvents(this.registerEventIds);\r\n        this.registering = false;\r\n        EventManager.executeEventsByClassName(\"finishRegister\");\r\n    }\r\n\r\n    private addRegisterEvent(input: Input) {\r\n        this.registerEventIds.push(\r\n            input.g$manager.addEvent([\"onKeydown\", \"onButtondown\", \"onStickActive\"], () => {\r\n                if (!this.registeredInputs.includes(input)) {\r\n                    this.registeredInputs.push(input);\r\n                    EventManager.executeEventsByClassName(\"inputRegistered\");\r\n                }\r\n                if (this.registeredInputs.length >= this.maxInputNumber) {\r\n                    this.finishRegister();\r\n                }\r\n            })\r\n        );\r\n    }\r\n\r\n    resetRegister() {\r\n        this.registering = false;\r\n        this.registeredInputs = [];\r\n        EventManager.removeEvents(this.registerEventIds);\r\n        this.inputs.forEach((input) => {\r\n            EventManager.removeEvents(input.g$manager.eventIds);\r\n        });\r\n    }\r\n\r\n    start() {\r\n        this.inputs.forEach((input) => {\r\n            input.g$manager.start();\r\n        });\r\n    }\r\n\r\n    stop() {\r\n        this.inputs.forEach((input) => {\r\n            input.g$manager.stop();\r\n        });\r\n    }\r\n\r\n    addInput(input: Input) {\r\n        if (!this.inputs.includes(input)) {\r\n            this.inputs.push(input);\r\n            this.inputTypes.push(input.g$type);\r\n        }\r\n    }\r\n\r\n    removeVirtualInputs() {\r\n        this.inputTypes = this.inputTypes.filter((type) => type == \"keyboard\" || type.includes(\"gamepad\"));\r\n        this.inputs\r\n            .filter((input) => ![\"keyboard\", \"gamepad\"].includes(input.g$type))\r\n            .forEach((input) => {\r\n                input.g$manager.stop();\r\n            });\r\n        this.inputs = this.inputs.filter((input) => [\"keyboard\", \"gamepad\"].includes(input.g$type));\r\n        this.registeredInputs = this.registeredInputs.filter((input) => [\"keyboard\", \"gamepad\"].includes(input.g$type));\r\n    }\r\n\r\n    register(input: Input) {\r\n        if (this.registeredInputs.length >= this.maxInputNumber) {\r\n            return;\r\n        }\r\n        this.addInput(input);\r\n        if (!this.registeredInputs.includes(input)) {\r\n            this.registeredInputs.push(input);\r\n            EventManager.executeEventsByClassName(\"inputRegistered\");\r\n        }\r\n    }\r\n}\r\n\r\nexport const inputManager = new InputManager();\r\n","import { EventId, EventManager, MyEventListener } from \"../EventManager\";\r\nimport { GamePlayer } from \"./GamePlayer\";\r\n\r\nexport const gameEvents: EventId[] = [];\r\nexport type OperateName = \"put\" | \"move-left\" | \"move-right\" | \"move-down\" | \"spin-left\" | \"spin-right\" | \"unput\" | \"hold\" | \"removeLine\";\r\nexport type OperateData = {\r\n    time: number;\r\n    operateName: OperateName;\r\n};\r\n\r\nexport abstract class GameMode implements MyEventListener {\r\n    protected players: GamePlayer[] = [];\r\n    protected state = {\r\n        hasFinished: false,\r\n    };\r\n    protected winners: GamePlayer[] = [];\r\n    operateMemories: OperateData[][];\r\n    eventClassNames: string[] = [\"gameFinish\"];\r\n    eventIds: EventId[] = [];\r\n    addEvent(classNames: string[], handler: Function): EventId {\r\n        const eventId = EventManager.addEvent({ classNames: classNames.filter((className) => this.eventClassNames.includes(className)), handler });\r\n        this.eventIds.push(eventId);\r\n        gameEvents.push(eventId);\r\n        return eventId;\r\n    }\r\n    constructor(players: GamePlayer[]) {\r\n        this.players = players;\r\n        this.operateMemories = new Array(players.length).fill(undefined).map(() => []);\r\n        const operateNames = [\"put\", \"move-left\", \"move-right\", \"move-down\", \"spin-left\", \"spin-right\", \"unput\", \"hold\", \"removeLine\"];\r\n        players.forEach((p, i) => {\r\n            operateNames.forEach((operateName) => {\r\n                gameEvents.push(\r\n                    p.operator.addEvent([operateName], () => {\r\n                        this.operateMemories[i].push({\r\n                            time: p.loop.g$elapsedTime,\r\n                            operateName: operateName as OperateName,\r\n                        });\r\n                    })\r\n                );\r\n            });\r\n        });\r\n    }\r\n\r\n    abstract start(): void;\r\n    abstract stop(): void;\r\n    protected abstract proceedPlayerFinish(): void;\r\n    protected abstract addPlayerBehavior(index: number): void;\r\n\r\n    remove() {\r\n        EventManager.removeEvents(gameEvents);\r\n        this.players.forEach((player) => {\r\n            player.g$element.remove();\r\n        });\r\n    }\r\n}\r\n","//盤面のサイズ\r\nexport const width = 9;\r\nexport const height = 20;\r\n//画面上部に隠れる盤面の拡張サイズ heightとは別\r\nexport const hiddenHeight = 18;\r\n//monoiamondにおける座標のサイズ\r\nexport const playWidth = width * 2 - 1;\r\nexport const playHeight = height + hiddenHeight;\r\n//hiddenHeightをどれだけ表示するか\r\nexport const displayMargin = 0.5;\r\n//blockの大きさ\r\nexport const blockHeight = 100;\r\nexport const blockWidth = (blockHeight * 2) / Math.sqrt(3);\r\n//pentiamondの初期出現位置\r\nexport const initialX = 8;\r\nexport const initialY = 19;\r\n//盤面の背景色\r\nexport const backgroundColor = \"#222233\";\r\n//kindに応じたblockの色\r\nexport const blockColor = {\r\n    normal: {\r\n        L: \"#FF0000\",\r\n        J: \"#FA7800\",\r\n        p: \"#FFFF00\",\r\n        q: \"#00FF00\",\r\n        U: \"#0000FF\",\r\n        I: \"#990099\",\r\n        g: \"#AAAAAA\",\r\n    },\r\n    ghost: {\r\n        L: \"#55000099\",\r\n        J: \"#4D2D0099\",\r\n        p: \"#55550099\",\r\n        q: \"#00550099\",\r\n        U: \"#00005599\",\r\n        I: \"#44004499\",\r\n        g: \"#44444499\",\r\n    },\r\n};\r\n//盤面の補助グリッド\r\nexport const canvasGrid = {\r\n    width: 8,\r\n    color: \"#494960\",\r\n};\r\n//monoiamondの枠線\r\nexport const mondGrid = {\r\n    normal: {\r\n        width: 4,\r\n        color: \"#79798899\",\r\n    },\r\n    ghost: {\r\n        width: 4,\r\n        color: \"#45455099\",\r\n    },\r\n};\r\n//十五列揃え用のガイド線\r\nexport const guideBorderColor = \"#88ddee66\";\r\n//next表示関係\r\nexport const next = {\r\n    width: 3,\r\n    height: 3,\r\n    gap: 160,\r\n    scale: {\r\n        hold: 1.4,\r\n        normal: 1,\r\n    },\r\n    length: 4,\r\n    splitColor: \"#00008888\",\r\n};\r\n//一度のdamage処理にかかる時間の目安(ミリ秒)\r\nexport const damageTime = 2000;\r\nexport const damageWaitingTime = 4000;\r\n//nuisanceMondが生成される間隔\r\nexport const damageGrace = 3;\r\nexport const input = {\r\n    repeatTime: 35,\r\n    delayTime: 165,\r\n};\r\n//カウントが1減る時間(ms)\r\nexport const gameTimeRate = 500;\r\n//残り時間わずかの警告を出すgameTime\r\nexport const warningGameTime = 30;\r\n//ペナルティ\r\nexport const penalty = {\r\n    removeLine: 3,\r\n    unput: 3,\r\n};\r\n\r\nexport type GamepadConfig = {\r\n    moveLeft: string[];\r\n    moveRight: string[];\r\n    moveDown: string[];\r\n    put: string[];\r\n    spinLeft: string[];\r\n    spinRight: string[];\r\n    unput: string[];\r\n    hold: string[];\r\n    removeLine: string[];\r\n    pause: string[];\r\n};\r\n\r\nexport const gamepadConfigPresets: GamepadConfig[] = [\r\n    {\r\n        moveLeft: [\"button:14\", \"stick:-0\"],\r\n        moveRight: [\"button:15\", \"stick:+0\"],\r\n        moveDown: [\"button:13\", \"stick:+1\"],\r\n        put: [\"button:4\", \"button:6\"],\r\n        spinLeft: [\"button:0\"],\r\n        spinRight: [\"button:1\"],\r\n        unput: [\"button:2\"],\r\n        hold: [\"button:5\", \"button:7\"],\r\n        removeLine: [\"button:3\"],\r\n        pause: [\"button:8\", \"button:9\"],\r\n    },\r\n];\r\n\r\nexport const debounceOperateTime = 120;\r\nexport const maximumTemporaryReplaySavable = 10;\r\n","import { LoopManager } from \"./LoopManager\";\r\nimport { qs } from \"./Utils\";\r\n\r\nconst element = qs(\"#playBackground\");\r\nconst canvas = document.createElement(\"canvas\");\r\nconst ctx = canvas.getContext(\"2d\")!;\r\n\r\nelement.appendChild(canvas);\r\ncanvas.width = qs(\"body\").clientWidth;\r\ncanvas.height = qs(\"body\").clientHeight;\r\n\r\nclass Triangle {\r\n    x: number = 0;\r\n    y: number = 0;\r\n    size: number = 0;\r\n    speed: number = 0;\r\n    opacity: number = 0;\r\n    angle: number = 0;\r\n    rotationSpeed: number = 0;\r\n    constructor() {\r\n        this.reset();\r\n    }\r\n\r\n    reset() {\r\n        this.x = Math.random() * canvas.width;\r\n        this.y = canvas.height + 50;\r\n        this.size = 20 + Math.random() ** 1.2 * 40;\r\n        this.speed = 0.6 + Math.random() * 1.6;\r\n        this.opacity = 0.2 + Math.random() * 0.5;\r\n        this.angle = Math.random() * Math.PI * 2;\r\n        this.rotationSpeed = (Math.random() - 0.5) * 0.02;\r\n    }\r\n\r\n    update() {\r\n        this.y -= this.speed;\r\n        this.angle += this.rotationSpeed;\r\n        if (this.y < -this.size) {\r\n            this.reset();\r\n        }\r\n    }\r\n\r\n    draw(ctx: CanvasRenderingContext2D) {\r\n        ctx.save();\r\n        ctx.translate(this.x, this.y);\r\n        ctx.rotate(this.angle);\r\n\r\n        ctx.beginPath();\r\n        ctx.moveTo(0, (-this.size / 2) * (Math.sqrt(3) / 2));\r\n        ctx.lineTo(-this.size / 2, (this.size / 2) * (Math.sqrt(3) / 2));\r\n        ctx.lineTo(this.size / 2, (this.size / 2) * (Math.sqrt(3) / 2));\r\n        ctx.closePath();\r\n\r\n        ctx.fillStyle = `rgba(255,255,255,${this.opacity})`;\r\n        ctx.fill();\r\n\r\n        ctx.restore();\r\n    }\r\n}\r\n\r\nconst colorAnimation = element.animate(\r\n    [\r\n        {\r\n            backgroundColor: \"#88aaee\",\r\n        },\r\n        {\r\n            backgroundColor: \"#aa88ee\",\r\n        },\r\n        {\r\n            backgroundColor: \"#aaeeaa\",\r\n        },\r\n        {\r\n            backgroundColor: \"#eeeeaa\",\r\n        },\r\n        {\r\n            backgroundColor: \"#88aaee\",\r\n        },\r\n    ],\r\n    {\r\n        duration: 25000,\r\n        direction: \"normal\",\r\n        iterations: Infinity,\r\n    }\r\n);\r\n\r\nconst triangles = Array.from({ length: 50 }, () => new Triangle());\r\nconst playBackgroundLoop = new LoopManager();\r\nplayBackgroundLoop.addEvent([\"loop\"], () => {\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n    triangles.forEach((tri) => {\r\n        tri.update();\r\n        tri.draw(ctx);\r\n    });\r\n});\r\n\r\nexport const playBackground = {\r\n    reset: () => {\r\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n        triangles.forEach((tri) => {\r\n            tri.reset();\r\n        });\r\n        playBackgroundLoop.reset();\r\n        colorAnimation.cancel();\r\n    },\r\n    start: () => {\r\n        playBackgroundLoop.start();\r\n        if (colorAnimation.playState != \"running\") {\r\n            colorAnimation.play();\r\n        }\r\n    },\r\n    stop: () => {\r\n        playBackgroundLoop.stop();\r\n        colorAnimation.pause();\r\n    },\r\n};\r\n\r\n// ウィンドウサイズ変更対応\r\nwindow.addEventListener(\"resize\", () => {\r\n    canvas.width = qs(\"body\").clientWidth;\r\n    canvas.height = qs(\"body\").clientHeight;\r\n});\r\n","import { EventManager } from \"../../EventManager\";\r\nimport { gameEvents, GameMode } from \"../GameMode\";\r\nimport { GamePlayer } from \"../GamePlayer\";\r\nimport { pageManager } from \"../../PageManager\";\r\nimport { gamepadConfigs, graphicSetting } from \"../../Run\";\r\nimport * as Setting from \"../../Settings\";\r\nimport { qsAll, removeMousePointerTemporary } from \"../../Utils\";\r\nimport { playBackground } from \"../../PlayBackground\";\r\n\r\nexport class Mode1 extends GameMode {\r\n    constructor(players: GamePlayer[]) {\r\n        super(players);\r\n        players.forEach((_, i) => {\r\n            this.addPlayerBehavior(i);\r\n        });\r\n    }\r\n\r\n    start(): void {\r\n        this.players.forEach((player) => {\r\n            player.start();\r\n        });\r\n        if (graphicSetting.playBackground) {\r\n            playBackground.start();\r\n        }\r\n    }\r\n    stop(): void {\r\n        this.players.forEach((player) => {\r\n            player.stop();\r\n        });\r\n        if (graphicSetting.playBackground) {\r\n            playBackground.stop();\r\n        }\r\n    }\r\n    proceedPlayerFinish(): void {\r\n        if (this.state.hasFinished) {\r\n            return;\r\n        }\r\n\r\n        //プレイヤーの生死状態を更新する\r\n        this.players.forEach((p) => {\r\n            p.updateGameTime();\r\n            if (p.playInfo.gameTime == 0) {\r\n                if (p.state.hasFinished) {\r\n                    return;\r\n                }\r\n                p.finish();\r\n                p.label.updateContents({\r\n                    gameTime: p.playInfo.gameTime + \"\",\r\n                    playTime: \"\",\r\n                    line: \"\",\r\n                    lastTrick: p.playInfo.lastTrick ? p.playInfo.lastTrick.name : \"　\",\r\n                    chain: p.playInfo.chain + \"\",\r\n                    score: p.playInfo.score + \"\",\r\n                });\r\n                if (this.players.length != 1) {\r\n                    p.animations.finish.play();\r\n                }\r\n            }\r\n        });\r\n\r\n        const playingPlayers = this.players.filter((player) => !player.state.hasFinished);\r\n        //一人プレイでなく、プレイしている人が一人なら勝利\r\n        if (playingPlayers.length == 1 && this.players.length >= 1) {\r\n            this.winners = [playingPlayers[0]];\r\n            playingPlayers[0].updateGameTime();\r\n            //プレイしている人がいない場合、最も時間を残している人が全員勝利\r\n        } else if (playingPlayers.length == 0) {\r\n            const max = Math.max(\r\n                ...this.players.map((player) => {\r\n                    player.updateGameTime();\r\n                    return player.playInfo.gameTime;\r\n                })\r\n            );\r\n            this.winners = this.players.filter((player) => player.playInfo.gameTime == max);\r\n        }\r\n        //勝敗が決しているなら終了\r\n        if (this.winners.length > 0) {\r\n            this.state.hasFinished = true;\r\n            this.stop();\r\n            this.players.forEach((p) => {\r\n                p.label.updateContents({\r\n                    gameTime: p.playInfo.gameTime + \"\",\r\n                    playTime: \"\",\r\n                    line: \"\",\r\n                    lastTrick: p.playInfo.lastTrick ? p.playInfo.lastTrick.name : \"　\",\r\n                    chain: p.playInfo.chain + \"\",\r\n                    score: p.playInfo.score + \"\",\r\n                });\r\n                p.playInfo.playTime = p.loop.g$elapsedTime;\r\n            });\r\n            qsAll(\".resultLabel\").forEach((resultLabel) => {\r\n                if (this.winners.length < this.players.length) {\r\n                    resultLabel.innerHTML = `Player ${this.winners.map((player) => this.players.indexOf(player) + 1).toString()} won!`;\r\n                } else if (1 < this.players.length) {\r\n                    resultLabel.innerHTML = `Draw`;\r\n                } else {\r\n                    resultLabel.innerHTML = `Score : ${this.winners[0].playInfo.score}`;\r\n                }\r\n            });\r\n\r\n            EventManager.executeListeningEvents(\"gameFinish\", this.eventIds);\r\n        }\r\n    }\r\n\r\n    addPlayerBehavior(index: number): void {\r\n        const p = this.players[index];\r\n        const input = p.input.g$manager;\r\n        const operate = (keyCode: string) => {\r\n            if ([\"ArrowLeft\", ...gamepadConfigs[index].moveLeft].includes(keyCode)) {\r\n                p.operator.move(\"left\");\r\n            } else if ([\"ArrowRight\", ...gamepadConfigs[index].moveRight].includes(keyCode)) {\r\n                p.operator.move(\"right\");\r\n            } else if ([\"ArrowDown\", ...gamepadConfigs[index].moveDown].includes(keyCode)) {\r\n                p.operator.move(\"down\");\r\n            } else if ([\"ArrowUp\", ...gamepadConfigs[index].put].includes(keyCode)) {\r\n                p.operator.put();\r\n            } else if ([\"KeyC\", ...gamepadConfigs[index].spinLeft].includes(keyCode)) {\r\n                p.operator.spin(\"left\");\r\n            } else if ([\"KeyV\", ...gamepadConfigs[index].spinRight].includes(keyCode)) {\r\n                p.operator.spin(\"right\");\r\n            } else if ([\"KeyB\", ...gamepadConfigs[index].unput].includes(keyCode)) {\r\n                p.operator.unput();\r\n            } else if ([\"Space\", ...gamepadConfigs[index].hold].includes(keyCode)) {\r\n                p.operator.hold();\r\n            } else if ([\"Enter\", ...gamepadConfigs[index].removeLine].includes(keyCode)) {\r\n                p.operator.removeLine();\r\n            } else if ([\"KeyP\", ...gamepadConfigs[index].pause].includes(keyCode)) {\r\n                if (!p.loop.g$isLooping || this.state.hasFinished) {\r\n                    return;\r\n                }\r\n                this.stop();\r\n                pageManager.setPage(\"pause\");\r\n            } else {\r\n                return;\r\n            }\r\n            removeMousePointerTemporary();\r\n            p.updateCanvas();\r\n        };\r\n\r\n        p.label.s$visible = { gameTime: true, playTime: false, line: false, lastTrick: true, chain: true, score: true };\r\n        const updateLabel = () => {\r\n            p.label.updateContents({\r\n                gameTime: p.playInfo.gameTime + \"\",\r\n                playTime: \"\",\r\n                line: \"\",\r\n                lastTrick: p.playInfo.lastTrick ? p.playInfo.lastTrick.name : \"　\",\r\n                chain: p.playInfo.chain + \"\",\r\n                score: p.playInfo.score + \"\",\r\n            });\r\n        };\r\n\r\n        let lastOperateTime = 0;\r\n\r\n        gameEvents.push(\r\n            input.addEvent([\"onKeydown\", \"onButtondown\", \"onStickActive\"], () => {\r\n                if (!p.loop.g$isLooping) {\r\n                    return;\r\n                }\r\n                operate(input.g$latestPressingKey);\r\n            }),\r\n\r\n            p.loop.addEvent([\"loop\"], () => {\r\n                const moveKeys = [\"ArrowLeft\", \"ArrowRight\", \"ArrowDown\", ...gamepadConfigs[index].moveLeft, ...gamepadConfigs[index].moveRight, ...gamepadConfigs[index].moveDown];\r\n                const latestKey = input.getLatestPressingKey(moveKeys);\r\n                const pressTime = Date.now() - input.getPressTime(latestKey);\r\n                if (pressTime >= Setting.input.delayTime && latestKey != \"\") {\r\n                    if (pressTime - lastOperateTime >= Setting.input.repeatTime) {\r\n                        operate(latestKey);\r\n                        lastOperateTime = pressTime;\r\n                    }\r\n                } else {\r\n                    lastOperateTime = 0;\r\n                }\r\n\r\n                p.playInfo.playTime = p.loop.g$elapsedTime;\r\n                updateLabel();\r\n                p.updateGameTime();\r\n\r\n                if (p.playInfo.gameTime <= Setting.warningGameTime) {\r\n                    if (p.animations.timeWarning.playState != \"running\") {\r\n                        p.animations.timeWarning.play();\r\n                    }\r\n                } else if (p.animations.timeWarning.playState == \"running\") {\r\n                    p.animations.timeWarning.cancel();\r\n                }\r\n                if (p.playInfo.gameTime == 0) {\r\n                    this.proceedPlayerFinish();\r\n                }\r\n\r\n                if (p.damageInfo.damageTask && p.loop.g$elapsedTime - p.damageInfo.lastDamageTime >= Setting.damageWaitingTime) {\r\n                    if (p.animations.warning.playState != \"running\") {\r\n                        p.animations.caution.cancel();\r\n                        p.animations.warning.play();\r\n                    }\r\n                }\r\n            }),\r\n\r\n            p.operator.addEvent([\"put\"], () => {\r\n                p.playInfo.put += 1;\r\n                p.playInfo.lastTrick = null;\r\n                p.playInfo.chain = 0;\r\n                p.playInfo.score += 10;\r\n\r\n                p.playInfo.penaltyTask = Math.max(p.playInfo.penaltyTask - 1, 0);\r\n                if (p.damageInfo.damageTask) {\r\n                    if (p.damageInfo.damageTask > p.damageInfo.attackTask) {\r\n                        console.log(`Player ${index + 1} damage has offset : ${p.damageInfo.attackTask}`);\r\n                        p.damageInfo.damageTask -= p.damageInfo.attackTask;\r\n                        console.log(`Rest damage is ${p.damageInfo.damageTask}`);\r\n                        p.damageInfo.attackTask = 0;\r\n                    } else {\r\n                        console.log(`Player ${index + 1} attack has offset : ${p.damageInfo.damageTask}`);\r\n                        p.damageInfo.attackTask -= p.damageInfo.damageTask;\r\n                        if (p.damageInfo.damageTask) {\r\n                            console.log(`Rest attack is ${p.damageInfo.attackTask}`);\r\n                        } else {\r\n                            console.log(`Damage and attack have just offset`);\r\n                        }\r\n                        p.damageInfo.damageTask = 0;\r\n                        p.animations.caution.cancel();\r\n                        p.animations.warning.cancel();\r\n                    }\r\n                }\r\n                if (p.damageInfo.damageTask && p.loop.g$elapsedTime - p.damageInfo.lastDamageTime >= Setting.damageWaitingTime) {\r\n                    console.log(`Player ${index + 1} has damaged: ${p.damageInfo.damageTask}`);\r\n                    p.damage();\r\n                    p.damageInfo.totalDamage += p.damageInfo.damageTask;\r\n                }\r\n                if (p.damageInfo.attackTask) {\r\n                    console.log(`Player ${index + 1} has attacked: ${p.damageInfo.attackTask}`);\r\n                    this.players.forEach((player, i) => {\r\n                        if (i != index) {\r\n                            player.addDamageTask(p.damageInfo.attackTask);\r\n                        }\r\n                    });\r\n                    p.damageInfo.totalAttack += p.damageInfo.attackTask;\r\n                    p.damageInfo.attackTask = 0;\r\n                }\r\n            }),\r\n\r\n            p.operator.addEvent([\"unput\"], () => {\r\n                p.playInfo.put -= 1;\r\n                p.playInfo.score -= 10;\r\n                p.playInfo.penalty += Setting.penalty.unput;\r\n                p.playInfo.unput += 1;\r\n            }),\r\n\r\n            p.operator.addEvent([\"hold\"], () => {\r\n                p.playInfo.hold += 1;\r\n            }),\r\n\r\n            p.operator.addEvent([\"removeLine\"], () => {\r\n                const lastTrick = p.operator.g$lastTrick;\r\n                if (lastTrick) {\r\n                    p.playInfo.penaltyTask = 0;\r\n                    if ([\"一列揃え(上)\", \"一列揃え(下)\"].includes(lastTrick.name)) {\r\n                        p.playInfo.line += 1;\r\n                    }\r\n                    p.playInfo.score += p.playInfo.chain * 100;\r\n                    p.playInfo.score += (lastTrick.time + lastTrick.attack) * 50;\r\n                    p.damageInfo.attackTask += lastTrick.attack + Math.ceil(p.playInfo.chain / 5);\r\n                    p.playInfo.maxChain = Math.max(p.playInfo.maxChain, p.playInfo.chain);\r\n                    p.playInfo.recovery += lastTrick.time;\r\n                    p.playInfo.chain += 1;\r\n                    p.playInfo.trickCount += 1;\r\n                    if (graphicSetting.removeShake) {\r\n                        p.animations.removeLineWithTrick.play();\r\n                    }\r\n                } else {\r\n                    p.playInfo.penalty += p.playInfo.penaltyTask;\r\n                    p.playInfo.penaltyTask = Setting.penalty.removeLine;\r\n                    p.playInfo.chain = 0;\r\n                    if (graphicSetting.removeShake) {\r\n                        p.animations.removeLineWithoutTrick.play();\r\n                    }\r\n                }\r\n                p.playInfo.lastTrick = p.operator.g$lastTrick;\r\n                p.playInfo.remove += 1;\r\n            })\r\n        );\r\n    }\r\n}\r\n","import { EventManager } from \"../../EventManager\";\r\nimport { gameEvents, GameMode } from \"../GameMode\";\r\nimport { GamePlayer } from \"../GamePlayer\";\r\nimport { pageManager } from \"../../PageManager\";\r\nimport { gamepadConfigs, graphicSetting } from \"../../Run\";\r\nimport * as Setting from \"../../Settings\";\r\nimport { qsAll, removeMousePointerTemporary } from \"../../Utils\";\r\nimport { playBackground } from \"../../PlayBackground\";\r\n\r\nexport class Mode2 extends GameMode {\r\n    constructor(players: GamePlayer[]) {\r\n        super(players);\r\n        players.forEach((_, i) => {\r\n            this.addPlayerBehavior(i);\r\n        });\r\n    }\r\n\r\n    start(): void {\r\n        this.players.forEach((player) => {\r\n            player.start();\r\n        });\r\n        if (graphicSetting.playBackground) {\r\n            playBackground.start();\r\n        }\r\n    }\r\n    stop(): void {\r\n        this.players.forEach((player) => {\r\n            player.stop();\r\n        });\r\n        if (graphicSetting.playBackground) {\r\n            playBackground.stop();\r\n        }\r\n    }\r\n    proceedPlayerFinish(): void {\r\n        if (this.state.hasFinished) {\r\n            return;\r\n        }\r\n        this.winners = this.players.filter((player) => player.state.hasFinished);\r\n        this.state.hasFinished = true;\r\n        this.stop();\r\n        if (this.players.length != 1) {\r\n            this.players\r\n                .filter((p) => !p.state.hasFinished)\r\n                .forEach((p) => {\r\n                    p.animations.finish.play();\r\n                });\r\n        }\r\n\r\n        this.players.forEach((p) => {\r\n            p.label.updateContents({\r\n                gameTime: \"\",\r\n                playTime: p.g$playTimeString,\r\n                line: p.playInfo.line + \"\",\r\n                lastTrick: \"\",\r\n                chain: p.playInfo.chain + \"\",\r\n                score: p.playInfo.score + \"\",\r\n            });\r\n            p.playInfo.playTime = p.loop.g$elapsedTime;\r\n        });\r\n        qsAll(\".resultLabel\").forEach((resultLabel) => {\r\n            if (this.winners.length < this.players.length) {\r\n                resultLabel.innerHTML = `Player ${this.winners.map((player) => this.players.indexOf(player) + 1).toString()} won! : ${this.winners[0].g$playTimeString}`;\r\n            } else if (1 < this.players.length) {\r\n                resultLabel.innerHTML = `Draw : ${this.winners[0].g$playTimeString}`;\r\n            } else {\r\n                resultLabel.innerHTML = `Time : ${this.winners[0].g$playTimeString}`;\r\n            }\r\n        });\r\n        EventManager.executeListeningEvents(\"gameFinish\", this.eventIds);\r\n    }\r\n\r\n    addPlayerBehavior(index: number): void {\r\n        const p = this.players[index];\r\n        const input = p.input.g$manager;\r\n        const operate = (keyCode: string) => {\r\n            if ([\"ArrowLeft\", ...gamepadConfigs[index].moveLeft].includes(keyCode)) {\r\n                p.operator.move(\"left\");\r\n            } else if ([\"ArrowRight\", ...gamepadConfigs[index].moveRight].includes(keyCode)) {\r\n                p.operator.move(\"right\");\r\n            } else if ([\"ArrowDown\", ...gamepadConfigs[index].moveDown].includes(keyCode)) {\r\n                p.operator.move(\"down\");\r\n            } else if ([\"ArrowUp\", ...gamepadConfigs[index].put].includes(keyCode)) {\r\n                p.operator.put();\r\n            } else if ([\"KeyC\", ...gamepadConfigs[index].spinLeft].includes(keyCode)) {\r\n                p.operator.spin(\"left\");\r\n            } else if ([\"KeyV\", ...gamepadConfigs[index].spinRight].includes(keyCode)) {\r\n                p.operator.spin(\"right\");\r\n            } else if ([\"KeyB\", ...gamepadConfigs[index].unput].includes(keyCode)) {\r\n                p.operator.unput();\r\n            } else if ([\"Space\", ...gamepadConfigs[index].hold].includes(keyCode)) {\r\n                p.operator.hold();\r\n            } else if ([\"Enter\", ...gamepadConfigs[index].removeLine].includes(keyCode)) {\r\n                p.operator.removeLine();\r\n            } else if ([\"KeyP\", ...gamepadConfigs[index].pause].includes(keyCode)) {\r\n                if (!p.loop.g$isLooping || this.state.hasFinished) {\r\n                    return;\r\n                }\r\n                this.stop();\r\n                pageManager.setPage(\"pause\");\r\n            } else {\r\n                return;\r\n            }\r\n            removeMousePointerTemporary();\r\n            p.updateCanvas();\r\n        };\r\n\r\n        p.label.s$visible = { gameTime: false, playTime: true, line: true, lastTrick: false, chain: true, score: true };\r\n        const updateLabel = () => {\r\n            p.label.updateContents({\r\n                gameTime: \"\",\r\n                playTime: p.g$playTimeString,\r\n                line: p.playInfo.line + \"\",\r\n                lastTrick: \"\",\r\n                chain: p.playInfo.chain + \"\",\r\n                score: p.playInfo.score + \"\",\r\n            });\r\n        };\r\n        let lastOperateTime = 0;\r\n        p.canvas.guideBorder = true;\r\n        gameEvents.push(\r\n            input.addEvent([\"onKeydown\", \"onButtondown\", \"onStickActive\"], () => {\r\n                if (!p.loop.g$isLooping) {\r\n                    return;\r\n                }\r\n                operate(input.g$latestPressingKey);\r\n            }),\r\n\r\n            p.loop.addEvent([\"loop\"], () => {\r\n                const moveKeys = [\"ArrowLeft\", \"ArrowRight\", \"ArrowDown\", ...gamepadConfigs[index].moveLeft, ...gamepadConfigs[index].moveRight, ...gamepadConfigs[index].moveDown];\r\n                const latestKey = input.getLatestPressingKey(moveKeys);\r\n                const pressTime = Date.now() - input.getPressTime(latestKey);\r\n                if (pressTime >= Setting.input.delayTime && latestKey != \"\") {\r\n                    if (pressTime - lastOperateTime >= Setting.input.repeatTime) {\r\n                        operate(latestKey);\r\n                        lastOperateTime = pressTime;\r\n                    }\r\n                } else {\r\n                    lastOperateTime = 0;\r\n                }\r\n                p.playInfo.playTime = p.loop.g$elapsedTime;\r\n                updateLabel();\r\n            }),\r\n\r\n            p.operator.addEvent([\"put\"], () => {\r\n                p.playInfo.put += 1;\r\n                p.playInfo.lastTrick = null;\r\n                p.playInfo.chain = 0;\r\n                p.playInfo.score += 10;\r\n            }),\r\n\r\n            p.operator.addEvent([\"unput\"], () => {\r\n                p.playInfo.put -= 1;\r\n                p.playInfo.score -= 10;\r\n                p.playInfo.unput += 1;\r\n            }),\r\n\r\n            p.operator.addEvent([\"hold\"], () => {\r\n                p.playInfo.hold += 1;\r\n            }),\r\n\r\n            p.operator.addEvent([\"removeLine\"], () => {\r\n                const lastTrick = p.operator.g$lastTrick;\r\n                if (lastTrick) {\r\n                    if ([\"一列揃え(上)\", \"一列揃え(下)\"].includes(lastTrick.name)) {\r\n                        p.playInfo.line += 1;\r\n                        p.playInfo.score += p.playInfo.chain * 100;\r\n                        p.playInfo.score += (lastTrick.time + lastTrick.attack) * 50;\r\n                        p.playInfo.chain += 1;\r\n                        p.playInfo.maxChain = Math.max(p.playInfo.maxChain, p.playInfo.chain);\r\n                        p.canvas.guideBorderHeight = 15 - p.playInfo.line;\r\n                        p.canvas.paintPlayCanvas();\r\n                        if (graphicSetting.removeShake) {\r\n                            p.animations.removeLineWithTrick.play();\r\n                        }\r\n                    } else {\r\n                        p.playInfo.chain = 0;\r\n                        if (graphicSetting.removeShake) {\r\n                            p.animations.removeLineWithoutTrick.play();\r\n                        }\r\n                    }\r\n                } else {\r\n                    p.playInfo.chain = 0;\r\n                    if (graphicSetting.removeShake) {\r\n                        p.animations.removeLineWithoutTrick.play();\r\n                    }\r\n                }\r\n                p.playInfo.lastTrick = p.operator.g$lastTrick;\r\n                p.playInfo.remove += 1;\r\n\r\n                if (p.playInfo.line >= 15) {\r\n                    p.finish();\r\n                    this.proceedPlayerFinish();\r\n                }\r\n            })\r\n        );\r\n    }\r\n}\r\n","/**\r\n * ブロックの種類\r\n */\r\nexport type BlockKind = \"L\" | \"J\" | \"p\" | \"q\" | \"U\" | \"I\" | \"g\";\r\n\r\nexport type BlockProperty = [BlockKind, boolean, boolean];\r\n\r\n/**\r\n * ブロックの表示している形の状態\r\n */\r\nexport type ShapeInfo = [boolean, boolean];\r\n\r\n/**\r\n * 仮想的な表示単位\r\n * 実際の描画処理はここではない\r\n */\r\nexport class Block {\r\n    /**\r\n     * この表示単位の表す色の種類\r\n     */\r\n    private kind: BlockKind = \"g\";\r\n    /**\r\n     * 上向き(上がとがっている、true)か下向きか\r\n     */\r\n    private direction: boolean = true;\r\n    /**\r\n     * 表示状態\r\n     */\r\n    private visible: boolean = false;\r\n\r\n    constructor() {}\r\n\r\n    /**\r\n     * 種類\r\n     */\r\n    get g$kind(): BlockKind {\r\n        return this.kind;\r\n    }\r\n\r\n    /**\r\n     * 上向き(true)か下向き(false)か\r\n     */\r\n    get g$direction(): boolean {\r\n        return this.direction;\r\n    }\r\n\r\n    /**\r\n     * 表示しているか\r\n     */\r\n    get g$visible(): boolean {\r\n        return this.visible;\r\n    }\r\n\r\n    /**\r\n     * 形の情報\r\n     */\r\n    get g$shapeInfo(): ShapeInfo {\r\n        return [this.direction || !this.visible, this.visible];\r\n    }\r\n\r\n    /**\r\n     * プロパティ\r\n     */\r\n    get g$property(): BlockProperty {\r\n        return [this.kind, this.direction, this.visible];\r\n    }\r\n\r\n    /**\r\n     * 表示中は変更できない\r\n     * @param kind 種類\r\n     */\r\n    set s$kind(kind: BlockKind) {\r\n        console.assert(!this.visible, \"表示中に種類を変更しないでください\");\r\n        this.kind = kind;\r\n    }\r\n\r\n    /**\r\n     * 上向き(true)か下向き(false)かを設定する　表示中は変更できない\r\n     * @param direction 向き\r\n     */\r\n    set s$direction(direction: boolean) {\r\n        console.assert(!this.visible, \"表示中に方向を変更しないでください\");\r\n        this.direction = direction;\r\n    }\r\n\r\n    /**\r\n     *@param visible 表示状態\r\n     */\r\n    set s$visible(visible: boolean) {\r\n        this.visible = visible;\r\n    }\r\n\r\n    /**\r\n     * プロパティの一括設定\r\n     * @param kind 種類\r\n     * @param direction 上向き(true)か下向きか(false)\r\n     * @param visible 表示状態\r\n     */\r\n    set s$property([kind, direction, visible]: BlockProperty) {\r\n        this.kind = kind;\r\n        this.direction = direction;\r\n        this.visible = visible;\r\n    }\r\n}\r\n","// prettier-ignore\r\n//モンドの形を指定\r\nexport const placement =\r\n        \r\n        {\r\n            L : [\r\n                [[0, 0], [-1, 0], [-2, 0], [1, 0], [1, -1]],\r\n                [[0, 0], [1, 0], [2, 0], [0, -1], [-1, -1]],\r\n                [[0, 0], [1, 0], [1, -1], [0, 1], [1, 1]],\r\n                [[0, 0], [-1, 0], [-1, 1], [1, 0], [2, 0]],\r\n                [[0, 0], [-1, 0], [-2, 0], [0, 1], [1, 1]],\r\n                [[0, 0], [0, -1], [-1, -1], [-1, 0], [-1, 1]],\r\n            ],\r\n            J : [\r\n                [[0, 0], [-1, 0], [-1, -1], [1, 0], [2, 0]],\r\n                [[0, 0], [0, -1], [1, -1], [1, 0], [1, 1]],\r\n                [[0, 0], [0, 1], [-1, 1], [1, 0], [2, 0]],\r\n                [[0, 0], [-1, 0], [-2, 0], [1, 0], [1, 1]],\r\n                [[0, 0], [-1, 0], [-1, -1], [0, 1], [-1, 1]],\r\n                [[0, 0], [-1, -0], [-2, -0], [0, -1], [1, -1]],\r\n            ],\r\n            p : [\r\n                [[0, -1], [0, 0], [1, 0], [2, 0], [-1, 0]],\r\n                [[-1, 0], [0, 0], [0, 1], [1, 1], [1, 0]],\r\n                [[0, -1], [0, 0], [1, 0], [-1, 1], [-1, 0]],\r\n                [[1, 0], [0, 0], [-1, 0], [-2, 0], [0, 1]],\r\n                [[-1, 0], [0, 0], [1, 0], [-1, -1], [0, -1]],\r\n                [[0, 1], [0, 0], [-1, 0], [1, -1], [1, 0]],\r\n            ],\r\n            q : [ //q\r\n                [[0, -1], [0, 0], [1, 0], [-2, 0], [-1, 0]],\r\n                [[0, 1], [0, 0], [1, 0], [-1, -1], [-1, 0]],\r\n                [[-1, 0], [0, 0], [1, 0], [1, -1], [0, -1]],\r\n                [[-1, 0], [0, 0], [1, 0], [2, 0], [0, 1]],\r\n                [[0, -1], [0, 0], [-1, 0], [1, 1], [1, 0]],\r\n                [[-1, 0], [0, 0], [1, 0], [-1, 1], [0, 1]],\r\n            ],\r\n            U : [ //U\r\n                [[0, 0], [1, 0], [1, -1], [-1, 0], [-1, -1]],\r\n                [[0, 0], [1, 0], [2, 0], [0, -1], [1, -1]],\r\n                [[0, 0], [1, 0], [2, 0], [0, 1], [1, 1]],\r\n                [[0, 0], [1, 0], [1, 1], [-1, 0], [-1, 1]],\r\n                [[0, 0], [-1, 0], [-2, 0], [0, 1], [-1, 1]],\r\n                [[0, 0], [-1, 0], [-2, 0], [0, -1], [-1, -1]],\r\n            ],\r\n            I : [ //I\r\n                [[0, 0], [1, 0], [2, 0], [-1, 0], [-2, 0]],\r\n                [[0, 0], [1, 0], [1, 1], [0, -1], [-1, -1]],\r\n                [[0, 0], [1, 0], [1, -1], [0, 1], [-1, 1]],\r\n                [[0, 0], [1, 0], [2, 0], [-1, 0], [-2, 0]],\r\n                [[0, 0], [0, 1], [1, 1], [-1, 0], [-1, -1]],\r\n                [[0, 0], [0, -1], [1, -1], [-1, 0], [-1, 1]],\r\n            ],\r\n            g : [ //g\r\n                [[0, 0], [1, 0], [2, 0], [-1, 0], [-2, 0]],\r\n                [[0, 0], [1, 0], [1, 1], [0, -1], [-1, -1]],\r\n                [[0, 0], [1, 0], [1, -1], [0, 1], [-1, 1]],\r\n                [[0, 0], [1, 0], [2, 0], [-1, 0], [-2, 0]],\r\n                [[0, 0], [0, 1], [1, 1], [-1, 0], [-1, -1]],\r\n                [[0, 0], [0, -1], [1, -1], [-1, 0], [-1, 1]],\r\n            ]\r\n        };\r\n\r\n// prettier-ignore\r\n//回転に伴う軸の補正 壁際などでの感覚的な回転を可能にする\r\n//[種類][回転方向][回転前の回転状態][xかyか]\r\nexport const spinCorrection =\r\n        \r\n        {\r\n            L : [\r\n                [ //右回転\r\n                    [[0, 0], [-1, 0]], //0 > 1\r\n                    [[0, 0], [0, -1]], //1 > 2\r\n                    [[0, 0], [-1, 0], [1, 0], [-1, -1], [0, -1], [1, -1]], //2 > 3\r\n                    [[0, 0], [1, 0], [-1, 0], [0, -1], [1, -1]], //3 > 4\r\n                    [[0, 0], [1, 0]], //4 > 5\r\n                    [[0, 0], [-1, 0], [1, 0], [-1, -1], [0, -1]], //5 > 0\r\n               ],[ //左回転\r\n                    [[0, 0], [0, -1]], //0 > 5\r\n                    [[0, 0], [1, 0], [1, -1], [2, -1]], //1 > 0\r\n                    [[0, 0], [1, 0], [-1, 0], [1, -1]], //2 > 1\r\n                    [[0, 0], [-1, 0], [0, -1]], //3 > 2\r\n                    [[0, 0], [-1, 0], [0, -1], [-1, -1]], //4 > 3\r\n                    [[0, 0], [1, 0], [-1, 0], [-1, -1], [1, -1], [-2, -1], [0, -2]], //5 > 4\r\n                ]\r\n            ],\r\n            J : [ \r\n                [ //右回転\r\n                    [[0, 0], [0, -1]], //0 > 1\r\n                    [[0, 0], [-1, 0], [1, 0], [1, -1], [-1, -1], [2, -1], [0, -2]], //1 > 2\r\n                    [[0, 0], [1, 0], [0, -1], [1, -1]], //2 > 3\r\n                    [[0, 0], [1, 0], [0, -1]], //3 > 4\r\n                    [[0, 0], [-1, 0], [1, 0], [-1, -1]], //4 > 5\r\n                    [[0, 0], [-1, 0], [-1, -1], [-2, -1]], //5 > 0\r\n               ],[ //左回転\r\n                    [[0, 0], [1, 0]], //0 > 5\r\n                    [[0, 0], [1, 0], [-1, 0], [1, -1], [0, -1]], //1 > 0\r\n                    [[0, 0], [-1, 0]], //2 > 1\r\n                    [[0, 0], [-1, 0], [1, 0], [0, -1], [-1, -1]], //3 > 2\r\n                    [[0, 0], [1, 0], [-1, 0], [1, -1], [0, -1], [-1, -1]], //4 > 3\r\n                    [[0, 0], [0, -1]], //5 > 4\r\n                ]\r\n            ],\r\n            p : [\r\n                [ //右回転\r\n                    [[0, 0], [0, -1]], //0 > 1\r\n                    [[0, 0], [1, 0], [0, -1]], //1 > 2\r\n                    [[0, 0], [1, 0], [0, -1], [1, -1]], //2 > 3\r\n                    [[0, 0], [-1, 0]], //3 > 4\r\n                    [[0, 0], [0, -1]], //4 > 5\r\n                    [[0, 0], [-1, 0], [1, 0], [0, -1]], //5 > 0\r\n               ],[ //左回転\r\n                    [[0, 0], [0, -1]], //0 > 5\r\n                    [[0, 0], [-1, 0], [1, 0], [0, -1]], //1 > 0\r\n                    [[0, 0], [0, -1]], //2 > 1\r\n                    [[0, 0], [0, -1]], //3 > 2\r\n                    [[0, 0], [1, 0], [0, -1], [1, -1], [2, -1], [1, -2]], //4 > 3\r\n                    [[0, 0], [1, 0], [-1, 0], [0, -1]], //5 > 4\r\n                ]\r\n            ],\r\n            q : [\r\n                [ //右回転\r\n                    [[0, 0], [0, -1]], //0 > 1\r\n                    [[0, 0], [-1, 0], [1, 0], [0, -1]], //1 > 2\r\n                    [[0, 0], [-1, 0], [0, -1], [-1, -1], [-2, -1], [-1, -2]], //2 > 3\r\n                    [[0, 0], [0, -1]], //3 > 4\r\n                    [[0, 0], [0, -1]], //4 > 5\r\n                    [[0, 0], [1, 0], [-1, 0], [0, -1]], //5 > 0\r\n               ],[ //左回転\r\n                    [[0, 0], [0, -1]], //0 > 5\r\n                    [[0, 0], [1, 0], [-1, 0], [0, -1]], //1 > 0\r\n                    [[0, 0], [0, -1]], //2 > 1\r\n                    [[0, 0], [1, 0]], //3 > 2\r\n                    [[0, 0], [-1, 0], [0, -1], [-1, -1]], //4 > 3\r\n                    [[0, 0], [-1, 0], [0, -1]], //5 > 4\r\n                ]\r\n            ],\r\n            U : [\r\n                [ //右回転\r\n                    [[0, 0], [-1, 0]], //0 > 1\r\n                    [[0, 0], [0, -1]], //1 > 2\r\n                    [[0, 0], [1, 0], [0, -1]], //2 > 3\r\n                    [[0, 0], [1, 0], [0, -1], [1, -1]], //3 > 4\r\n                    [[0, 0], [0, 1]], //4 > 5\r\n                    [[0, 0], [-1, 0]], //5 > 0\r\n               ],[ //左回転\r\n                    [[0, 0], [1, 0]], //0 > 5\r\n                    [[0, 0], [1, 0]], //1 > 0\r\n                    [[0, 0], [0, 1]], //2 > 1\r\n                    [[0, 0], [-1, 0], [0, -1], [-1 ,-1]], //3 > 2\r\n                    [[0, 0], [-1, 0], [0, -1]], //4 > 3\r\n                    [[0, 0], [0, -1]], //5 > 4\r\n                ]\r\n            ],\r\n            I : [\r\n                [ //右回転\r\n                    [[0, 0], [0, -1]], //0 > 1\r\n                    [[0, 0], [0, -1], [1, -1], [2, -1]], //1 > 2\r\n                    [[0, 0], [-1, 0], [1, 0], [0, -1], [-1, -1], [1, -1]], //2 > 3\r\n                    [[0, 0], [0, -1]], //3 > 4\r\n                    [[0, 0], [1, 0], [0, -1]], //4 > 5\r\n                    [[0, 0], [-1, 0], [1, 0], [-2, 0], [-3, 0], [-2, -1], [0, -1], [1, -1]], //5 > 0\r\n               ],[ //左回転\r\n                    [[0, 0], [0, -1]], //0 > 5\r\n                    [[0, 0], [1, 0], [-1, 0], [2, 0], [3, 0], [2, -1], [0, -1], [-1, -1]], //1 > 0\r\n                    [[0, 0], [-1, 0], [0, -1]], //2 > 1\r\n                    [[0, 0], [0, -1]], //3 > 2\r\n                    [[0, 0], [1, 0], [-1, 0], [0, -1], [1, -1], [-1, -1]], //4 > 3\r\n                    [[0, 0], [0, -1], [-1, -1], [-2, -1]], //5 > 4\r\n                ]\r\n            ],\r\n            g : [\r\n                [ //右回転\r\n                    [[0, 0], [0, -1]], //0 > 1\r\n                    [[0, 0], [0, -1], [1, -1], [2, -1]], //1 > 2\r\n                    [[0, 0], [-1, 0], [1, 0], [0, -1], [-1, -1], [1, -1]], //2 > 3\r\n                    [[0, 0], [0, -1]], //3 > 4\r\n                    [[0, 0], [1, 0], [0, -1]], //4 > 5\r\n                    [[0, 0], [-1, 0], [1, 0], [-2, 0], [-3, 0], [-2, -1], [0, -1], [1, -1]], //5 > 0\r\n               ],[ //左回転\r\n                    [[0, 0], [0, -1]], //0 > 5\r\n                    [[0, 0], [1, 0], [-1, 0], [2, 0], [3, 0], [2, -1], [0, -1], [-1, -1]], //1 > 0\r\n                    [[0, 0], [-1, 0], [0, -1]], //2 > 1\r\n                    [[0, 0], [0, -1]], //3 > 2\r\n                    [[0, 0], [1, 0], [-1, 0], [0, -1], [1, -1], [-1, -1]], //4 > 3\r\n                    [[0, 0], [0, -1], [-1, -1], [-2, -1]], //5 > 4\r\n                ]\r\n            ]\r\n        };\r\n\r\nexport const moveCorrection = {\r\n    right: [[1, 0]],\r\n    left: [[-1, 0]],\r\n    down: [\r\n        [0, 1],\r\n        [-1, 1],\r\n        [1, 1],\r\n    ],\r\n};\r\n","import { ShapeInfo } from \"./BlockOperate/Block\";\r\n\r\nexport type TrickInfo = {\r\n    name: string;\r\n    shape: ShapeInfo[];\r\n    time: number;\r\n    attack: number;\r\n};\r\n\r\nexport const trickInfos: TrickInfo[] = [\r\n    {\r\n        name: \"一列揃え(上)\",\r\n        time: 10,\r\n        attack: 10,\r\n        shape: [\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n        ],\r\n    },\r\n    {\r\n        name: \"一列揃え(上)\",\r\n        time: 10,\r\n        attack: 10,\r\n        shape: [\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n        ],\r\n    },\r\n    {\r\n        name: \"地割れ(上)\",\r\n        time: 14,\r\n        attack: 7,\r\n        shape: [\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, false],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n        ],\r\n    },\r\n    {\r\n        name: \"地割れ(下)\",\r\n        time: 14,\r\n        attack: 7,\r\n        shape: [\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [true, false],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n        ],\r\n    },\r\n    {\r\n        name: \"地殻変動(上)\",\r\n        time: 16,\r\n        attack: 8,\r\n        shape: [\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, false],\r\n            [true, false],\r\n            [true, false],\r\n            [true, false],\r\n            [true, false],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n        ],\r\n    },\r\n    {\r\n        name: \"地殻変動(下)\",\r\n        time: 16,\r\n        attack: 8,\r\n        shape: [\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [true, false],\r\n            [true, false],\r\n            [true, false],\r\n            [true, false],\r\n            [true, false],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n        ],\r\n    },\r\n    {\r\n        name: \"トゲトゲ(上)\",\r\n        time: 30,\r\n        attack: 20,\r\n        shape: [\r\n            [true, true],\r\n            [true, false],\r\n            [true, true],\r\n            [true, false],\r\n            [true, true],\r\n            [true, false],\r\n            [true, true],\r\n            [true, false],\r\n            [true, true],\r\n            [true, false],\r\n            [true, true],\r\n            [true, false],\r\n            [true, true],\r\n            [true, false],\r\n            [true, true],\r\n            [true, false],\r\n            [true, true],\r\n        ],\r\n    },\r\n    {\r\n        name: \"トゲトゲ(下)\",\r\n        time: 30,\r\n        attack: 20,\r\n        shape: [\r\n            [false, true],\r\n            [true, false],\r\n            [false, true],\r\n            [true, false],\r\n            [false, true],\r\n            [true, false],\r\n            [false, true],\r\n            [true, false],\r\n            [false, true],\r\n            [true, false],\r\n            [false, true],\r\n            [true, false],\r\n            [false, true],\r\n            [true, false],\r\n            [false, true],\r\n            [true, false],\r\n            [false, true],\r\n        ],\r\n    },\r\n    {\r\n        name: \"牙(上)\",\r\n        time: 50,\r\n        attack: 40,\r\n        shape: [\r\n            [true, true],\r\n            [true, false],\r\n            [false, true],\r\n            [true, false],\r\n            [true, true],\r\n            [true, false],\r\n            [false, true],\r\n            [true, false],\r\n            [true, true],\r\n            [true, false],\r\n            [false, true],\r\n            [true, false],\r\n            [true, true],\r\n            [true, false],\r\n            [false, true],\r\n            [true, false],\r\n            [true, true],\r\n        ],\r\n    },\r\n    {\r\n        name: \"牙(下)\",\r\n        time: 50,\r\n        attack: 40,\r\n        shape: [\r\n            [false, true],\r\n            [true, false],\r\n            [true, true],\r\n            [true, false],\r\n            [false, true],\r\n            [true, false],\r\n            [true, true],\r\n            [true, false],\r\n            [false, true],\r\n            [true, false],\r\n            [true, true],\r\n            [true, false],\r\n            [false, true],\r\n            [true, false],\r\n            [true, true],\r\n            [true, false],\r\n            [false, true],\r\n        ],\r\n    },\r\n    {\r\n        name: \"三つ子山\",\r\n        time: 15,\r\n        attack: 10,\r\n        shape: [\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [true, false],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [true, false],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n        ],\r\n    },\r\n    {\r\n        name: \"五人囃子\",\r\n        time: 30,\r\n        attack: 15,\r\n        shape: [\r\n            [false, true],\r\n            [true, true],\r\n            [true, false],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [true, false],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [true, false],\r\n            [true, true],\r\n            [false, true],\r\n            [true, true],\r\n            [true, false],\r\n            [true, true],\r\n            [false, true],\r\n        ],\r\n    },\r\n];\r\n","import { Block } from \"./Block\";\r\nimport { spinCorrection, moveCorrection } from \"./MondInfo\";\r\nimport { Monoiamond } from \"./Monoiamond\";\r\nimport { Pentiamond } from \"./Pentiamond\";\r\nimport * as Setting from \"../Settings\";\r\nimport { TrickInfo, trickInfos } from \"../Trick\";\r\n\r\nexport class BlockManager {\r\n    private blocks: Block[][];\r\n\r\n    constructor() {\r\n        this.blocks = new Array<Block[]>(Setting.playWidth);\r\n        for (let x = 0; x < Setting.playWidth; x++) {\r\n            this.blocks[x] = new Array<Block>(Setting.playHeight);\r\n            for (let y = 0; y < Setting.playHeight; y++) {\r\n                this.blocks[x][y] = new Block();\r\n            }\r\n        }\r\n    }\r\n\r\n    get g$blockProperties() {\r\n        return this.blocks.map((blockX) => blockX.map((block) => block.g$property));\r\n    }\r\n\r\n    getBlockProperty(x: number, y: number) {\r\n        return this.blocks[x][y].g$property;\r\n    }\r\n\r\n    /**\r\n     * @param mond 指定するmonoiamond\r\n     * @returns 仮想盤面に表示できるか\r\n     */\r\n    canDisplayMonoiamond(mond: Monoiamond): boolean {\r\n        if (!mond.isOnPlayCanvas()) {\r\n            return false;\r\n        }\r\n        return [-1, 0, 1].every((i) => {\r\n            return !this.existDisturbMondWith(mond, i as -1 | 0 | 1);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * @param mond 指定するmonoiamond\r\n     * @param relativeX 相対的なx座標\r\n     * @returns 仮想盤面上の指定した座標に表示に邪魔なmonoiamondが存在するか\r\n     */\r\n    existDisturbMondWith(mond: Monoiamond, relativeX: -1 | 0 | 1): boolean {\r\n        if (mond.g$x + relativeX < 0 || Setting.playWidth <= mond.g$x + relativeX) {\r\n            return false;\r\n        }\r\n        if (relativeX == 0) {\r\n            return this.blocks[mond.g$x][mond.g$y].g$visible;\r\n        }\r\n        return this.blocks[mond.g$x + relativeX][mond.g$y].g$visible && this.blocks[mond.g$x + relativeX][mond.g$y].g$direction == mond.g$direction;\r\n    }\r\n\r\n    /**\r\n     * monoiamondを表示できるなら表示する\r\n     * @param mond 指定するmonoiamond\r\n     */\r\n    displayMonoiamond(mond: Monoiamond): void {\r\n        if (!this.canDisplayMonoiamond(mond)) {\r\n            return;\r\n        }\r\n        this.blocks[mond.g$x][mond.g$y].s$property = [mond.g$kind, mond.g$direction, true];\r\n        mond.s$visible = true;\r\n    }\r\n\r\n    remove(x: number, y: number) {\r\n        this.blocks[x][y].s$visible = false;\r\n    }\r\n\r\n    /**\r\n     * monoiamondを削除する\r\n     * @param mond 指定するmonoiamond\r\n     */\r\n    removeMonoiamond(mond: Monoiamond): void {\r\n        if (!mond.g$visible) {\r\n            return;\r\n        }\r\n        this.remove(mond.g$x, mond.g$y);\r\n        mond.s$visible = false;\r\n    }\r\n\r\n    /**\r\n     * @param mond 指定するpentiamond\r\n     * @returns 仮想盤面に表示できるか\r\n     */\r\n    canDisplayPentiamond(mond: Pentiamond): boolean {\r\n        return mond.g$monoiamonds.every((monoiamond) => {\r\n            return this.canDisplayMonoiamond(monoiamond);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * pentiamondを表示できるなら表示する\r\n     * @param mond 指定するpentiamond\r\n     */\r\n    displayPentiamond(mond: Pentiamond): void {\r\n        if (!this.canDisplayPentiamond(mond)) {\r\n            return;\r\n        }\r\n        mond.g$monoiamonds.forEach((monoiamond) => {\r\n            this.displayMonoiamond(monoiamond);\r\n        });\r\n        mond.s$visible = true;\r\n    }\r\n\r\n    /**\r\n     * pentiamondを削除する\r\n     * @param mond 指定するpentiamond\r\n     */\r\n    removePentiamond(mond: Pentiamond): void {\r\n        if (!mond.g$visible) {\r\n            return;\r\n        }\r\n        mond.g$monoiamonds.forEach((monoiamond) => {\r\n            this.removeMonoiamond(monoiamond);\r\n        });\r\n        mond.s$visible = false;\r\n    }\r\n\r\n    /**\r\n     * pentiamondを回転補正に則って回転させる\r\n     * @param mond 指定するpentiamond\r\n     * @param rotate 回転方向\r\n     * @returns 回転に成功したか\r\n     */\r\n    spin(mond: Pentiamond, rotate: \"right\" | \"left\"): boolean {\r\n        if (!mond.g$visible) {\r\n            return false;\r\n        }\r\n        this.removePentiamond(mond);\r\n        const displacement = spinCorrection[mond.g$kind][rotate == \"right\" ? 0 : 1][mond.g$direction];\r\n        const x = mond.g$x;\r\n        const y = mond.g$y;\r\n        mond.s$direction = mond.g$direction + (rotate == \"right\" ? 1 : -1);\r\n        for (let i = 0; i < displacement.length; i++) {\r\n            mond.s$position = [x + displacement[i][0], y + displacement[i][1]];\r\n            if (this.canDisplayPentiamond(mond)) {\r\n                this.displayPentiamond(mond);\r\n                return true;\r\n            }\r\n        }\r\n        mond.s$direction = mond.g$direction + (rotate == \"right\" ? -1 : 1);\r\n        mond.s$position = [x, y];\r\n        this.displayPentiamond(mond);\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * pentiamondを移動補正に則って移動させる\r\n     * @param mond 指定するpentiamond\r\n     * @param moveDirection 移動方向\r\n     * @returns 移動に成功したか\r\n     */\r\n    move(mond: Pentiamond, moveDirection: \"right\" | \"left\" | \"down\"): boolean {\r\n        if (!mond.g$visible) {\r\n            return false;\r\n        }\r\n        this.removePentiamond(mond);\r\n        const [x, y] = mond.g$position;\r\n        const displacement = moveCorrection[moveDirection];\r\n        for (let i = 0; i < displacement.length; i++) {\r\n            mond.s$position = [x + displacement[i][0], y + displacement[i][1]];\r\n            if (this.canDisplayPentiamond(mond)) {\r\n                this.displayPentiamond(mond);\r\n                return true;\r\n            }\r\n        }\r\n        mond.s$position = [x, y];\r\n        this.displayPentiamond(mond);\r\n        return false;\r\n    }\r\n\r\n    canFall(mond: Pentiamond) {\r\n        if (!mond.g$visible) {\r\n            return false;\r\n        }\r\n        const y = mond.g$y;\r\n        this.removePentiamond(mond);\r\n        mond.s$y = y + 1;\r\n        const result = this.canDisplayPentiamond(mond);\r\n        mond.s$y = y;\r\n        this.displayPentiamond(mond);\r\n        return result;\r\n    }\r\n\r\n    fall(mond: Pentiamond): boolean {\r\n        if (this.canFall(mond)) {\r\n            this.removePentiamond(mond);\r\n            mond.s$y = mond.g$y + 1;\r\n            this.displayPentiamond(mond);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    isEmpty(): boolean {\r\n        return this.blocks.every((blockX) => {\r\n            return blockX.every((block) => {\r\n                return !block.g$visible;\r\n            });\r\n        });\r\n    }\r\n\r\n    removeLine(): TrickInfo | null {\r\n        const lineShape = this.blocks\r\n            .map((blockX) => blockX[Setting.playHeight - 1].g$shapeInfo)\r\n            .flat()\r\n            .join();\r\n\r\n        const result = trickInfos.find((trickInfo) => {\r\n            return trickInfo.shape.flat().join() == lineShape;\r\n        });\r\n\r\n        for (let x = 0; x < Setting.playWidth; x++) {\r\n            for (let y = Setting.playHeight - 2; y >= 0; y--) {\r\n                this.blocks[x][y + 1].s$property = [this.blocks[x][y].g$kind, ...this.blocks[x][y].g$shapeInfo];\r\n            }\r\n            this.blocks[x][0].s$property = [\"g\", true, false];\r\n        }\r\n        return result ?? null;\r\n    }\r\n}\r\n","import { BlockKind } from \"./Block\";\r\nimport { mixArray } from \"../Utils\";\r\n\r\nexport class NextManager {\r\n    private next: BlockKind[] = [\"L\", \"J\", \"p\", \"q\", \"U\", \"I\"];\r\n    private next2: BlockKind[];\r\n    private holdKind: BlockKind | null = null;\r\n    private currentKind: BlockKind | null = null;\r\n    private prevKind: BlockKind | null = null;\r\n    private count: number = 0;\r\n    private nextMemory: BlockKind[] = [];\r\n\r\n    constructor() {\r\n        this.next2 = window.structuredClone(this.next);\r\n        mixArray(this.next);\r\n        mixArray(this.next2);\r\n        this.nextMemory = window.structuredClone(this.next);\r\n    }\r\n\r\n    get g$holdKind(): BlockKind | null {\r\n        return this.holdKind;\r\n    }\r\n\r\n    get g$currentKind(): BlockKind | null {\r\n        return this.currentKind;\r\n    }\r\n\r\n    get g$next(): BlockKind[] {\r\n        return window.structuredClone(this.next);\r\n    }\r\n\r\n    get g$prevKind(): BlockKind | null {\r\n        return this.prevKind;\r\n    }\r\n\r\n    get g$count(): number {\r\n        return this.count;\r\n    }\r\n\r\n    get g$nextMemory(): BlockKind[] {\r\n        return window.structuredClone(this.nextMemory);\r\n    }\r\n\r\n    set s$next(next: BlockKind[]) {\r\n        this.next = window.structuredClone(next);\r\n        this.next2 = [];\r\n    }\r\n\r\n    forgetPrev() {\r\n        this.prevKind = null;\r\n    }\r\n\r\n    private popNext() {\r\n        if (this.next.length == this.next2.length) {\r\n            this.next.push(this.next2[this.count % this.next2.length]);\r\n            this.nextMemory.push(this.next[this.next2.length]!);\r\n        }\r\n        this.currentKind = this.next.shift()!;\r\n        this.count++;\r\n        if (this.count % this.next2.length == 0) {\r\n            mixArray(this.next2);\r\n        }\r\n    }\r\n\r\n    proceed() {\r\n        this.prevKind = this.currentKind;\r\n        this.popNext();\r\n    }\r\n\r\n    hold() {\r\n        if (!this.currentKind) {\r\n            return;\r\n        }\r\n        if (!this.holdKind) {\r\n            this.holdKind = this.currentKind;\r\n            this.popNext();\r\n        } else {\r\n            [this.holdKind, this.currentKind] = [this.currentKind, this.holdKind];\r\n        }\r\n    }\r\n\r\n    back() {\r\n        if (!this.prevKind) {\r\n            return;\r\n        }\r\n        this.count--;\r\n        this.next.unshift(this.currentKind!);\r\n        this.currentKind = this.prevKind;\r\n        this.prevKind = null;\r\n    }\r\n}\r\n","import { BlockKind } from \"./Block\";\r\nimport * as Setting from \"../Settings\";\r\n\r\n/**\r\n * monoiamondの状態\r\n */\r\nexport type MondState = [number, number, BlockKind, boolean];\r\n\r\n/**\r\n * 仮想的な盤面上における一つの三角(monoiamond)を表す\r\n */\r\nexport class Monoiamond {\r\n    private x: number;\r\n    private y: number;\r\n    private kind: BlockKind = \"g\";\r\n    private direction: boolean = true;\r\n    private visible: boolean = false;\r\n\r\n    constructor(x: number = Setting.initialX, y: number = Setting.initialY, kind: BlockKind = \"g\", direction: boolean = true) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.kind = kind;\r\n        this.direction = direction;\r\n    }\r\n\r\n    /**\r\n     * x座標\r\n     */\r\n    get g$x(): number {\r\n        return this.x;\r\n    }\r\n\r\n    /**\r\n     * y座標\r\n     */\r\n    get g$y(): number {\r\n        return this.y;\r\n    }\r\n\r\n    /**\r\n     * 種類\r\n     */\r\n    get g$kind(): BlockKind {\r\n        return this.kind;\r\n    }\r\n\r\n    /**\r\n     * 上向き(true)か下向き(false)か\r\n     */\r\n    get g$direction(): boolean {\r\n        return this.direction;\r\n    }\r\n\r\n    /**\r\n     * 表示状態\r\n     */\r\n    get g$visible(): boolean {\r\n        return this.visible;\r\n    }\r\n\r\n    /**\r\n     * コピー\r\n     */\r\n    get g$copy(): Monoiamond {\r\n        const copy = new Monoiamond(this.x, this.y, this.kind, this.direction);\r\n        copy.s$visible = this.visible;\r\n        return copy;\r\n    }\r\n\r\n    get g$state(): MondState {\r\n        return [this.x, this.y, this.kind, this.direction];\r\n    }\r\n\r\n    /**\r\n     * 表示中は変更できない\r\n     * @param x x座標\r\n     */\r\n    set s$x(x: number) {\r\n        if (this.visible) {\r\n            throw new Error(\"表示中に座標を変更しないでください\");\r\n        }\r\n        this.x = x;\r\n    }\r\n\r\n    /**\r\n     * 表示中は変更できない\r\n     * @param y y座標\r\n     */\r\n    set s$y(y: number) {\r\n        if (this.visible) {\r\n            throw new Error(\"表示中に座標を変更しないでください\");\r\n        }\r\n        this.y = y;\r\n    }\r\n\r\n    /**\r\n     * 表示中は変更できない\r\n     * @param kind 種類\r\n     */\r\n    set s$kind(kind: BlockKind) {\r\n        console.assert(!this.visible, \"表示中に種類を変更しないでください\");\r\n        this.kind = kind;\r\n    }\r\n\r\n    /**\r\n     * 表示中は変更できない\r\n     * @param direction 上向き(true)か下向き(false)か\r\n     */\r\n    set s$direction(direction: boolean) {\r\n        if (this.visible) {\r\n            throw new Error(\"表示中に方向を変更しないでください\");\r\n        }\r\n        this.direction = direction;\r\n    }\r\n\r\n    /**\r\n     * @param visible 表示状態\r\n     */\r\n    set s$visible(visible: boolean) {\r\n        this.visible = visible;\r\n    }\r\n\r\n    /**\r\n     * @returns 座標がプレイ領域内か\r\n     */\r\n    isOnPlayCanvas(): boolean {\r\n        if (this.x < 0 || Setting.playWidth <= this.x || this.y < 0 || Setting.playHeight <= this.y) {\r\n            return false;\r\n        }\r\n        if (!Number.isSafeInteger(this.x) || !Number.isSafeInteger(this.y)) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n}\r\n","import { BlockKind } from \"./Block\";\r\nimport { placement } from \"./MondInfo\";\r\nimport { MondState, Monoiamond } from \"./Monoiamond\";\r\nimport * as Setting from \"../Settings\";\r\n\r\n/**\r\n * 仮想的な盤面上におけるMonoiamondを5つ合わせたモンド(Pentiamond)を表す\r\n */\r\nexport class Pentiamond {\r\n    private x: number;\r\n    private y: number;\r\n    private kind: BlockKind;\r\n    private direction: number = 0;\r\n    private visible: boolean = false;\r\n    private monoiamonds: Monoiamond[];\r\n\r\n    constructor(x: number = Setting.initialX, y: number = Setting.initialY, kind: BlockKind = \"g\", direction: number = 0) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.kind = kind;\r\n        this.direction = direction;\r\n        this.monoiamonds = Array.from({ length: 5 }, () => new Monoiamond());\r\n        this.reload();\r\n    }\r\n\r\n    /**\r\n     * x座標\r\n     */\r\n    get g$x(): number {\r\n        return this.x;\r\n    }\r\n\r\n    /**\r\n     * y座標\r\n     */\r\n    get g$y(): number {\r\n        return this.y;\r\n    }\r\n\r\n    /**\r\n     * [x座標, y座標]\r\n     */\r\n    get g$position(): [number, number] {\r\n        return [this.x, this.y];\r\n    }\r\n\r\n    /**\r\n     * 種類\r\n     */\r\n    get g$kind(): BlockKind {\r\n        return this.kind;\r\n    }\r\n\r\n    /**\r\n     * 向き(0~5)\r\n     */\r\n    get g$direction(): number {\r\n        return this.direction;\r\n    }\r\n\r\n    /**\r\n     * 表示状態\r\n     */\r\n    get g$visible(): boolean {\r\n        return this.visible;\r\n    }\r\n\r\n    /**\r\n     * 構成するmonoiamondの配列\r\n     */\r\n    get g$monoiamonds(): Monoiamond[] {\r\n        return this.monoiamonds.map((monoiamond) => monoiamond.g$copy);\r\n    }\r\n\r\n    /**\r\n     * コピー\r\n     */\r\n    get g$copy(): Pentiamond {\r\n        const copy = new Pentiamond(this.x, this.y, this.kind, this.direction);\r\n        copy.s$visible = this.visible;\r\n        return copy;\r\n    }\r\n\r\n    /**\r\n     * 状態\r\n     */\r\n    get g$states(): MondState[] {\r\n        return this.monoiamonds.map((monoiamond) => monoiamond.g$state);\r\n    }\r\n\r\n    /**\r\n     * 表示中は変更できない\r\n     * @param x x座標\r\n     */\r\n    set s$x(x: number) {\r\n        if (this.visible) {\r\n            throw new Error(\"表示中に座標を変更しないでください\");\r\n        }\r\n        this.x = x;\r\n        this.reload();\r\n    }\r\n\r\n    /**\r\n     * 表示中は変更できない\r\n     * @param y y座標\r\n     */\r\n    set s$y(y: number) {\r\n        if (this.visible) {\r\n            throw new Error(\"表示中に座標を変更しないでください\");\r\n        }\r\n        this.y = y;\r\n        this.reload();\r\n    }\r\n\r\n    /**\r\n     * 座標を一括で設定する　表示中は変更できない\r\n     * @param x x座標\r\n     * @param y y座標\r\n     */\r\n    set s$position([x, y]: [number, number]) {\r\n        if (this.visible) {\r\n            throw new Error(\"表示中に座標を変更しないでください\");\r\n        }\r\n        this.x = x;\r\n        this.y = y;\r\n        this.reload();\r\n    }\r\n\r\n    /**\r\n     * 表示中は変更できない\r\n     * @param kind 種類\r\n     */\r\n    set s$kind(kind: BlockKind) {\r\n        if (this.visible) {\r\n            throw new Error(\"表示中に種類を変更しないでください\");\r\n        }\r\n        this.kind = kind;\r\n        this.reload();\r\n    }\r\n\r\n    /**\r\n     * 表示中は変更できない\r\n     * @param direction mod6して0~5の値として解釈する\r\n     */\r\n    set s$direction(direction: number) {\r\n        if (this.visible) {\r\n            throw new Error(\"表示中に方向を変更しないでください\");\r\n        }\r\n        this.direction = ((direction % 6) + 6) % 6;\r\n        this.reload();\r\n    }\r\n\r\n    /**\r\n     * @param visible 表示状態\r\n     */\r\n    set s$visible(visible: boolean) {\r\n        this.visible = visible;\r\n        this.monoiamonds.forEach((m) => {\r\n            m.s$visible = visible;\r\n        });\r\n    }\r\n\r\n    /**\r\n     * @param index 番号\r\n     * @returns 指定した番号のmonoiamondのx座標\r\n     */\r\n    getPlacementX(index: number): number {\r\n        return this.x + placement[this.kind][this.direction][index][0];\r\n    }\r\n\r\n    /**\r\n     * @param index 番号\r\n     * @returns 指定した番号のmonoiamondのy座標\r\n     */\r\n    getPlacementY(index: number): number {\r\n        return this.y + placement[this.kind][this.direction][index][1];\r\n    }\r\n\r\n    /**\r\n     * 現在のプロパティを各monoiamondにまで反映させる\r\n     */\r\n    private reload(): void {\r\n        if (this.visible) {\r\n            return;\r\n        }\r\n        for (let i = 0; i < this.monoiamonds.length; i++) {\r\n            this.monoiamonds[i].s$x = this.getPlacementX(i);\r\n            this.monoiamonds[i].s$y = this.getPlacementY(i);\r\n            this.monoiamonds[i].s$kind = this.kind;\r\n            this.monoiamonds[i].s$direction = (i + this.direction) % 2 == 0 ? true : false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @returns プレイ領域内に収まっているか\r\n     */\r\n    isOnPlayCanvas(): boolean {\r\n        for (let i = 0; i < this.monoiamonds.length; i++) {\r\n            if (!this.monoiamonds[i].isOnPlayCanvas()) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n}\r\n","import { BlockManager } from \"./BlockManager\";\r\nimport { GraphicData } from \"../CanvasManager\";\r\nimport { EventId, EventManager, MyEventListener } from \"../EventManager\";\r\nimport { MondState } from \"./Monoiamond\";\r\nimport { NextManager } from \"./NextManager\";\r\nimport { Pentiamond } from \"./Pentiamond\";\r\nimport * as Setting from \"../Settings\";\r\nimport { TrickInfo } from \"../Trick\";\r\nimport { BlockKind } from \"./Block\";\r\n\r\nexport class MondOperator implements MyEventListener {\r\n    blockManager: BlockManager = new BlockManager();\r\n    private hand: Pentiamond = new Pentiamond();\r\n    private prevPosition: [number, number] | null = null;\r\n    private prevDirection: number | null = null;\r\n    private next: NextManager = new NextManager();\r\n    private pausing: boolean = true;\r\n    private lastTrick: TrickInfo | null = null;\r\n\r\n    readonly eventClassNames: string[] = [\"move\", \"move-left\", \"move-right\", \"move-down\", \"spin\", \"spin-left\", \"spin-right\", \"put\", \"unput\", \"removeLine\", \"hold\"];\r\n    eventIds: EventId[] = [];\r\n    addEvent(classNames: string[], handler: Function): EventId {\r\n        const eventId = EventManager.addEvent({ classNames: classNames.filter((className) => this.eventClassNames.includes(className)), handler });\r\n        this.eventIds.push(eventId);\r\n        return eventId;\r\n    }\r\n\r\n    constructor() {}\r\n\r\n    get g$graphicData(): GraphicData {\r\n        return {\r\n            blockProperties: this.blockManager.g$blockProperties,\r\n            ghostMondState: this.g$ghostState,\r\n            next: this.next.g$next,\r\n            hold: this.next.g$holdKind,\r\n        };\r\n    }\r\n\r\n    get g$blockManager(): BlockManager {\r\n        return this.blockManager;\r\n    }\r\n\r\n    get g$nextMemory(): BlockKind[] {\r\n        return window.structuredClone(this.next.g$nextMemory);\r\n    }\r\n\r\n    set s$next(next: BlockKind[]) {\r\n        if (!this.next.g$currentKind) {\r\n            this.next.s$next = next;\r\n        }\r\n    }\r\n\r\n    private get g$ghostState(): MondState[] {\r\n        if (!this.hand.g$visible) {\r\n            return [];\r\n        }\r\n        this.blockManager.removePentiamond(this.hand);\r\n        const ghostMond = this.hand.g$copy;\r\n        ghostMond.s$visible = false;\r\n        this.blockManager.displayPentiamond(ghostMond);\r\n        while (this.blockManager.fall(ghostMond));\r\n        this.blockManager.removePentiamond(ghostMond);\r\n        this.blockManager.displayPentiamond(this.hand);\r\n        return ghostMond.g$states;\r\n    }\r\n\r\n    get g$lastTrick(): TrickInfo | null {\r\n        return this.lastTrick;\r\n    }\r\n\r\n    start() {\r\n        if (!this.next.g$currentKind) {\r\n            this.proceed();\r\n        }\r\n        this.pausing = false;\r\n        this.blockManager.displayPentiamond(this.hand);\r\n    }\r\n\r\n    stop() {\r\n        this.pausing = true;\r\n        this.blockManager.removePentiamond(this.hand);\r\n    }\r\n\r\n    private proceed() {\r\n        this.next.proceed();\r\n        this.initializeHand();\r\n        this.blockManager.displayPentiamond(this.hand);\r\n    }\r\n\r\n    private initializeHand() {\r\n        this.hand = new Pentiamond(Setting.initialX, Setting.initialY, this.next.g$currentKind!);\r\n    }\r\n\r\n    move(moveDirection: \"right\" | \"left\" | \"down\"): void {\r\n        if (!this.isOperable()) {\r\n            return;\r\n        }\r\n        if (this.blockManager.move(this.hand, moveDirection)) {\r\n            EventManager.executeListeningEvents(\"move\", this.eventIds);\r\n            EventManager.executeListeningEvents(\"move-\" + moveDirection, this.eventIds);\r\n        }\r\n    }\r\n\r\n    spin(rotate: \"right\" | \"left\"): void {\r\n        if (!this.isOperable()) {\r\n            return;\r\n        }\r\n        if (this.blockManager.spin(this.hand, rotate)) {\r\n            EventManager.executeListeningEvents(\"spin\", this.eventIds);\r\n            EventManager.executeListeningEvents(\"spin-\" + rotate, this.eventIds);\r\n        }\r\n    }\r\n\r\n    hold() {\r\n        if (!this.isOperable()) {\r\n            return;\r\n        }\r\n        this.blockManager.removePentiamond(this.hand);\r\n        this.next.hold();\r\n        this.initializeHand();\r\n        this.blockManager.displayPentiamond(this.hand);\r\n        EventManager.executeListeningEvents(\"hold\", this.eventIds);\r\n    }\r\n\r\n    put() {\r\n        if (!this.isOperable()) {\r\n            return;\r\n        }\r\n        while (this.blockManager.fall(this.hand));\r\n        this.prevPosition = this.hand.g$position;\r\n        this.prevDirection = this.hand.g$direction;\r\n        this.proceed();\r\n        EventManager.executeListeningEvents(\"put\", this.eventIds);\r\n    }\r\n\r\n    unput() {\r\n        if (this.pausing || !this.prevPosition) {\r\n            return;\r\n        }\r\n        this.blockManager.removePentiamond(this.hand);\r\n        this.next.back();\r\n        this.initializeHand();\r\n        this.hand.s$position = this.prevPosition;\r\n        this.hand.s$direction = this.prevDirection!;\r\n        this.hand.s$visible = true;\r\n        this.blockManager.removePentiamond(this.hand);\r\n        this.hand.s$position = [Setting.initialX, Setting.initialY];\r\n        this.hand.s$direction = 0;\r\n        this.blockManager.displayPentiamond(this.hand);\r\n        this.forgetPrev();\r\n        EventManager.executeListeningEvents(\"unput\", this.eventIds);\r\n    }\r\n\r\n    removeLine() {\r\n        if (this.pausing) {\r\n            return;\r\n        }\r\n        this.blockManager.removePentiamond(this.hand);\r\n        this.forgetPrev();\r\n        this.lastTrick = this.blockManager.removeLine();\r\n        this.hand.s$position = [Setting.initialX, Setting.initialY];\r\n        this.hand.s$direction = 0;\r\n        this.blockManager.displayPentiamond(this.hand);\r\n        EventManager.executeListeningEvents(\"removeLine\", this.eventIds);\r\n    }\r\n\r\n    forgetPrev() {\r\n        this.prevPosition = null;\r\n        this.prevDirection = null;\r\n        this.next.forgetPrev();\r\n    }\r\n\r\n    isOperable() {\r\n        return this.hand.g$visible && !this.pausing;\r\n    }\r\n\r\n    isPausing() {\r\n        return this.pausing;\r\n    }\r\n}\r\n","import { BlockManager } from \"../BlockOperate/BlockManager\";\r\nimport { EventId, EventManager, MyEventListener } from \"../EventManager\";\r\nimport { LoopManager } from \"../LoopManager\";\r\nimport { Monoiamond } from \"../BlockOperate/Monoiamond\";\r\nimport * as Setting from \"../Settings\";\r\nimport { gameEvents } from \"./GameMode\";\r\n\r\n/**\r\n * じゃまモンドに関連する処理を行う\r\n */\r\nexport class NuisanceMondManager implements MyEventListener {\r\n    //実際にnuisanceBlockを表示するblockManager\r\n    private blockManager: BlockManager;\r\n    //現在盤面上にあるnuisanceBlockを持つ配列\r\n    private nuisanceMonds: Monoiamond[] = [];\r\n    //前回のdamageによるpenalty\r\n    //どのブロックも破壊しないまま地面に着いたnuisanceBlockの数\r\n    private penalty: number = 0;\r\n    //damage処理中ならtrue\r\n    private damaging: boolean = false;\r\n    //progressを繰り返し実行する用のinterval\r\n    private loop: LoopManager = new LoopManager();\r\n    //damage用に生成するnuisanceBlockの個数\r\n    private task = 0;\r\n    //一回のdamage中のnuisanceBlockの生成の進行度合い\r\n    private taskCount = 0;\r\n    //nuisanceBlockを三回に一回にする用のcount\r\n    private progressCount = 0;\r\n    private spawnCoordinates: number[] = [];\r\n    private spawnCoordinateMemory: number[] = [];\r\n\r\n    /**\r\n     * @param startDamage ダメージ処理開始\r\n     * @param destroyMond モンド破壊\r\n     * @param damageBoard 盤面へのダメージ\r\n     * @param finishDamage ダメージ処理終了\r\n     */\r\n    eventClassNames: string[] = [\"startDamage\", \"progress\", \"destroyMond\", \"damageBoard\", \"finishDamage\"];\r\n    eventIds: EventId[] = [];\r\n    addEvent(classNames: string[], handler: Function): EventId {\r\n        const eventId = EventManager.addEvent({ classNames: classNames.filter((className) => this.eventClassNames.includes(className)), handler });\r\n        this.eventIds.push(eventId);\r\n        return eventId;\r\n    }\r\n\r\n    constructor(blockManager: BlockManager) {\r\n        this.blockManager = blockManager;\r\n        gameEvents.push(\r\n            this.loop.addEvent([\"loop\"], () => {\r\n                this.damageProcess();\r\n            })\r\n        );\r\n    }\r\n\r\n    //damage処理中でないときは前回のdamageによるpenaltyを返す\r\n    //damage処理中のときは-1を返す\r\n    get g$penalty(): number {\r\n        if (this.damaging) {\r\n            return -1;\r\n        }\r\n        return this.penalty;\r\n    }\r\n\r\n    get g$spawnCoordinateMemory(): number[] {\r\n        return this.spawnCoordinateMemory;\r\n    }\r\n\r\n    set s$spawnCoordinates(spawnCoordinates: number[]) {\r\n        this.spawnCoordinates = spawnCoordinates;\r\n    }\r\n\r\n    //damageProgressを呼び出す頻度を取得する\r\n    private get g$progressFrequency(): number {\r\n        const frequency = Math.floor(Setting.damageTime / (Setting.damageGrace * (this.task - 1) + Setting.playHeight));\r\n        if (frequency < 5) {\r\n            return 5;\r\n        } else {\r\n            return frequency;\r\n        }\r\n    }\r\n\r\n    //指定した座標でNuisanceBlockを生成する\r\n    private createNuisanceBlock(x: number, y: number) {\r\n        const nuisanceMond = new Monoiamond(x, y, \"g\", false);\r\n        if (this.blockManager.canDisplayMonoiamond(nuisanceMond)) {\r\n            this.blockManager.displayMonoiamond(nuisanceMond);\r\n            this.nuisanceMonds.push(nuisanceMond);\r\n        } else if (!this.blockManager.getBlockProperty(x, y)[1]) {\r\n            this.blockManager.remove(x, y);\r\n        } else if (0 < x) {\r\n            this.blockManager.remove(x - 1, y);\r\n        } else if (x < Setting.playWidth - 1) {\r\n            this.blockManager.remove(x + 1, y);\r\n        } else {\r\n            this.blockManager.remove(x, y);\r\n        }\r\n        this.spawnCoordinateMemory.push(x);\r\n    }\r\n\r\n    //taskの分だけNuisanceBlockによるdamage処理を行う\r\n    damage(task: number) {\r\n        //すでにdamage処理中のとき、taskを増やす\r\n        if (this.damaging && task > 0) {\r\n            this.task += task;\r\n            this.loop.reset();\r\n            this.loop.s$loopFrequency = this.g$progressFrequency;\r\n            return;\r\n        }\r\n\r\n        this.damaging = true;\r\n        this.penalty = 0;\r\n        this.task = task;\r\n        this.progressCount = 0;\r\n        this.loop.reset();\r\n        this.loop.s$loopFrequency = this.g$progressFrequency;\r\n        EventManager.executeListeningEvents(\"startDamage\", this.eventIds);\r\n    }\r\n\r\n    //NuisanceBlockを進行させて、すでにあるブロックとぶつかった場合は対消滅する\r\n    private progress() {\r\n        let damageBoard = false;\r\n        for (const nuisanceMond of this.nuisanceMonds) {\r\n            damageBoard = false;\r\n\r\n            const visible = (dx: number, dy: number) => {\r\n                return this.blockManager.getBlockProperty(nuisanceMond.g$x + dx, nuisanceMond.g$y + dy)[2];\r\n            };\r\n\r\n            const direction = (dx: number, dy: number) => {\r\n                return this.blockManager.getBlockProperty(nuisanceMond.g$x + dx, nuisanceMond.g$y + dy)[1];\r\n            };\r\n            const remove = (dx: number, dy: number) => {\r\n                if (dx != 0 || dy != 0) {\r\n                    this.blockManager.remove(nuisanceMond.g$x + dx, nuisanceMond.g$y + dy);\r\n                }\r\n                this.blockManager.removeMonoiamond(nuisanceMond);\r\n            };\r\n\r\n            const isGrounded = () => {\r\n                return nuisanceMond.g$y == Setting.playHeight - 1;\r\n            };\r\n\r\n            //左端でも右端でもないとき\r\n            if (0 < nuisanceMond.g$x && nuisanceMond.g$x < Setting.playWidth - 1) {\r\n                //左隣が存在するとき\r\n                if (visible(-1, 0)) {\r\n                    remove(-1, 0);\r\n                    //右隣が存在するとき\r\n                } else if (visible(1, 0)) {\r\n                    remove(1, 0);\r\n                    //一番下に着いたとき\r\n                    //このときは対消滅するブロックがないため、代わりにpenaltyを受ける\r\n                } else if (isGrounded()) {\r\n                    damageBoard = true;\r\n                    remove(0, 0);\r\n                    //真下が下向きで存在するとき\r\n                } else if (visible(0, 1) && !direction(0, 1)) {\r\n                    remove(0, 1);\r\n                    //左下が下向きで存在するとき\r\n                } else if (visible(-1, 1) && !direction(-1, 1)) {\r\n                    remove(-1, 1);\r\n                    //右下が下向きで存在するとき\r\n                } else if (visible(1, 1) && !direction(1, 1)) {\r\n                    remove(1, 1);\r\n                    //真下が上向きで存在するとき\r\n                } else if (visible(0, 1)) {\r\n                    remove(0, 1);\r\n                }\r\n                //左端ではないとき\r\n            } else if (0 < nuisanceMond.g$x) {\r\n                //左隣が存在するとき\r\n                if (visible(-1, 0)) {\r\n                    remove(-1, 0);\r\n                    //一番下に着いたとき\r\n                    //このときは対消滅するブロックがないため、代わりにpenaltyを受ける\r\n                } else if (isGrounded()) {\r\n                    damageBoard = true;\r\n                    remove(0, 0);\r\n                    //真下が下向きで存在するとき\r\n                } else if (visible(0, 1) && !direction(0, 1)) {\r\n                    remove(0, 1);\r\n                    //左下が下向きで存在するとき\r\n                } else if (visible(-1, 1) && !direction(-1, 1)) {\r\n                    remove(-1, 1);\r\n                    //真下が上向きで存在するとき\r\n                } else if (visible(0, 1)) {\r\n                    remove(0, 1);\r\n                }\r\n                //右端ではないとき\r\n            } else if (nuisanceMond.g$x < Setting.playWidth - 1) {\r\n                //右隣が存在するとき\r\n                if (visible(1, 0)) {\r\n                    remove(1, 0);\r\n                    //一番下に着いたとき\r\n                    //このときは対消滅するブロックがないため、代わりにpenaltyを受ける\r\n                } else if (isGrounded()) {\r\n                    damageBoard = true;\r\n                    remove(0, 0);\r\n                    //真下が下向きで存在するとき\r\n                } else if (visible(0, 1) && !direction(0, 1)) {\r\n                    remove(0, 1);\r\n                    //右下が下向きで存在するとき\r\n                } else if (visible(1, 1) && !direction(1, 1)) {\r\n                    remove(1, 1);\r\n                    //真下が上向きで存在するとき\r\n                } else if (visible(0, 1)) {\r\n                    remove(0, 1);\r\n                }\r\n                //右端かつ左端のとき\r\n            } else {\r\n                //一番下に着いたとき\r\n                if (isGrounded()) {\r\n                    damageBoard = true;\r\n                    remove(0, 0);\r\n                    //真下が存在するとき\r\n                } else if (visible(0, 1)) {\r\n                    remove(0, 1);\r\n                }\r\n            }\r\n\r\n            //上記の条件に一つも引っかからなかったとき\r\n            if (nuisanceMond.g$visible) {\r\n                this.blockManager.removeMonoiamond(nuisanceMond);\r\n                nuisanceMond.s$y = nuisanceMond.g$y + 1;\r\n                this.blockManager.displayMonoiamond(nuisanceMond);\r\n            } else {\r\n                if (damageBoard) {\r\n                    EventManager.executeListeningEvents(\"damageBoard\", this.eventIds);\r\n                    this.penalty++;\r\n                } else {\r\n                    EventManager.executeListeningEvents(\"destroyMond\", this.eventIds);\r\n                }\r\n            }\r\n        }\r\n\r\n        //対消滅したnuisanceBlockをリストから削除する\r\n        this.nuisanceMonds = this.nuisanceMonds.filter((nuisanceMond) => nuisanceMond.g$visible);\r\n        EventManager.executeListeningEvents(\"progress\", this.eventIds);\r\n    }\r\n\r\n    //progressFrequencyの頻度でNuisanceBlockを進行させつつ、三回に一回の割合で、taskの分だけNuisanceBlockを生成する\r\n    private damageProcess() {\r\n        if (this.progressCount == 0) {\r\n            //指定されたtaskの量の生成が完了していないとき\r\n            if (this.taskCount < this.task) {\r\n                this.progress();\r\n                const x = this.spawnCoordinates.length ? this.spawnCoordinates.shift()! : Math.floor(Math.random() * Setting.playWidth);\r\n                this.createNuisanceBlock(x, 0);\r\n                this.progressCount++;\r\n                this.taskCount++;\r\n                //すでにtaskの量の生成を完了していて、盤面に残っているnuisanceBlockが存在しないとき\r\n            } else if (this.nuisanceMonds.length == 0) {\r\n                this.finishDamage();\r\n                //すでにtaskの量の生成を完了しているが盤面にnuisanceBlockが残っているとき\r\n            } else {\r\n                this.progress();\r\n            }\r\n        } else {\r\n            //盤面に残っているnuisanceBlockが存在しないとき\r\n            if (this.nuisanceMonds.length == 0) {\r\n                this.progressCount = 0;\r\n                //盤面にnuisanceBlockが残っているとき\r\n            } else {\r\n                this.progress();\r\n                this.progressCount++;\r\n            }\r\n\r\n            if (this.progressCount == Setting.damageGrace) {\r\n                this.progressCount = 0;\r\n            }\r\n        }\r\n    }\r\n\r\n    //damage処理を終了させる\r\n    private finishDamage() {\r\n        this.loop.reset();\r\n        this.task = 0;\r\n        this.progressCount = 0;\r\n        this.taskCount = 0;\r\n        EventManager.executeListeningEvents(\"finishDamage\", this.eventIds);\r\n        this.damaging = false;\r\n    }\r\n\r\n    //damage処理を中止する\r\n    cancelDamage(): void {\r\n        this.loop.reset();\r\n        for (const nuisanceMond of this.nuisanceMonds) {\r\n            this.blockManager.removeMonoiamond(nuisanceMond);\r\n        }\r\n        this.task = 0;\r\n        this.progressCount = 0;\r\n        this.taskCount = 0;\r\n        this.damaging = false;\r\n    }\r\n\r\n    /**\r\n     * damage処理を一時中断する\r\n     */\r\n    stop(): void {\r\n        if (!this.damaging) {\r\n            return;\r\n        }\r\n        this.loop.stop();\r\n    }\r\n\r\n    /**\r\n     * 一時中断していたdamage処理を再開する\r\n     */\r\n    start(): void {\r\n        if (!this.damaging) {\r\n            return;\r\n        }\r\n        this.loop.start();\r\n    }\r\n}\r\n","import { BlockKind, BlockProperty } from \"./BlockOperate/Block\";\r\nimport { MondState } from \"./BlockOperate/Monoiamond\";\r\nimport { Pentiamond } from \"./BlockOperate/Pentiamond\";\r\nimport * as Setting from \"./Settings\";\r\nimport { arrayPlus } from \"./Utils\";\r\n\r\nexport type GraphicData = {\r\n    blockProperties: BlockProperty[][] | null;\r\n    ghostMondState: MondState[];\r\n    next: BlockKind[];\r\n    hold: BlockKind | null;\r\n};\r\n\r\nexport class CanvasManager {\r\n    private playCanvas: HTMLCanvasElement = document.createElement(\"canvas\");\r\n    private pct: CanvasRenderingContext2D;\r\n    private nextCanvas: HTMLCanvasElement = document.createElement(\"canvas\");\r\n    private nct: CanvasRenderingContext2D;\r\n    private data: GraphicData = {\r\n        blockProperties: null,\r\n        ghostMondState: [],\r\n        next: [],\r\n        hold: null,\r\n    };\r\n    guideBorder: boolean = false;\r\n    guideBorderHeight: number = 15;\r\n    constructor() {\r\n        this.playCanvas.classList.add(\"playCanvas\");\r\n        this.pct = this.playCanvas.getContext(\"2d\")!;\r\n        this.playCanvas.height = Setting.blockHeight * (Setting.height + Setting.displayMargin);\r\n        this.playCanvas.width = Setting.blockWidth * Setting.width;\r\n        this.playCanvas.style.aspectRatio = this.playCanvas.width / this.playCanvas.height + \"\";\r\n        this.nextCanvas.classList.add(\"nextCanvas\");\r\n        this.nct = this.nextCanvas.getContext(\"2d\")!;\r\n        this.nextCanvas.height = Setting.blockHeight * Setting.next.height * (Setting.next.scale.hold + Setting.next.scale.normal * Setting.next.length) + Setting.next.gap;\r\n        this.nextCanvas.width = Setting.blockWidth * Setting.next.width * Math.max(Setting.next.scale.hold, Setting.next.scale.normal);\r\n        this.nextCanvas.style.aspectRatio = this.nextCanvas.width / this.nextCanvas.height + \"\";\r\n    }\r\n\r\n    get g$playCanvas() {\r\n        return this.playCanvas;\r\n    }\r\n\r\n    get g$nextCanvas() {\r\n        return this.nextCanvas;\r\n    }\r\n\r\n    readData(data: GraphicData) {\r\n        this.data = data;\r\n    }\r\n\r\n    paint() {\r\n        this.paintPlayCanvas();\r\n        this.paintNextCanvas();\r\n    }\r\n\r\n    paintPlayCanvas() {\r\n        this.pct.clearRect(0, 0, this.playCanvas.width, this.playCanvas.height);\r\n        this.paintBackground();\r\n        if (this.guideBorder) {\r\n            this.paintGuideBorder();\r\n        }\r\n        this.paintGrid();\r\n        this.paintGhost();\r\n        this.paintBlocks();\r\n    }\r\n\r\n    private paintGhost() {\r\n        if (this.data.ghostMondState.length == 0) {\r\n            return;\r\n        }\r\n        this.data.ghostMondState.forEach((state) => {\r\n            this.paintBlock(state[0], state[1], [state[2], state[3], true], true);\r\n        });\r\n    }\r\n\r\n    private paintBlocks() {\r\n        if (!this.data.blockProperties) {\r\n            return;\r\n        }\r\n        for (let x = 0; x < Setting.playWidth; x++) {\r\n            for (let y = 0; y < Setting.playHeight; y++) {\r\n                this.paintBlock(x, y, this.data.blockProperties[x][y]);\r\n            }\r\n        }\r\n    }\r\n\r\n    private paintBlock(x: number, y: number, property: BlockProperty, isGhost = false) {\r\n        if (!property[2]) {\r\n            return;\r\n        }\r\n\r\n        if (isGhost) {\r\n            this.pct.strokeStyle = Setting.mondGrid.ghost.color;\r\n            this.pct.fillStyle = Setting.blockColor.ghost[property[0]];\r\n            this.pct.lineWidth = Setting.mondGrid.ghost.width;\r\n        } else {\r\n            this.pct.strokeStyle = Setting.mondGrid.normal.color;\r\n            this.pct.fillStyle = Setting.blockColor.normal[property[0]];\r\n            this.pct.lineWidth = Setting.mondGrid.normal.width;\r\n        }\r\n        this.pct.lineJoin = \"bevel\";\r\n        this.pct.lineCap = \"round\";\r\n        const position = this.getGraphicPosition(x, y);\r\n        const p1 = arrayPlus([0, property[1] ? Setting.blockHeight : 0], position);\r\n        const p2 = arrayPlus([Setting.blockWidth / 2, property[1] ? 0 : Setting.blockHeight], position);\r\n        const p3 = arrayPlus([Setting.blockWidth, property[1] ? Setting.blockHeight : 0], position);\r\n        this.pct.beginPath();\r\n        this.pct.moveTo(p1[0], p1[1]);\r\n        this.pct.lineTo(p2[0], p2[1]);\r\n        this.pct.lineTo(p3[0], p3[1]);\r\n        this.pct.closePath();\r\n        this.pct.fill();\r\n        this.pct.stroke();\r\n    }\r\n\r\n    private paintBackground() {\r\n        this.pct.fillStyle = Setting.backgroundColor;\r\n        this.pct.fillRect(0, 0, this.playCanvas.width, this.playCanvas.height);\r\n    }\r\n\r\n    private paintGuideBorder() {\r\n        this.pct.fillStyle = Setting.guideBorderColor;\r\n        this.pct.fillRect(0, Setting.blockHeight * (Setting.height + Setting.displayMargin - this.guideBorderHeight), this.playCanvas.width, Setting.blockHeight);\r\n    }\r\n\r\n    private paintGrid() {\r\n        this.pct.strokeStyle = Setting.canvasGrid.color;\r\n        this.pct.lineWidth = Setting.canvasGrid.width;\r\n        for (let x = 0; x <= Setting.width; x++) {\r\n            this.pct.beginPath();\r\n            this.pct.moveTo(x * Setting.blockWidth, 0);\r\n            this.pct.lineTo(x * Setting.blockWidth, this.playCanvas.height);\r\n            this.pct.stroke();\r\n        }\r\n    }\r\n\r\n    private getGraphicPosition(x: number, y: number) {\r\n        return [Setting.blockWidth * (x / 2), this.playCanvas.height - Setting.blockHeight * (Setting.playHeight - y)];\r\n    }\r\n\r\n    private getNextGraphicPosition(x: number, y: number, isHold: boolean = false) {\r\n        return [\r\n            Setting.blockWidth * (x / 2) * (isHold ? Setting.next.scale.hold : Setting.next.scale.normal),\r\n            isHold\r\n                ? Setting.blockHeight * Setting.next.scale.hold * y\r\n                : Setting.blockHeight * Setting.next.scale.hold * Setting.next.height + Setting.next.gap + Setting.blockHeight * Setting.next.scale.normal * (y - Setting.next.height),\r\n        ];\r\n    }\r\n\r\n    paintNextCanvas() {\r\n        this.nct.clearRect(0, 0, this.nextCanvas.width, this.nextCanvas.height);\r\n        this.paintNextBackground();\r\n        this.paintNext();\r\n    }\r\n\r\n    private paintNextBackground() {\r\n        this.nct.fillStyle = Setting.backgroundColor;\r\n        this.nct.fillRect(0, 0, Setting.blockWidth * Setting.next.width * Setting.next.scale.hold, Setting.blockHeight * Setting.next.height * Setting.next.scale.hold + Setting.next.gap / 4);\r\n        this.nct.fillRect(\r\n            0,\r\n            Setting.blockHeight * Setting.next.height * Setting.next.scale.hold + (Setting.next.gap * 3) / 4,\r\n            Setting.blockWidth * Setting.next.width * Setting.next.scale.normal,\r\n            Setting.blockHeight * Setting.next.height * Setting.next.length + Setting.next.gap / 4\r\n        );\r\n        this.nct.fillStyle = Setting.next.splitColor;\r\n        this.nct.fillRect(0, Setting.blockHeight * Setting.next.height * Setting.next.scale.hold + Setting.next.gap / 4, this.nextCanvas.width, Setting.next.gap / 2);\r\n    }\r\n\r\n    private paintNext() {\r\n        const correction = Setting.next.height / 2 - Math.floor(Setting.next.height / 2);\r\n        if (this.data.hold) {\r\n            const hold = new Pentiamond(Setting.next.width - 1, Math.floor((Setting.next.height - 1) / 2), this.data.hold);\r\n            const holdStates = hold.g$states;\r\n            holdStates.forEach((state) => {\r\n                this.paintNextBlock(state[0], state[1] + correction, [state[2], state[3], true], true);\r\n            });\r\n        }\r\n        for (let i = 0; i < Math.min(Setting.next.length, this.data.next.length); i++) {\r\n            const next = new Pentiamond(Setting.next.width - 1, Math.floor(Setting.next.height / 2) + Setting.next.height * (i + 1), this.data.next[i]);\r\n            const nextStates = next.g$states;\r\n            nextStates.forEach((state) => {\r\n                this.paintNextBlock(state[0], state[1] + correction, [state[2], state[3], true]);\r\n            });\r\n        }\r\n    }\r\n\r\n    private paintNextBlock(x: number, y: number, property: BlockProperty, isHold: boolean = false) {\r\n        if (!property[2]) {\r\n            return;\r\n        }\r\n        this.nct.strokeStyle = Setting.mondGrid.normal.color;\r\n        this.nct.fillStyle = Setting.blockColor.normal[property[0]];\r\n        this.nct.lineWidth = Setting.mondGrid.normal.width;\r\n        this.nct.lineJoin = \"bevel\";\r\n        this.nct.lineCap = \"round\";\r\n        const scale = isHold ? Setting.next.scale.hold : Setting.next.scale.normal;\r\n        const position = this.getNextGraphicPosition(x, y, isHold);\r\n        const p1 = arrayPlus([0, property[1] ? Setting.blockHeight * scale : 0], position);\r\n        const p2 = arrayPlus([(Setting.blockWidth * scale) / 2, property[1] ? 0 : Setting.blockHeight * scale], position);\r\n        const p3 = arrayPlus([Setting.blockWidth * scale, property[1] ? Setting.blockHeight * scale : 0], position);\r\n        this.nct.beginPath();\r\n        this.nct.moveTo(p1[0], p1[1]);\r\n        this.nct.lineTo(p2[0], p2[1]);\r\n        this.nct.lineTo(p3[0], p3[1]);\r\n        this.nct.closePath();\r\n        this.nct.fill();\r\n        this.nct.stroke();\r\n    }\r\n}\r\n","import { inputManager } from \"../Interaction/InputManager\";\r\nimport { qsAll } from \"../Utils\";\r\n\r\ntype InformationLabel = {\r\n    name: string;\r\n    label: HTMLDivElement;\r\n    content: string;\r\n    visible: boolean;\r\n};\r\n\r\nexport class InformationLabelManager {\r\n    private labels = {\r\n        gameTime: {\r\n            name: \"Time\",\r\n            label: document.createElement(\"div\"),\r\n            content: \"\",\r\n            visible: false,\r\n        },\r\n        playTime: {\r\n            name: \"Time\",\r\n            label: document.createElement(\"div\"),\r\n            content: \"\",\r\n            visible: false,\r\n        },\r\n        line: {\r\n            name: \"Line\",\r\n            label: document.createElement(\"div\"),\r\n            content: \"\",\r\n            visible: false,\r\n        },\r\n        lastTrick: {\r\n            name: \"Trick\",\r\n            label: document.createElement(\"div\"),\r\n            content: \"\",\r\n            visible: false,\r\n        },\r\n        chain: {\r\n            name: \"Chain\",\r\n            label: document.createElement(\"div\"),\r\n            content: \"\",\r\n            visible: false,\r\n        },\r\n        score: {\r\n            name: \"Score\",\r\n            label: document.createElement(\"div\"),\r\n            content: \"\",\r\n            visible: false,\r\n        },\r\n    };\r\n\r\n    private base: HTMLDivElement = document.createElement(\"div\");\r\n    constructor(\r\n        {\r\n            gameTime,\r\n            playTime,\r\n            line = false,\r\n            lastTrick,\r\n            chain,\r\n            score,\r\n        }: {\r\n            gameTime: boolean;\r\n            playTime: boolean;\r\n            line: boolean;\r\n            lastTrick: boolean;\r\n            chain: boolean;\r\n            score: boolean;\r\n        } = {\r\n            gameTime: false,\r\n            playTime: false,\r\n            line: false,\r\n            lastTrick: false,\r\n            chain: false,\r\n            score: false,\r\n        }\r\n    ) {\r\n        this.s$visible = { gameTime, playTime, line, lastTrick, chain, score };\r\n        Object.values(this.labels).forEach((element) => {\r\n            element.label.classList.add(\"informationLabel\");\r\n            this.base.appendChild(element.label);\r\n            if (element.name == \"Trick\") {\r\n                if (inputManager.g$registeredInputNumber == 1) {\r\n                    element.label.style.fontSize = \"3vh\";\r\n                } else {\r\n                    element.label.style.fontSize = `calc((100vh * 14 / 9 / ${inputManager.g$registeredInputNumber}) /33)`;\r\n                }\r\n            } else if (element.name == \"Score\") {\r\n                if (inputManager.g$registeredInputNumber == 1) {\r\n                    element.label.style.fontSize = \"4vh\";\r\n                } else {\r\n                    element.label.style.fontSize = `calc((100vh * 14 / 9 / ${inputManager.g$registeredInputNumber}) /28)`;\r\n                }\r\n            } else {\r\n                if (inputManager.g$registeredInputNumber == 1) {\r\n                    element.label.style.fontSize = \"6vh\";\r\n                } else {\r\n                    element.label.style.fontSize = `calc((100vh * 14 / 9 / ${inputManager.g$registeredInputNumber}) /17)`;\r\n                }\r\n            }\r\n        });\r\n        if (inputManager.g$registeredInputNumber == 1) {\r\n            this.labels.playTime.label.style.fontSize = \"4vh\";\r\n        } else {\r\n            this.labels.playTime.label.style.fontSize = `calc((100vh * 14 / 9 / ${inputManager.g$registeredInputNumber}) /28)`;\r\n        }\r\n\r\n        this.base.classList.add(\"informationLabelBase\");\r\n        // this.labels.lastTrick.label.style.fontSize = \"3vh\";\r\n    }\r\n    get g$element() {\r\n        return this.base;\r\n    }\r\n\r\n    set s$visible({ gameTime, playTime, line, lastTrick, chain, score }: { gameTime: boolean; playTime: boolean; line: boolean; lastTrick: boolean; chain: boolean; score: boolean }) {\r\n        [this.labels.gameTime.visible, this.labels.playTime.visible, this.labels.line.visible, this.labels.lastTrick.visible, this.labels.chain.visible, this.labels.score.visible] = [\r\n            gameTime,\r\n            playTime,\r\n            line,\r\n            lastTrick,\r\n            chain,\r\n            score,\r\n        ];\r\n        this.labels.gameTime.label.style.display = gameTime ? \"\" : \"none\";\r\n        this.labels.playTime.label.style.display = playTime ? \"\" : \"none\";\r\n        this.labels.line.label.style.display = line ? \"\" : \"none\";\r\n        this.labels.lastTrick.label.style.display = lastTrick ? \"\" : \"none\";\r\n        this.labels.chain.label.style.display = chain ? \"\" : \"none\";\r\n        this.labels.score.label.style.display = score ? \"\" : \"none\";\r\n    }\r\n\r\n    updateContents({ gameTime, playTime, line, lastTrick, chain, score }: { gameTime?: string; playTime?: string; line?: string; lastTrick?: string; chain?: string; score?: string }) {\r\n        if (gameTime != undefined && this.labels.gameTime.visible && this.labels.gameTime.content != gameTime) {\r\n            this.labels.gameTime.content = gameTime;\r\n            this.labels.gameTime.label.innerHTML = `<div class=\"informationLabelHeader\">${this.labels.gameTime.name}</div>` + gameTime;\r\n        }\r\n        if (playTime != undefined && this.labels.playTime.visible && this.labels.playTime.content != playTime) {\r\n            this.labels.playTime.content = playTime;\r\n            this.labels.playTime.label.innerHTML = `<div class=\"informationLabelHeader\">${this.labels.playTime.name}</div>` + playTime;\r\n        }\r\n        if (line != undefined && this.labels.line.visible && this.labels.line.content != line) {\r\n            this.labels.line.content = line;\r\n            this.labels.line.label.innerHTML = `<div class=\"informationLabelHeader\">${this.labels.line.name}</div>` + line;\r\n        }\r\n        if (lastTrick != undefined && this.labels.lastTrick.visible && this.labels.lastTrick.content != lastTrick) {\r\n            this.labels.lastTrick.content = lastTrick;\r\n            this.labels.lastTrick.label.innerHTML = `<div class=\"informationLabelHeader\">${this.labels.lastTrick.name}</div>` + lastTrick;\r\n        }\r\n        if (chain != undefined && this.labels.chain.visible && this.labels.chain.content != chain) {\r\n            this.labels.chain.content = chain;\r\n            this.labels.chain.label.innerHTML = `<div class=\"informationLabelHeader\">${this.labels.chain.name}</div>` + chain;\r\n        }\r\n        if (score != undefined && this.labels.score.visible && this.labels.score.content != score) {\r\n            this.labels.score.content = score;\r\n            this.labels.score.label.innerHTML = `<div class=\"informationLabelHeader\">${this.labels.score.name}</div>` + score;\r\n        }\r\n        qsAll(\".informationLabelHeader\").forEach((element) => {\r\n            if (inputManager.g$registeredInputNumber == 1) {\r\n                element.style.fontSize = \"4vh\";\r\n            } else {\r\n                element.style.fontSize = `calc((100vh * 14 / 9 / ${inputManager.g$registeredInputNumber}) /22)`;\r\n            }\r\n        });\r\n    }\r\n}\r\n","import { LoopManager } from \"../LoopManager\";\r\nimport { MondOperator } from \"../BlockOperate/MondOperator\";\r\nimport { NuisanceMondManager } from \"./NuisanceMondManager\";\r\nimport { Input } from \"../Interaction/Input\";\r\nimport { CanvasManager } from \"../CanvasManager\";\r\nimport { InformationLabelManager } from \"./InformationLabelManager\";\r\nimport { TrickInfo } from \"../Trick\";\r\nimport * as Setting from \"../Settings\";\r\nimport { gameEvents } from \"./GameMode\";\r\nimport { inputManager } from \"../Interaction/InputManager\";\r\nimport { graphicSetting } from \"../Run\";\r\n\r\nexport class GamePlayer {\r\n    operator: MondOperator = new MondOperator();\r\n    loop: LoopManager = new LoopManager();\r\n    nuisanceMondManager: NuisanceMondManager;\r\n    canvas: CanvasManager = new CanvasManager();\r\n    label: InformationLabelManager = new InformationLabelManager();\r\n    input: Input;\r\n    playField: HTMLDivElement = document.createElement(\"div\");\r\n    playInfo = {\r\n        maxGameTime: 300,\r\n        gameTime: 300,\r\n        playTime: 0,\r\n        line: 0,\r\n        lastTrick: null as TrickInfo | null,\r\n        trickCount: 0,\r\n        chain: 0,\r\n        maxChain: 0,\r\n        score: 0,\r\n        penalty: 0,\r\n        penaltyTask: 0,\r\n        recovery: 0,\r\n        surplus: 0,\r\n        put: 0,\r\n        hold: 0,\r\n        unput: 0,\r\n        remove: 0,\r\n        handy: 1,\r\n    };\r\n    state = {\r\n        hasFinished: false,\r\n        damaging: false,\r\n    };\r\n    damageInfo = {\r\n        damageTask: 0,\r\n        temporaryDamageTask: 0,\r\n        attackTask: 0,\r\n        lastDamageTime: 0,\r\n        totalDamage: 0,\r\n        totalAttack: 0,\r\n    };\r\n    animations = {\r\n        put: this.playField.animate(\r\n            [\r\n                {\r\n                    transform: \"translate(0, 0.3vh)\",\r\n                },\r\n                {\r\n                    transform: \"\",\r\n                },\r\n            ],\r\n            {\r\n                duration: 100,\r\n                direction: \"normal\",\r\n                iterations: 1,\r\n                easing: \"ease-out\",\r\n            }\r\n        ),\r\n        removeLineWithTrick: this.playField.animate(\r\n            [\r\n                {\r\n                    rotate: \"0deg\",\r\n                },\r\n                {\r\n                    rotate: \"-0.5deg\",\r\n                },\r\n                {\r\n                    rotate: \"0.5deg\",\r\n                    scale: 1.02,\r\n                },\r\n                {\r\n                    rotate: \"0deg\",\r\n                },\r\n            ],\r\n            {\r\n                duration: 100,\r\n                direction: \"normal\",\r\n                iterations: 1,\r\n            }\r\n        ),\r\n        removeLineWithoutTrick: this.playField.animate(\r\n            [\r\n                {\r\n                    rotate: \"0deg\",\r\n                },\r\n                {\r\n                    rotate: \"-0.5deg\",\r\n                },\r\n                {\r\n                    rotate: \"0.5deg\",\r\n                },\r\n                {\r\n                    rotate: \"0deg\",\r\n                },\r\n            ],\r\n            {\r\n                duration: 70,\r\n                direction: \"normal\",\r\n                iterations: 1,\r\n            }\r\n        ),\r\n\r\n        caution: this.playField.animate(\r\n            [\r\n                {\r\n                    backgroundColor: \"\",\r\n                },\r\n                {\r\n                    backgroundColor: \"#eeee99\",\r\n                },\r\n                {\r\n                    backgroundColor: \"#eeee99\",\r\n                },\r\n                {\r\n                    backgroundColor: \"\",\r\n                },\r\n            ],\r\n            {\r\n                duration: 1000,\r\n                direction: \"normal\",\r\n                iterations: Infinity,\r\n            }\r\n        ),\r\n        warning: this.playField.animate(\r\n            [\r\n                {\r\n                    backgroundColor: \"\",\r\n                },\r\n                {\r\n                    backgroundColor: \"#ee9999\",\r\n                },\r\n                {\r\n                    backgroundColor: \"#ee9999\",\r\n                },\r\n                {\r\n                    backgroundColor: \"\",\r\n                },\r\n            ],\r\n            {\r\n                duration: 1000,\r\n                direction: \"normal\",\r\n                iterations: Infinity,\r\n            }\r\n        ),\r\n        damageBoard: this.playField.animate(\r\n            [\r\n                {\r\n                    transform: \"translate(0, 1.4vh)\",\r\n                },\r\n                {\r\n                    transform: \"\",\r\n                },\r\n            ],\r\n            {\r\n                duration: 10,\r\n                direction: \"normal\",\r\n                iterations: 1,\r\n            }\r\n        ),\r\n        timeWarning: this.playField.animate(\r\n            [\r\n                {\r\n                    transform: \"\",\r\n                    rotate: \"0deg\",\r\n                },\r\n                {\r\n                    transform: \"translate(-0.1vh, 0)\",\r\n                    rotate: \"-0.3deg\",\r\n                },\r\n                {\r\n                    transform: \"translate(0.1vh, 0)\",\r\n                    rotate: \"0.3deg\",\r\n                },\r\n                {\r\n                    rotate: \"0deg\",\r\n                },\r\n            ],\r\n            {\r\n                duration: 200,\r\n                direction: \"normal\",\r\n                iterations: Infinity,\r\n            }\r\n        ),\r\n        finish: this.playField.animate(\r\n            [\r\n                {\r\n                    opacity: 1,\r\n                    rotate: \"0deg\",\r\n                    scale: 1,\r\n                },\r\n                {\r\n                    opacity: 0,\r\n                    rotate: \"720deg\",\r\n                    scale: 0,\r\n                },\r\n            ],\r\n            {\r\n                duration: 1000,\r\n                direction: \"normal\",\r\n                fill: \"forwards\",\r\n                iterations: 1,\r\n            }\r\n        ),\r\n    };\r\n    runningAnimations: Animation[] = [];\r\n\r\n    constructor(input: Input) {\r\n        this.nuisanceMondManager = new NuisanceMondManager(this.operator.blockManager);\r\n\r\n        gameEvents.push(\r\n            this.nuisanceMondManager.addEvent([\"finishDamage\"], () => {\r\n                this.state.damaging = false;\r\n                this.damageInfo.damageTask = 0;\r\n                this.operator.forgetPrev();\r\n                this.animations.caution.cancel();\r\n                this.animations.warning.cancel();\r\n                this.proceedTemporaryDamageTask();\r\n                if (this.loop.g$isLooping) {\r\n                    this.operator.start();\r\n                }\r\n                this.updateCanvas();\r\n            }),\r\n            this.nuisanceMondManager.addEvent([\"damageBoard\"], () => {\r\n                this.playInfo.penalty += 1;\r\n                this.animations.damageBoard.play();\r\n            }),\r\n            this.nuisanceMondManager.addEvent([\"progress\"], () => {\r\n                this.canvas.readData(this.operator.g$graphicData);\r\n                this.canvas.paintPlayCanvas();\r\n            }),\r\n            this.operator.addEvent([\"put\"], () => {\r\n                if (graphicSetting.putShake) {\r\n                    this.animations.put.play();\r\n                }\r\n            })\r\n        );\r\n        this.input = input;\r\n        this.playField.classList.add(\"playField\");\r\n        this.playField.appendChild(this.canvas.g$playCanvas);\r\n        this.playField.appendChild(this.canvas.g$nextCanvas);\r\n        this.playField.appendChild(this.label.g$element);\r\n        this.canvas.paint();\r\n        Object.values(this.animations).forEach((animation) => {\r\n            animation.cancel();\r\n        });\r\n    }\r\n\r\n    get g$element(): HTMLDivElement {\r\n        return this.playField;\r\n    }\r\n\r\n    get g$playTimeString() {\r\n        return (this.loop.g$elapsedTime / 1000).toFixed(2);\r\n    }\r\n\r\n    start() {\r\n        if (this.state.hasFinished) {\r\n            return;\r\n        }\r\n        this.loop.start();\r\n        if (!this.state.damaging) {\r\n            this.operator.start();\r\n        }\r\n        this.nuisanceMondManager.start();\r\n        this.updateCanvas();\r\n        this.runningAnimations.forEach((animation) => {\r\n            animation.play();\r\n        });\r\n        if (this.input.g$type == \"autoKeyboard\") {\r\n            this.input.g$manager.start();\r\n        }\r\n    }\r\n\r\n    stop() {\r\n        this.loop.stop();\r\n        this.operator.stop();\r\n        this.nuisanceMondManager.stop();\r\n        this.runningAnimations = Object.values(this.animations).filter((animation) => {\r\n            animation.playState == \"running\";\r\n        });\r\n        this.runningAnimations.forEach((animation) => {\r\n            animation.pause();\r\n        });\r\n        if (this.input.g$type == \"autoKeyboard\") {\r\n            this.input.g$manager.stop();\r\n        }\r\n    }\r\n\r\n    finish() {\r\n        this.stop();\r\n        this.updateGameTime();\r\n        this.state.hasFinished = true;\r\n        this.animations.timeWarning.cancel();\r\n    }\r\n\r\n    addDamageTask(damageTask: number) {\r\n        if (this.state.hasFinished || damageTask == 0) {\r\n            return;\r\n        }\r\n        if (this.damageInfo.damageTask != 0 && !this.state.damaging) {\r\n            this.damageInfo.damageTask += damageTask;\r\n            return;\r\n        }\r\n        if (this.state.damaging) {\r\n            this.damageInfo.temporaryDamageTask += damageTask;\r\n            return;\r\n        }\r\n        this.damageInfo.lastDamageTime = this.loop.g$elapsedTime;\r\n        this.damageInfo.damageTask += damageTask;\r\n        this.animations.caution.play();\r\n    }\r\n\r\n    private proceedTemporaryDamageTask() {\r\n        if (this.state.damaging || this.state.hasFinished) {\r\n            return;\r\n        }\r\n        if (this.damageInfo.temporaryDamageTask > 0) {\r\n            this.damageInfo.damageTask += this.damageInfo.temporaryDamageTask;\r\n            this.damageInfo.temporaryDamageTask = 0;\r\n            this.damageInfo.lastDamageTime = this.loop.g$elapsedTime;\r\n            this.animations.caution.play();\r\n        }\r\n    }\r\n\r\n    damage() {\r\n        if (this.state.damaging || this.damageInfo.damageTask == 0 || this.state.hasFinished) {\r\n            return;\r\n        }\r\n        this.state.damaging = true;\r\n        this.operator.stop();\r\n        this.nuisanceMondManager.damage(this.damageInfo.damageTask);\r\n        this.nuisanceMondManager.start();\r\n    }\r\n\r\n    updateGameTime() {\r\n        if (this.state.hasFinished) {\r\n            return;\r\n        }\r\n        this.playInfo.gameTime = Math.max(\r\n            Math.ceil(this.playInfo.maxGameTime - this.loop.g$elapsedTime / Setting.gameTimeRate) - this.playInfo.penalty + this.playInfo.recovery - this.playInfo.surplus,\r\n            0\r\n        );\r\n        if (this.playInfo.gameTime > this.playInfo.maxGameTime) {\r\n            this.playInfo.surplus += this.playInfo.gameTime - this.playInfo.maxGameTime;\r\n            this.playInfo.gameTime = this.playInfo.maxGameTime;\r\n        }\r\n    }\r\n\r\n    updateCanvas() {\r\n        this.canvas.readData(this.operator.g$graphicData);\r\n        this.canvas.paint();\r\n    }\r\n}\r\n","// Copyright (c) 2013 Pieroxy <pieroxy@pieroxy.net>\n// This work is free. You can redistribute it and/or modify it\n// under the terms of the WTFPL, Version 2\n// For more information see LICENSE.txt or http://www.wtfpl.net/\n//\n// For more information, the home page:\n// http://pieroxy.net/blog/pages/lz-string/testing.html\n//\n// LZ-based compression algorithm, version 1.4.5\nvar LZString = (function() {\n\n// private property\nvar f = String.fromCharCode;\nvar keyStrBase64 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\nvar keyStrUriSafe = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$\";\nvar baseReverseDic = {};\n\nfunction getBaseValue(alphabet, character) {\n  if (!baseReverseDic[alphabet]) {\n    baseReverseDic[alphabet] = {};\n    for (var i=0 ; i<alphabet.length ; i++) {\n      baseReverseDic[alphabet][alphabet.charAt(i)] = i;\n    }\n  }\n  return baseReverseDic[alphabet][character];\n}\n\nvar LZString = {\n  compressToBase64 : function (input) {\n    if (input == null) return \"\";\n    var res = LZString._compress(input, 6, function(a){return keyStrBase64.charAt(a);});\n    switch (res.length % 4) { // To produce valid Base64\n    default: // When could this happen ?\n    case 0 : return res;\n    case 1 : return res+\"===\";\n    case 2 : return res+\"==\";\n    case 3 : return res+\"=\";\n    }\n  },\n\n  decompressFromBase64 : function (input) {\n    if (input == null) return \"\";\n    if (input == \"\") return null;\n    return LZString._decompress(input.length, 32, function(index) { return getBaseValue(keyStrBase64, input.charAt(index)); });\n  },\n\n  compressToUTF16 : function (input) {\n    if (input == null) return \"\";\n    return LZString._compress(input, 15, function(a){return f(a+32);}) + \" \";\n  },\n\n  decompressFromUTF16: function (compressed) {\n    if (compressed == null) return \"\";\n    if (compressed == \"\") return null;\n    return LZString._decompress(compressed.length, 16384, function(index) { return compressed.charCodeAt(index) - 32; });\n  },\n\n  //compress into uint8array (UCS-2 big endian format)\n  compressToUint8Array: function (uncompressed) {\n    var compressed = LZString.compress(uncompressed);\n    var buf=new Uint8Array(compressed.length*2); // 2 bytes per character\n\n    for (var i=0, TotalLen=compressed.length; i<TotalLen; i++) {\n      var current_value = compressed.charCodeAt(i);\n      buf[i*2] = current_value >>> 8;\n      buf[i*2+1] = current_value % 256;\n    }\n    return buf;\n  },\n\n  //decompress from uint8array (UCS-2 big endian format)\n  decompressFromUint8Array:function (compressed) {\n    if (compressed===null || compressed===undefined){\n        return LZString.decompress(compressed);\n    } else {\n        var buf=new Array(compressed.length/2); // 2 bytes per character\n        for (var i=0, TotalLen=buf.length; i<TotalLen; i++) {\n          buf[i]=compressed[i*2]*256+compressed[i*2+1];\n        }\n\n        var result = [];\n        buf.forEach(function (c) {\n          result.push(f(c));\n        });\n        return LZString.decompress(result.join(''));\n\n    }\n\n  },\n\n\n  //compress into a string that is already URI encoded\n  compressToEncodedURIComponent: function (input) {\n    if (input == null) return \"\";\n    return LZString._compress(input, 6, function(a){return keyStrUriSafe.charAt(a);});\n  },\n\n  //decompress from an output of compressToEncodedURIComponent\n  decompressFromEncodedURIComponent:function (input) {\n    if (input == null) return \"\";\n    if (input == \"\") return null;\n    input = input.replace(/ /g, \"+\");\n    return LZString._decompress(input.length, 32, function(index) { return getBaseValue(keyStrUriSafe, input.charAt(index)); });\n  },\n\n  compress: function (uncompressed) {\n    return LZString._compress(uncompressed, 16, function(a){return f(a);});\n  },\n  _compress: function (uncompressed, bitsPerChar, getCharFromInt) {\n    if (uncompressed == null) return \"\";\n    var i, value,\n        context_dictionary= {},\n        context_dictionaryToCreate= {},\n        context_c=\"\",\n        context_wc=\"\",\n        context_w=\"\",\n        context_enlargeIn= 2, // Compensate for the first entry which should not count\n        context_dictSize= 3,\n        context_numBits= 2,\n        context_data=[],\n        context_data_val=0,\n        context_data_position=0,\n        ii;\n\n    for (ii = 0; ii < uncompressed.length; ii += 1) {\n      context_c = uncompressed.charAt(ii);\n      if (!Object.prototype.hasOwnProperty.call(context_dictionary,context_c)) {\n        context_dictionary[context_c] = context_dictSize++;\n        context_dictionaryToCreate[context_c] = true;\n      }\n\n      context_wc = context_w + context_c;\n      if (Object.prototype.hasOwnProperty.call(context_dictionary,context_wc)) {\n        context_w = context_wc;\n      } else {\n        if (Object.prototype.hasOwnProperty.call(context_dictionaryToCreate,context_w)) {\n          if (context_w.charCodeAt(0)<256) {\n            for (i=0 ; i<context_numBits ; i++) {\n              context_data_val = (context_data_val << 1);\n              if (context_data_position == bitsPerChar-1) {\n                context_data_position = 0;\n                context_data.push(getCharFromInt(context_data_val));\n                context_data_val = 0;\n              } else {\n                context_data_position++;\n              }\n            }\n            value = context_w.charCodeAt(0);\n            for (i=0 ; i<8 ; i++) {\n              context_data_val = (context_data_val << 1) | (value&1);\n              if (context_data_position == bitsPerChar-1) {\n                context_data_position = 0;\n                context_data.push(getCharFromInt(context_data_val));\n                context_data_val = 0;\n              } else {\n                context_data_position++;\n              }\n              value = value >> 1;\n            }\n          } else {\n            value = 1;\n            for (i=0 ; i<context_numBits ; i++) {\n              context_data_val = (context_data_val << 1) | value;\n              if (context_data_position ==bitsPerChar-1) {\n                context_data_position = 0;\n                context_data.push(getCharFromInt(context_data_val));\n                context_data_val = 0;\n              } else {\n                context_data_position++;\n              }\n              value = 0;\n            }\n            value = context_w.charCodeAt(0);\n            for (i=0 ; i<16 ; i++) {\n              context_data_val = (context_data_val << 1) | (value&1);\n              if (context_data_position == bitsPerChar-1) {\n                context_data_position = 0;\n                context_data.push(getCharFromInt(context_data_val));\n                context_data_val = 0;\n              } else {\n                context_data_position++;\n              }\n              value = value >> 1;\n            }\n          }\n          context_enlargeIn--;\n          if (context_enlargeIn == 0) {\n            context_enlargeIn = Math.pow(2, context_numBits);\n            context_numBits++;\n          }\n          delete context_dictionaryToCreate[context_w];\n        } else {\n          value = context_dictionary[context_w];\n          for (i=0 ; i<context_numBits ; i++) {\n            context_data_val = (context_data_val << 1) | (value&1);\n            if (context_data_position == bitsPerChar-1) {\n              context_data_position = 0;\n              context_data.push(getCharFromInt(context_data_val));\n              context_data_val = 0;\n            } else {\n              context_data_position++;\n            }\n            value = value >> 1;\n          }\n\n\n        }\n        context_enlargeIn--;\n        if (context_enlargeIn == 0) {\n          context_enlargeIn = Math.pow(2, context_numBits);\n          context_numBits++;\n        }\n        // Add wc to the dictionary.\n        context_dictionary[context_wc] = context_dictSize++;\n        context_w = String(context_c);\n      }\n    }\n\n    // Output the code for w.\n    if (context_w !== \"\") {\n      if (Object.prototype.hasOwnProperty.call(context_dictionaryToCreate,context_w)) {\n        if (context_w.charCodeAt(0)<256) {\n          for (i=0 ; i<context_numBits ; i++) {\n            context_data_val = (context_data_val << 1);\n            if (context_data_position == bitsPerChar-1) {\n              context_data_position = 0;\n              context_data.push(getCharFromInt(context_data_val));\n              context_data_val = 0;\n            } else {\n              context_data_position++;\n            }\n          }\n          value = context_w.charCodeAt(0);\n          for (i=0 ; i<8 ; i++) {\n            context_data_val = (context_data_val << 1) | (value&1);\n            if (context_data_position == bitsPerChar-1) {\n              context_data_position = 0;\n              context_data.push(getCharFromInt(context_data_val));\n              context_data_val = 0;\n            } else {\n              context_data_position++;\n            }\n            value = value >> 1;\n          }\n        } else {\n          value = 1;\n          for (i=0 ; i<context_numBits ; i++) {\n            context_data_val = (context_data_val << 1) | value;\n            if (context_data_position == bitsPerChar-1) {\n              context_data_position = 0;\n              context_data.push(getCharFromInt(context_data_val));\n              context_data_val = 0;\n            } else {\n              context_data_position++;\n            }\n            value = 0;\n          }\n          value = context_w.charCodeAt(0);\n          for (i=0 ; i<16 ; i++) {\n            context_data_val = (context_data_val << 1) | (value&1);\n            if (context_data_position == bitsPerChar-1) {\n              context_data_position = 0;\n              context_data.push(getCharFromInt(context_data_val));\n              context_data_val = 0;\n            } else {\n              context_data_position++;\n            }\n            value = value >> 1;\n          }\n        }\n        context_enlargeIn--;\n        if (context_enlargeIn == 0) {\n          context_enlargeIn = Math.pow(2, context_numBits);\n          context_numBits++;\n        }\n        delete context_dictionaryToCreate[context_w];\n      } else {\n        value = context_dictionary[context_w];\n        for (i=0 ; i<context_numBits ; i++) {\n          context_data_val = (context_data_val << 1) | (value&1);\n          if (context_data_position == bitsPerChar-1) {\n            context_data_position = 0;\n            context_data.push(getCharFromInt(context_data_val));\n            context_data_val = 0;\n          } else {\n            context_data_position++;\n          }\n          value = value >> 1;\n        }\n\n\n      }\n      context_enlargeIn--;\n      if (context_enlargeIn == 0) {\n        context_enlargeIn = Math.pow(2, context_numBits);\n        context_numBits++;\n      }\n    }\n\n    // Mark the end of the stream\n    value = 2;\n    for (i=0 ; i<context_numBits ; i++) {\n      context_data_val = (context_data_val << 1) | (value&1);\n      if (context_data_position == bitsPerChar-1) {\n        context_data_position = 0;\n        context_data.push(getCharFromInt(context_data_val));\n        context_data_val = 0;\n      } else {\n        context_data_position++;\n      }\n      value = value >> 1;\n    }\n\n    // Flush the last char\n    while (true) {\n      context_data_val = (context_data_val << 1);\n      if (context_data_position == bitsPerChar-1) {\n        context_data.push(getCharFromInt(context_data_val));\n        break;\n      }\n      else context_data_position++;\n    }\n    return context_data.join('');\n  },\n\n  decompress: function (compressed) {\n    if (compressed == null) return \"\";\n    if (compressed == \"\") return null;\n    return LZString._decompress(compressed.length, 32768, function(index) { return compressed.charCodeAt(index); });\n  },\n\n  _decompress: function (length, resetValue, getNextValue) {\n    var dictionary = [],\n        next,\n        enlargeIn = 4,\n        dictSize = 4,\n        numBits = 3,\n        entry = \"\",\n        result = [],\n        i,\n        w,\n        bits, resb, maxpower, power,\n        c,\n        data = {val:getNextValue(0), position:resetValue, index:1};\n\n    for (i = 0; i < 3; i += 1) {\n      dictionary[i] = i;\n    }\n\n    bits = 0;\n    maxpower = Math.pow(2,2);\n    power=1;\n    while (power!=maxpower) {\n      resb = data.val & data.position;\n      data.position >>= 1;\n      if (data.position == 0) {\n        data.position = resetValue;\n        data.val = getNextValue(data.index++);\n      }\n      bits |= (resb>0 ? 1 : 0) * power;\n      power <<= 1;\n    }\n\n    switch (next = bits) {\n      case 0:\n          bits = 0;\n          maxpower = Math.pow(2,8);\n          power=1;\n          while (power!=maxpower) {\n            resb = data.val & data.position;\n            data.position >>= 1;\n            if (data.position == 0) {\n              data.position = resetValue;\n              data.val = getNextValue(data.index++);\n            }\n            bits |= (resb>0 ? 1 : 0) * power;\n            power <<= 1;\n          }\n        c = f(bits);\n        break;\n      case 1:\n          bits = 0;\n          maxpower = Math.pow(2,16);\n          power=1;\n          while (power!=maxpower) {\n            resb = data.val & data.position;\n            data.position >>= 1;\n            if (data.position == 0) {\n              data.position = resetValue;\n              data.val = getNextValue(data.index++);\n            }\n            bits |= (resb>0 ? 1 : 0) * power;\n            power <<= 1;\n          }\n        c = f(bits);\n        break;\n      case 2:\n        return \"\";\n    }\n    dictionary[3] = c;\n    w = c;\n    result.push(c);\n    while (true) {\n      if (data.index > length) {\n        return \"\";\n      }\n\n      bits = 0;\n      maxpower = Math.pow(2,numBits);\n      power=1;\n      while (power!=maxpower) {\n        resb = data.val & data.position;\n        data.position >>= 1;\n        if (data.position == 0) {\n          data.position = resetValue;\n          data.val = getNextValue(data.index++);\n        }\n        bits |= (resb>0 ? 1 : 0) * power;\n        power <<= 1;\n      }\n\n      switch (c = bits) {\n        case 0:\n          bits = 0;\n          maxpower = Math.pow(2,8);\n          power=1;\n          while (power!=maxpower) {\n            resb = data.val & data.position;\n            data.position >>= 1;\n            if (data.position == 0) {\n              data.position = resetValue;\n              data.val = getNextValue(data.index++);\n            }\n            bits |= (resb>0 ? 1 : 0) * power;\n            power <<= 1;\n          }\n\n          dictionary[dictSize++] = f(bits);\n          c = dictSize-1;\n          enlargeIn--;\n          break;\n        case 1:\n          bits = 0;\n          maxpower = Math.pow(2,16);\n          power=1;\n          while (power!=maxpower) {\n            resb = data.val & data.position;\n            data.position >>= 1;\n            if (data.position == 0) {\n              data.position = resetValue;\n              data.val = getNextValue(data.index++);\n            }\n            bits |= (resb>0 ? 1 : 0) * power;\n            power <<= 1;\n          }\n          dictionary[dictSize++] = f(bits);\n          c = dictSize-1;\n          enlargeIn--;\n          break;\n        case 2:\n          return result.join('');\n      }\n\n      if (enlargeIn == 0) {\n        enlargeIn = Math.pow(2, numBits);\n        numBits++;\n      }\n\n      if (dictionary[c]) {\n        entry = dictionary[c];\n      } else {\n        if (c === dictSize) {\n          entry = w + w.charAt(0);\n        } else {\n          return null;\n        }\n      }\n      result.push(entry);\n\n      // Add w+entry[0] to the dictionary.\n      dictionary[dictSize++] = w + entry.charAt(0);\n      enlargeIn--;\n\n      w = entry;\n\n      if (enlargeIn == 0) {\n        enlargeIn = Math.pow(2, numBits);\n        numBits++;\n      }\n\n    }\n  }\n};\n  return LZString;\n})();\n\nif (typeof define === 'function' && define.amd) {\n  define(function () { return LZString; });\n} else if( typeof module !== 'undefined' && module != null ) {\n  module.exports = LZString\n} else if( typeof angular !== 'undefined' && angular != null ) {\n  angular.module('LZString', [])\n  .factory('LZString', function () {\n    return LZString;\n  });\n}\n","import { BlockKind } from \"./BlockOperate/Block\";\r\nimport { AutoKeyboardInputData } from \"./Interaction/AutoKeyboardManager\";\r\nimport { PlaySetting, ReplayData } from \"./Run\";\r\nimport LZString from \"lz-string\";\r\n\r\n// export type ReplayData = {\r\n//     inputData: AutoKeyboardInputData[][];\r\n//     nextData: BlockKind[][];\r\n//     playSetting: PlaySetting;\r\n//     finishTime: number;\r\n//     finishPlayers: number[];\r\n//     nuisanceBlockData: number[][];\r\n//     date: string;\r\n// };\r\n\r\nconst keyCodes = [\"ArrowLeft\", \"ArrowRight\", \"ArrowUp\", \"ArrowDown\", \"KeyC\", \"KeyV\", \"KeyB\", \"Space\", \"Enter\"];\r\nconst blockKinds = [\"L\", \"J\", \"p\", \"q\", \"U\", \"I\"];\r\nconst numbers = [\"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"a\", \"b\", \"c\", \"d\", \"e\", \"f\", \"g\"];\r\n\r\nexport function replayDataEncryption(data: ReplayData): string {\r\n    const inputData = data.inputData.map((playerInputData) =>\r\n        playerInputData\r\n            .map((input, i) => {\r\n                return (playerInputData[i].time - (i == 0 ? 0 : playerInputData[i - 1].time)).toString(5) + (keyCodes.indexOf(input.keyCode) + 5).toString(36);\r\n            })\r\n            .join(\"\")\r\n    );\r\n    const nextData = data.nextData.map((playerNextData) => playerNextData.map((kind) => blockKinds.indexOf(kind) + \"\").join(\"\"));\r\n    const nuisanceBlockData = data.nuisanceBlockData.map((playerNuisanceData) => playerNuisanceData.map((x) => numbers[x]).join(\"\"));\r\n    const data1 = [\r\n        inputData,\r\n        nextData,\r\n        [data.playSetting.playerNumber, data.playSetting.mode, data.playSetting.maxGameTime, data.playSetting.handy],\r\n        data.finishTime,\r\n        data.finishPlayers,\r\n        nuisanceBlockData,\r\n        data.date,\r\n    ];\r\n    const data2 = LZString.compressToUTF16(JSON.stringify(data1));\r\n    return data2;\r\n}\r\n\r\nexport function replayDataDecryption(encryptedData: string): ReplayData {\r\n    const objectData = JSON.parse(LZString.decompressFromUTF16(encryptedData));\r\n    const inputData = objectData[0]\r\n        .map((playerInputData: string) => {\r\n            return playerInputData.match(/[0-4]+[^0-4]*|[^0-4]+/g);\r\n        })\r\n        .map((playerInputData: string[]) => {\r\n            return playerInputData.map((_, i) => ({\r\n                time: sum(playerInputData.filter((_, j) => j <= i).map((filteredInputNumber) => Number.parseInt(filteredInputNumber.slice(0, -1), 5))),\r\n                keyCode: keyCodes[Number.parseInt(playerInputData[i].slice(-1), 36) - 5],\r\n                type: \"downup\",\r\n            }));\r\n        });\r\n    const nextData = objectData[1].map((playerNextData: string) => playerNextData.split(\"\").map((word) => blockKinds[parseInt(word)]));\r\n    const nuisanceBlockData = objectData[5].map((playerNuisanceData: string) => playerNuisanceData.split(\"\").map((word) => numbers.indexOf(word)));\r\n\r\n    return {\r\n        inputData: inputData,\r\n        nextData: nextData,\r\n        playSetting: {\r\n            playerNumber: objectData[2][0],\r\n            mode: objectData[2][1],\r\n            maxGameTime: objectData[2][2],\r\n            handy: objectData[2][3],\r\n        },\r\n        finishTime: objectData[3],\r\n        finishPlayers: objectData[4],\r\n        nuisanceBlockData: nuisanceBlockData,\r\n        date: objectData[6],\r\n    } as ReplayData;\r\n}\r\n\r\n// console.log(btoa(String.fromCharCode(...new Uint8Array(new Uint16Array([3333333, 3333344]).buffer))));\r\n// console.log(Array.from(new Uint16Array(Uint8Array.from(atob(btoa(String.fromCharCode(...new Uint8Array(new Uint16Array([66333, 33334]).buffer)))), (c) => c.charCodeAt(0)).buffer)));\r\n\r\nfunction numberEncryption(max: number, data: number[]): number {\r\n    let encryptedData = 0;\r\n    for (let i = data.length - 1; i >= 0; i--) {\r\n        encryptedData = encryptedData * max + data[i];\r\n    }\r\n    return encryptedData;\r\n}\r\n\r\nfunction numberDecryption(max: number, encryptedData: number, length: number): number[] {\r\n    let decryptedData = [];\r\n    for (let i = 0; i < length; i++) {\r\n        decryptedData.push(encryptedData % max);\r\n        encryptedData = Math.floor(encryptedData / max);\r\n    }\r\n    return decryptedData;\r\n}\r\n\r\nexport function sum(numbers: number[]) {\r\n    let result = 0;\r\n    numbers.forEach((number) => {\r\n        result += number;\r\n    });\r\n    return result;\r\n}\r\n","import { EventId, EventManager } from \"./EventManager\";\r\nimport { GamePlayer } from \"./Game/GamePlayer\";\r\nimport { Input } from \"./Interaction/Input\";\r\nimport { inputManager } from \"./Interaction/InputManager\";\r\nimport { pageManager } from \"./PageManager\";\r\nimport { sleep, qs, qsAll, getMinElement, removeMousePointerTemporary, qsAddEvent } from \"./Utils\";\r\nimport * as Setting from \"./Settings\";\r\nimport { game, players, replay } from \"./Run\";\r\n\r\n//画面のinputによる操作\r\nconst pageOperateEvents: EventId[] = [];\r\nconst listeningInputs: Input[] = [];\r\nlet focusFlag = false;\r\nlet lastOperateTime = 0;\r\n\r\npageManager.addEvent([\"pageChanged\"], async () => {\r\n    const page = pageManager.g$currentPage;\r\n    if (!page) {\r\n        return;\r\n    }\r\n    const id = page.id;\r\n    if (document.activeElement instanceof HTMLElement) {\r\n        document.activeElement.blur();\r\n    }\r\n    //情報を更新する\r\n    EventManager.removeEvents(pageOperateEvents);\r\n    // console.log(\"remove:\" + id);\r\n    pageOperateEvents.length = 0;\r\n    listeningInputs.length = 0;\r\n    listeningInputs.concat(inputManager.g$inputs);\r\n    //ページのボタンを最初にfocusするか\r\n    if (focusFlag) {\r\n        qs(`#${id} [data-mapping]`)?.focus();\r\n        focusFlag = false;\r\n    }\r\n    //早すぎるページ遷移の禁止\r\n    await sleep(300);\r\n    //イベントの追加\r\n    inputManager.g$inputs.forEach((input) => {\r\n        addPageOperateEvent(id, input);\r\n    });\r\n});\r\n\r\nfunction addPageOperateEvent(id: string, input: Input) {\r\n    if (listeningInputs.includes(input)) {\r\n        return;\r\n    }\r\n    const manager = input.g$manager;\r\n\r\n    //pageStartの処理\r\n    if (id == \"pageStart\") {\r\n        const eventId = manager.addEvent([\"onKeydown\", \"onButtondown\", \"onStickActive\"], () => {\r\n            focusFlag = false;\r\n            qs(\"#pageStart\").click();\r\n            operateWithInput();\r\n        });\r\n        pageOperateEvents.push(eventId);\r\n        return;\r\n    }\r\n\r\n    const eventId = manager.addEvent([\"onKeydown\", \"onButtondown\", \"onStickActive\"], () => {\r\n        //前回の操作から間が空いていないならreturn\r\n        if (Date.now() - lastOperateTime <= Setting.debounceOperateTime) {\r\n            return;\r\n        }\r\n\r\n        const options = qsAll(`#${id} [data-mapping]`);\r\n        const optionInfos = options.map((option) => ({\r\n            element: option as HTMLElement,\r\n            coordinate: JSON.parse(option.dataset.mapping!) as [number, number],\r\n        }));\r\n\r\n        const latestKey = manager.g$latestPressingKey;\r\n        if ([\"KeyX\", \"Escape\", \"Backspace\", \"button:0\"].includes(latestKey)) {\r\n            focusFlag = true;\r\n            qs(`#${id} .back`)?.click();\r\n            operateWithInput();\r\n            return;\r\n        }\r\n\r\n        if (id == \"play\") {\r\n            if ([\"KeyP\", ...Setting.gamepadConfigPresets[0].pause].includes(latestKey)) {\r\n                focusFlag = true;\r\n                operateWithInput();\r\n                if (replay && (players![0] as GamePlayer).loop.g$isLooping) {\r\n                    game!.stop();\r\n                    pageManager.setPage(\"replayPause\");\r\n                }\r\n            }\r\n        }\r\n\r\n        const selectElement = optionInfos.find(({ element: option }) => option == document.activeElement);\r\n        if (!selectElement) {\r\n            if (options.length) {\r\n                options[0].focus();\r\n            }\r\n            return;\r\n        }\r\n        const getMoveElement = ([dx, dy]: [number | null, number | null]) => {\r\n            let [sx, sy] = selectElement.coordinate;\r\n            let move = getMinElement(\r\n                optionInfos\r\n                    .filter(({ coordinate: [x, y] }) => x == sx + (dx ?? x - sx) && y == sy + (dy ?? y - sy))\r\n                    .map(({ element: option, coordinate: [x, y] }) => ({ element: option, value: Math.hypot(x - sx, y - sy) }))\r\n            );\r\n            if (!move) {\r\n                move = getMinElement(\r\n                    optionInfos\r\n                        .filter(({ coordinate: [x, y] }) => x == (dx ? x : sx) && y == (dy ? y : sy))\r\n                        .map(({ element: option, coordinate: [x, y] }) => ({ element: option, value: (dx ? 0 : Math.sign(dy ?? 0) * y) + (dy ? 0 : Math.sign(dx ?? 0) * x) }))\r\n                );\r\n            }\r\n            if (!move) {\r\n                move = selectElement.element;\r\n            }\r\n            return move as HTMLElement;\r\n        };\r\n        if ([\"ArrowUp\", \"KeyW\", \"button:12\", \"stick:-1\"].includes(latestKey)) {\r\n            const element = getMoveElement([null, -1]);\r\n            element.focus();\r\n            operateWithInput();\r\n        }\r\n        if ([\"ArrowDown\", \"KeyS\", \"button:13\", \"stick:+1\"].includes(latestKey)) {\r\n            getMoveElement([null, 1]).focus();\r\n            operateWithInput();\r\n        }\r\n        if ([\"ArrowLeft\", \"KeyA\", \"button:14\", \"stick:-0\"].includes(latestKey)) {\r\n            getMoveElement([-1, null]).focus();\r\n            operateWithInput();\r\n        }\r\n        if ([\"ArrowRight\", \"KeyD\", \"button:15\", \"stick:+0\"].includes(latestKey)) {\r\n            getMoveElement([1, null]).focus();\r\n            operateWithInput();\r\n        }\r\n        if ([\"Tab\"].includes(latestKey)) {\r\n            getMoveElement([1, 1]).focus();\r\n            operateWithInput();\r\n        }\r\n        if ([\"Enter\", \"Space\", \"KeyZ\", \"button:1\"].includes(latestKey)) {\r\n            if (document.activeElement instanceof HTMLElement) {\r\n                focusFlag = true;\r\n                document.activeElement.click();\r\n                operateWithInput();\r\n            }\r\n        }\r\n    });\r\n\r\n    pageOperateEvents.push(eventId);\r\n}\r\n\r\nfunction operateWithInput() {\r\n    lastOperateTime = Date.now();\r\n    removeMousePointerTemporary();\r\n}\r\n\r\ninputManager.addEvent([\"inputAdded\"], () => {\r\n    addPageOperateEvent(pageManager.g$currentPageId ?? \"pageStart\", inputManager.g$inputs.at(-1)!);\r\n});\r\n\r\n//マウス操作との整合\r\nqsAddEvent(\"[data-mapping]\", \"mouseover\", (element) => {\r\n    element.focus();\r\n});\r\n\r\nqsAddEvent(\"[data-mapping]\", \"mouseleave\", (element) => {\r\n    if (document.activeElement == element) {\r\n        (element as HTMLElement).blur();\r\n    }\r\n});\r\n\r\nqsAddEvent(\"[data-mapping]\", \"click\", () => {\r\n    lastOperateTime = Date.now();\r\n});\r\n","import { BGM } from \"./BGM\";\r\nimport { pageManager } from \"./PageManager\";\r\nimport { Sound } from \"./Sound\";\r\nimport { getMinElement, qs, qsAddEvent, qsAll, removeMousePointerTemporary, sleep } from \"./Utils\";\r\nimport { inputManager } from \"./Interaction/InputManager\";\r\nimport { Mode1 } from \"./Game/Modes/Mode1\";\r\nimport { Mode2 } from \"./Game/Modes/Mode2\";\r\nimport { GamePlayer } from \"./Game/GamePlayer\";\r\nimport * as Setting from \"./Settings\";\r\nimport { GameMode, OperateName } from \"./Game/GameMode\";\r\nimport { EventId, EventManager } from \"./EventManager\";\r\nimport { Input } from \"./Interaction/Input\";\r\nimport { playBackground } from \"./PlayBackground\";\r\nimport { AutoKeyboardInputData, AutoKeyboardManager } from \"./Interaction/AutoKeyboardManager\";\r\nimport { BlockKind } from \"./BlockOperate/Block\";\r\nimport { replayDataDecryption, replayDataEncryption, sum } from \"./DataCompression\";\r\nimport \"./ScreenInteraction\";\r\n\r\n//不正なページ遷移の防止\r\ndocument.addEventListener(\"keydown\", (e) => {\r\n    if (e.code == \"Tab\" || e.code == \"Space\" || e.code == \"Enter\") {\r\n        e.preventDefault();\r\n    }\r\n});\r\n\r\nqsAll(\"button\").forEach((button) => {\r\n    button.tabIndex = -1;\r\n});\r\nqsAll(\"input\").forEach((button) => {\r\n    button.tabIndex = -1;\r\n});\r\nqsAll(\"div[data-mapping]\").forEach((button) => {\r\n    button.tabIndex = 0;\r\n});\r\n\r\n//クリックによる開始\r\nqsAddEvent(\"#pageStart\", \"click\", () => {\r\n    pageManager.setPage(\"title\");\r\n    // se[0].play();\r\n});\r\n\r\n//起動時処理\r\nexport let se: Sound[] = [];\r\ndocument.addEventListener(\"DOMContentLoaded\", async () => {\r\n    pageManager.init();\r\n    BGM.init();\r\n    Sound.init();\r\n    // se = [new Sound({ src: \"assets/sounds/決定ボタンを押す32.mp3\" }), new Sound({ src: \"assets/sounds/カーソル移動9.mp3\" }), new Sound({ src: \"assets/sounds/正解のときの音.mp3\" })];\r\n    inputManager.s$maxInputNumber = 1;\r\n    readSavedReplayData();\r\n    console.log(`The sum of size of replayData is ${new Blob([localStorage.getItem(\"Pentamond3-replayData\") ?? \"[]\"]).size}byte`);\r\n});\r\n\r\n//ゲーム開始\r\nexport type PlaySetting = {\r\n    playerNumber: number;\r\n    mode: number;\r\n    maxGameTime: number;\r\n    handy: number[];\r\n};\r\n\r\nlet playSetting = {\r\n    playerNumber: 1,\r\n    mode: 1,\r\n    maxGameTime: 50,\r\n    handy: [1],\r\n};\r\n\r\nconst modeClass = [Mode1, Mode2];\r\nexport let game: GameMode | null;\r\nexport let players: GamePlayer[] | null;\r\nconst debug = false;\r\nexport let replay = false;\r\n\r\nqsAddEvent(\".playStart\", \"click\", () => {\r\n    pageManager.backLatestPage(\"playPrepare\", { eventIgnore: true });\r\n    gameStart();\r\n});\r\n\r\nfunction gameStart() {\r\n    //プレイが終了していない場合は終了させる\r\n    if (game) {\r\n        game.stop();\r\n        game.remove();\r\n    }\r\n    playBackground.reset();\r\n    //登録されているinputをもとにGameModeを作成する\r\n    players = inputManager.g$registeredInputs.map((input) => new GamePlayer(input));\r\n    game = new modeClass[playSetting.mode - 1](players);\r\n    players.forEach((player) => {\r\n        if (inputManager.g$registeredInputNumber == 1) {\r\n            player.g$element.style.flex = \"none\";\r\n            player.g$element.style.height = \"100%\";\r\n            player.g$element.style.width = \"\";\r\n        } else {\r\n            player.g$element.style.flex = \"\";\r\n            player.g$element.style.height = \"\";\r\n            player.g$element.style.width = `0px`;\r\n        }\r\n        qs(\"#play\").appendChild(player.g$element);\r\n        player.playInfo.maxGameTime = playSetting.maxGameTime;\r\n        player.playInfo.gameTime = playSetting.maxGameTime;\r\n    });\r\n    //リプレイ情報の読み込み\r\n    if (replay && readingReplayData) {\r\n        players.forEach((player, i) => {\r\n            player.operator.s$next = readingReplayData!.nextData[i];\r\n            player.nuisanceMondManager.s$spawnCoordinates = readingReplayData!.nuisanceBlockData[i];\r\n        });\r\n    }\r\n\r\n    //ゲーム終了時処理\r\n    game.addEvent([\"gameFinish\"], async () => {\r\n        if (!game) {\r\n            return;\r\n        }\r\n        if (replay && readingReplayData) {\r\n            readingReplayData.finishPlayers.forEach((index) => {\r\n                players![index - 1].playInfo.playTime = readingReplayData!.finishTime;\r\n                players![index - 1].label.updateContents({ playTime: (readingReplayData!.finishTime / 1000).toFixed(2) });\r\n            });\r\n            qsAll(\".resultLabel\").forEach((resultLabel) => {\r\n                if (resultLabel.innerHTML.includes(\"Time\")) {\r\n                    resultLabel.innerHTML = `Time : ${(readingReplayData!.finishTime / 1000).toFixed(2)}`;\r\n                }\r\n            });\r\n        } else {\r\n            createReplayData();\r\n        }\r\n        createDetailedResult();\r\n        inputManager.removeVirtualInputs();\r\n        await sleep(1000);\r\n        if (replay) {\r\n            pageManager.setPage(\"replayResult\");\r\n        } else {\r\n            pageManager.setPage(\"result\");\r\n        }\r\n        game.remove();\r\n        game = null;\r\n    });\r\n\r\n    //開始演出\r\n    const countString: string[] = [\"\", \"3\", \"2\", \"1\", \"START!\"];\r\n    const countDown = () => {\r\n        const startEffectLabel = document.createElement(\"div\");\r\n        startEffectLabel.classList.add(\"startEffectLabel\");\r\n        startEffectLabel.innerHTML = countString.shift() ?? \"\";\r\n        if (countString.length == 0) {\r\n            startEffectLabel.id = \"startLabel\";\r\n        } else if (startEffectLabel.innerHTML != \"\") {\r\n        }\r\n        qs(\"#startEffectBase\").appendChild(startEffectLabel);\r\n        startEffectLabel.onanimationend = () => {\r\n            startEffectLabel.remove();\r\n            if (countString.length) {\r\n                countDown();\r\n            } else {\r\n                pageManager.backPages(1);\r\n                game!.start();\r\n                inputManager.g$registeredInputs.forEach((input) => {\r\n                    if (input.g$type == \"autoKeyboard\") {\r\n                        (input.g$manager as AutoKeyboardManager).playReset();\r\n                        (input.g$manager as AutoKeyboardManager).playStart();\r\n                    }\r\n                });\r\n            }\r\n        };\r\n    };\r\n    pageManager.setPage(\"play\", { eventIgnore: true });\r\n    pageManager.setPage(\"startEffect\");\r\n    countDown();\r\n}\r\n\r\nqsAddEvent(\"#resumeButton\", \"click\", () => {\r\n    game?.start();\r\n});\r\n\r\n//コントローラー登録\r\nexport let gamepadConfigs: Setting.GamepadConfig[] = [];\r\n\r\npageManager.addEvent([\"setPage-playerRegister\"], () => {\r\n    replay = false;\r\n    if (inputManager.g$registeredInputNumber) {\r\n        inputManager.removeVirtualInputs();\r\n        inputManager.resetRegister();\r\n    }\r\n    Array.from(qs(\"#connectionLabel\").children).forEach((element) => {\r\n        element.remove();\r\n    });\r\n    qs(\"#registerText\").innerHTML = `登録したい入力機器のボタンを押してください：あと${playSetting.playerNumber - inputManager.g$registeredInputNumber}人`;\r\n    gamepadConfigs = [];\r\n    inputManager.s$maxInputNumber = playSetting.playerNumber;\r\n    inputManager.startRegister();\r\n});\r\n\r\nqsAddEvent(\"#playerRegister .back\", \"click\", () => {\r\n    inputManager.resetRegister();\r\n});\r\n\r\nqsAddEvent(\"#playPrepare .back\", \"click\", () => {\r\n    inputManager.resetRegister();\r\n});\r\n\r\ninputManager.addEvent([\"inputRegistered\"], () => {\r\n    const registerInputs = inputManager.g$registeredInputs;\r\n    const typeIcon = document.createElement(\"div\");\r\n    // typeIcon.innerHTML = registerInputs[registerInputs.length - 1].g$type;\r\n    typeIcon.dataset.inputType = registerInputs[registerInputs.length - 1].g$type;\r\n    typeIcon.classList.add(\"inputTypeIcon\");\r\n    qs(\"#connectionLabel\").appendChild(typeIcon);\r\n    gamepadConfigs.push(Setting.gamepadConfigPresets[0]);\r\n    qs(\"#registerText\").innerHTML = `登録したい入力機器のボタンを押してください：あと${playSetting.playerNumber - inputManager.g$registeredInputNumber}人`;\r\n});\r\n\r\ninputManager.addEvent([\"finishRegister\"], () => {\r\n    qs(\"#registerText\").innerHTML = '<font style=\"color:#d66\">完了！</font>';\r\n});\r\n\r\nqsAddEvent(\"#registerButton\", \"click\", async () => {\r\n    if (inputManager.g$registering) {\r\n        if (debug) {\r\n            inputManager.finishRegister();\r\n        } else {\r\n            return;\r\n        }\r\n    }\r\n    inputManager.stop();\r\n    qsAll(\"#playerRegister button\").forEach((element) => {\r\n        (element as HTMLButtonElement).disabled = true;\r\n    });\r\n    await sleep(500);\r\n    pageManager.backPages(playSetting.playerNumber == 1 ? 1 : 2, { eventIgnore: true });\r\n    pageManager.setPage(\"playPrepare\");\r\n    qsAll(\"#playerRegister button\").forEach((element) => {\r\n        (element as HTMLButtonElement).disabled = false;\r\n    });\r\n    inputManager.start();\r\n});\r\n\r\n//モード読み込み\r\nqsAddEvent(\"button[data-mode]\", \"click\", (element) => {\r\n    playSetting.mode = +element.dataset.mode!;\r\n});\r\n\r\nqsAddEvent(\"button[data-player]\", \"click\", (element) => {\r\n    playSetting.playerNumber = +element.dataset.player!;\r\n});\r\n\r\n//詳細結果の中身を作成する\r\nfunction createDetailedResult() {\r\n    if (!players) {\r\n        return;\r\n    }\r\n    qsAll(\"#detailedResult .subPage\").forEach((subPage) => {\r\n        subPage.remove();\r\n    });\r\n    const subPageController = qs(\"#detailedResult .subPageController\");\r\n    const subPage = document.createElement(\"div\");\r\n    subPage.classList.add(\"subPage\");\r\n    const text = document.createElement(\"div\");\r\n    text.classList.add(\"text\");\r\n    subPage.appendChild(text);\r\n    text.innerHTML =\r\n        `Player人数 : ${players.length}<br />` + `モード : ${playSetting.mode == 1 ? \"サバイバル\" : \"十五列揃え\"}<br />` + (players.length != 1 ? `勝者 : ${qs(\".resultLabel\").innerHTML}<br />` : \"\");\r\n    subPageController.before(subPage);\r\n\r\n    players.forEach((p, i) => {\r\n        const subPage = document.createElement(\"div\");\r\n        subPage.classList.add(\"subPage\");\r\n        const text = document.createElement(\"div\");\r\n        text.classList.add(\"text\");\r\n        subPage.appendChild(text);\r\n        const text2 = document.createElement(\"div\");\r\n        text2.classList.add(\"text\");\r\n        subPage.appendChild(text2);\r\n        const text3 = document.createElement(\"div\");\r\n        text3.classList.add(\"text\");\r\n        subPage.appendChild(text3);\r\n\r\n        text.innerHTML =\r\n            `Player : ${i + 1}<br />` +\r\n            ([1].includes(playSetting.mode) ? `開始Time : ${p.playInfo.maxGameTime}<br />` : \"\") +\r\n            ([1].includes(playSetting.mode) ? `残りTime : ${p.playInfo.gameTime}<br />` : \"\") +\r\n            `プレイ時間 : ${(p.playInfo.playTime / 1000).toFixed(2)}<br />` +\r\n            `役の回数 : ${p.playInfo.trickCount}<br />` +\r\n            `一列揃え : ${p.playInfo.line}<br />` +\r\n            `最大Chain : ${p.playInfo.maxChain}<br />` +\r\n            `Score : ${p.playInfo.score}<br />`;\r\n\r\n        text2.innerHTML =\r\n            `ペナルティ : ${p.playInfo.penalty}<br />` +\r\n            `回復 : ${p.playInfo.recovery}<br />` +\r\n            `余剰回復 : ${p.playInfo.surplus}<br />` +\r\n            `設置 : ${p.playInfo.put}<br />` +\r\n            `ホールド : ${p.playInfo.hold}<br />` +\r\n            `一手戻し : ${p.playInfo.unput}<br />` +\r\n            `消去 : ${p.playInfo.remove}<br />`;\r\n        text3.innerHTML = `合計ダメージ : ${p.damageInfo.totalDamage}<br />` + `合計攻撃 : ${p.damageInfo.totalAttack}<br />` + `ハンデ : ×${p.playInfo.handy}<br />`;\r\n        subPageController.before(subPage);\r\n    });\r\n}\r\n\r\n//リプレイ\r\nexport type ReplayData = {\r\n    inputData: AutoKeyboardInputData[][];\r\n    nextData: BlockKind[][];\r\n    playSetting: PlaySetting;\r\n    finishTime: number;\r\n    finishPlayers: number[];\r\n    nuisanceBlockData: number[][];\r\n    date: number;\r\n};\r\n\r\nlet readingReplayData: ReplayData | null = null as ReplayData | null;\r\n\r\nconst temporaryReplayData: ReplayData[] = [];\r\n\r\nfunction createReplayData() {\r\n    if (!game || !players) {\r\n        return;\r\n    }\r\n    const convertOperateName = (operateName: OperateName) => {\r\n        return operateName == \"put\"\r\n            ? \"ArrowUp\"\r\n            : operateName == \"move-left\"\r\n            ? \"ArrowLeft\"\r\n            : operateName == \"move-right\"\r\n            ? \"ArrowRight\"\r\n            : operateName == \"move-down\"\r\n            ? \"ArrowDown\"\r\n            : operateName == \"spin-left\"\r\n            ? \"KeyC\"\r\n            : operateName == \"spin-right\"\r\n            ? \"KeyV\"\r\n            : operateName == \"unput\"\r\n            ? \"KeyB\"\r\n            : operateName == \"hold\"\r\n            ? \"Space\"\r\n            : operateName == \"removeLine\"\r\n            ? \"Enter\"\r\n            : \"\";\r\n    };\r\n    const finishTime = Math.max(...players.map((player) => player.playInfo.playTime));\r\n    const replayData: ReplayData = {\r\n        inputData: game.operateMemories.map((operateMemory) => operateMemory.map(({ time, operateName }) => ({ time: time, keyCode: convertOperateName(operateName), type: \"downup\" }))),\r\n        playSetting: window.structuredClone(playSetting) as PlaySetting,\r\n        nextData: players.map((p) => p.operator.g$nextMemory),\r\n        finishTime: finishTime,\r\n        finishPlayers: players.map((player, i) => (player.playInfo.playTime == finishTime ? i + 1 : -1)).filter((value) => value != -1),\r\n        nuisanceBlockData: players.map((player) => player.nuisanceMondManager.g$spawnCoordinateMemory),\r\n        date: Date.now(),\r\n    };\r\n    //リプレイボタンの追加\r\n    const replayContainer = document.createElement(\"div\");\r\n    replayContainer.classList = \"replayButtonContainer\";\r\n    const replayButton = document.createElement(\"button\");\r\n    replayButton.classList.add(\"replayButton\");\r\n    const now = new Date(replayData.date);\r\n    replayButton.innerHTML = `${now.getFullYear()}/${now.getMonth() + 1}/${now.getDate()} ${now.getHours()}:${now.getMinutes() < 10 ? \"0\" + now.getMinutes() : now.getMinutes()}:${\r\n        now.getSeconds() < 10 ? \"0\" + now.getSeconds() : now.getSeconds()\r\n    }`;\r\n    replayButton.addEventListener(\"click\", () => {\r\n        const replayButtons = qsAll(\"#replay .replayButton\");\r\n        const index = replayButtons.findIndex((button) => button == replayButton);\r\n        // lastOperateTime = Date.now();\r\n        startReplay(temporaryReplayData.at(-index - 1)!);\r\n    });\r\n    const saveButton = document.createElement(\"button\");\r\n    saveButton.classList.add(\"replaySaveButton\");\r\n    saveButton.addEventListener(\"click\", () => {\r\n        const saveButtons = qsAll(\"#replay .replaySaveButton\");\r\n        const index = saveButtons.findIndex((button) => button == saveButton);\r\n        // lastOperateTime = Date.now();\r\n        if (saveReplayData(temporaryReplayData.at(-index - 1)!)) {\r\n            readSavedReplayData();\r\n            saveButton.classList.add(\"replaySavedButton\");\r\n        }\r\n    });\r\n\r\n    replayContainer.appendChild(replayButton);\r\n    replayContainer.appendChild(saveButton);\r\n    replayContainer.querySelectorAll<HTMLButtonElement>(\"button\").forEach((button) => {\r\n        button.addEventListener(\"mouseover\", () => {\r\n            button.focus();\r\n        });\r\n        button.addEventListener(\"mouseleave\", () => {\r\n            if (document.activeElement == button) {\r\n                (button as HTMLButtonElement).blur();\r\n            }\r\n        });\r\n    });\r\n    qs(\"#replay .options\").prepend(replayContainer);\r\n\r\n    temporaryReplayData.push(replayData);\r\n    if (temporaryReplayData.length == Setting.maximumTemporaryReplaySavable + 1) {\r\n        temporaryReplayData.shift();\r\n        qs(\"#replay .replayButtonContainer:first-child\").remove();\r\n    }\r\n    //座標の割り振り直し\r\n    qsAll(\"#replay .replayButton\").forEach((button, i) => {\r\n        button.dataset.mapping = `[0,${i}]`;\r\n    });\r\n    qsAll(\"#replay .replaySaveButton\").forEach((button, i) => {\r\n        button.dataset.mapping = `[1,${i}]`;\r\n    });\r\n    qs(\"#replay .back\").dataset.mapping = `[0,${temporaryReplayData.length}]`;\r\n}\r\n\r\n//指定したdataでreplayを開始\r\nfunction startReplay(data: ReplayData) {\r\n    // console.log(`${new Blob([replayDataEncryption(data)]).size}byte`);\r\n    readingReplayData = data;\r\n    inputManager.removeVirtualInputs();\r\n    inputManager.resetRegister();\r\n    playSetting = window.structuredClone(readingReplayData.playSetting);\r\n    inputManager.s$maxInputNumber = readingReplayData.playSetting.playerNumber;\r\n    const inputs = Array.from({ length: readingReplayData.playSetting.playerNumber }, () => new Input(\"autoKeyboard\"));\r\n    inputs.forEach((input, i) => {\r\n        if (!(input.g$manager instanceof AutoKeyboardManager)) {\r\n            return;\r\n        }\r\n        input.g$manager.s$inputData = readingReplayData!.inputData[i];\r\n        inputManager.register(input);\r\n    });\r\n    replay = true;\r\n    gameStart();\r\n}\r\n\r\nqsAddEvent(\"#replayPause button:not(#replayResumeButton)\", \"click\", () => {\r\n    inputManager.removeVirtualInputs();\r\n});\r\n\r\nqsAddEvent(\"#replayResumeButton\", \"click\", () => {\r\n    game?.start();\r\n});\r\n\r\nqsAddEvent(\".replayStart\", \"click\", () => {\r\n    pageManager.backLatestPage(\"replay\", { eventIgnore: true });\r\n    startReplay(readingReplayData!);\r\n});\r\n\r\n// localStorage.removeItem(\"Pentamond3-replayData\");\r\n\r\n//保存されたリプレイ読み込み\r\nfunction readSavedReplayData() {\r\n    const replayData: ReplayData[] = JSON.parse(localStorage.getItem(\"Pentamond3-replayData\") ?? \"[]\").map((parsedData: string) => replayDataDecryption(parsedData)) as ReplayData[];\r\n    const container = qs(\"#savedReplay .options\");\r\n    container.querySelectorAll(\".replayButtonContainer\").forEach((element) => {\r\n        element.remove();\r\n    });\r\n\r\n    const replayContainers = Array.from({ length: replayData.length }, () => document.createElement(\"div\"));\r\n    const replayButtons = Array.from({ length: replayData.length }, () => document.createElement(\"button\"));\r\n    const deleteButtons = Array.from({ length: replayData.length }, () => document.createElement(\"button\"));\r\n    replayContainers.forEach((element, i) => {\r\n        element.classList.add(\"replayButtonContainer\");\r\n        element.appendChild(replayButtons[i]);\r\n        element.appendChild(deleteButtons[i]);\r\n        container.prepend(element);\r\n    });\r\n    deleteButtons.forEach((deleteButton, i) => {\r\n        deleteButton.classList.add(\"replayDeleteButton\");\r\n        deleteButton.addEventListener(\"click\", () => {\r\n            const confirmButton = qs(\"#replayDeleteConfirmButton\") as HTMLButtonElement;\r\n            const back = qs(\"#replayDeleteAlert .back\") as HTMLButtonElement;\r\n            pageManager.setPage(\"replayDeleteAlert\");\r\n\r\n            confirmButton.disabled = true;\r\n            confirmButton.style.opacity = \"0\";\r\n            sleep(1500).then(() => {\r\n                confirmButton.disabled = false;\r\n                confirmButton.style.opacity = \"1\";\r\n            });\r\n            new Promise<void>((resolve, reject) => {\r\n                let resolveFunc: any;\r\n                let rejectFunc: any;\r\n                resolveFunc = () => {\r\n                    resolve();\r\n                    confirmButton.removeEventListener(\"click\", resolveFunc);\r\n                    back.removeEventListener(\"click\", rejectFunc);\r\n                };\r\n                rejectFunc = () => {\r\n                    reject();\r\n                    confirmButton.removeEventListener(\"click\", resolveFunc);\r\n                    back.removeEventListener(\"click\", rejectFunc);\r\n                };\r\n\r\n                confirmButton.addEventListener(\"click\", resolveFunc);\r\n                back.addEventListener(\"click\", rejectFunc);\r\n            }).then(\r\n                () => {\r\n                    // lastOperateTime = Date.now();\r\n                    removeReplayData(replayData[i]);\r\n                    pageManager.backPages(2, { eventIgnore: true });\r\n                    readSavedReplayData();\r\n                    const index = temporaryReplayData.findIndex((data) => data.date == replayData[i].date);\r\n                    qsAll(\".replaySaveButton\")[temporaryReplayData.length - index - 1]?.classList.remove(\"replaySavedButton\");\r\n                    pageManager.setPage(\"savedReplay\");\r\n                },\r\n                () => {}\r\n            );\r\n        });\r\n    });\r\n    replayButtons.forEach((replayButton, i) => {\r\n        replayButton.classList.add(\"replayButton\");\r\n        const now = new Date(replayData[i].date);\r\n        replayButton.innerHTML = `${now.getFullYear()}/${now.getMonth() + 1}/${now.getDate()} ${now.getHours()}:${now.getMinutes() < 10 ? \"0\" + now.getMinutes() : now.getMinutes()}:${\r\n            now.getSeconds() < 10 ? \"0\" + now.getSeconds() : now.getSeconds()\r\n        }`;\r\n\r\n        replayButton.addEventListener(\"click\", () => {\r\n            // lastOperateTime = Date.now();\r\n            startReplay(replayData[i]);\r\n        });\r\n    });\r\n    container.querySelectorAll<HTMLButtonElement>(\"button\").forEach((button) => {\r\n        button.addEventListener(\"mouseover\", () => {\r\n            button.focus();\r\n        });\r\n        button.addEventListener(\"mouseleave\", () => {\r\n            if (document.activeElement == button) {\r\n                (button as HTMLButtonElement).blur();\r\n            }\r\n        });\r\n    });\r\n\r\n    //座標の割り振り\r\n    qsAll(\"#savedReplay .replayButton\").forEach((button, i) => {\r\n        button.dataset.mapping = `[0,${i}]`;\r\n    });\r\n    qsAll(\"#savedReplay .replayDeleteButton\").forEach((button, i) => {\r\n        button.dataset.mapping = `[1,${i}]`;\r\n    });\r\n\r\n    qs(\"#savedReplay .back\").dataset.mapping = `[0,${replayData.length}]`;\r\n}\r\n\r\n//リプレイデータの保存\r\nfunction saveReplayData(data: ReplayData) {\r\n    const replayData: ReplayData[] = JSON.parse(localStorage.getItem(\"Pentamond3-replayData\") ?? \"[]\").map((parsedData: string) => replayDataDecryption(parsedData)) as ReplayData[];\r\n    if (replayData.map((data) => data.date).includes(data.date)) {\r\n        return false;\r\n    }\r\n    if (replayData.length == 10) {\r\n        pageManager.setPage(\"replaySaveAlert\");\r\n        return false;\r\n    }\r\n    if (replayData.length) {\r\n        //indexが大きいほどdateが大きくなるようにする\r\n        if (replayData[replayData.length - 1].date < data.date) {\r\n            replayData.push(data);\r\n        } else {\r\n            for (let i = replayData.length - 1; i >= 0; i--) {\r\n                if (data.date < replayData[i].date) {\r\n                    replayData.splice(i, 0, data);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    } else {\r\n        replayData.push(data);\r\n    }\r\n    if (replayData.length == 11) {\r\n        replayData.shift();\r\n    }\r\n\r\n    const dataArray = replayData.map((data) => replayDataEncryption(data));\r\n    // dataArray.forEach((dataString) => {\r\n    //     const data = replayDataDecryption(dataString);\r\n    //     const now = new Date(data.date);\r\n    //     const date = `${now.getFullYear()}/${now.getMonth() + 1}/${now.getDate()} ${now.getHours()}:${now.getMinutes() < 10 ? \"0\" + now.getMinutes() : now.getMinutes()}:${\r\n    //         now.getSeconds() < 10 ? \"0\" + now.getSeconds() : now.getSeconds()\r\n    //     }`;\r\n    //     const size = new Blob([dataString]).size;\r\n    //     console.log(`The size of ${date} is ${size}`);\r\n    // });\r\n\r\n    try {\r\n        localStorage.setItem(\"Pentamond3-replayData\", JSON.stringify(dataArray));\r\n    } catch (error) {\r\n        pageManager.setPage(\"replaySaveAlert2\");\r\n        return false;\r\n    }\r\n    console.log(`The sum of size of replayData is ${new Blob([localStorage.getItem(\"Pentamond3-replayData\") ?? \"[]\"]).size}byte`);\r\n    return true;\r\n}\r\n\r\n//リプレイデータの削除\r\nfunction removeReplayData(data: ReplayData) {\r\n    const replayData: ReplayData[] = JSON.parse(localStorage.getItem(\"Pentamond3-replayData\") ?? \"[]\").map((parsedData: string) => replayDataDecryption(parsedData)) as ReplayData[];\r\n    localStorage.setItem(\"Pentamond3-replayData\", JSON.stringify(replayData.filter((value) => value.date != data.date).map((data) => replayDataEncryption(data))));\r\n}\r\n\r\nfunction removeAllData() {\r\n    localStorage.removeItem(\"Pentamond3-replayData\");\r\n    localStorage.removeItem(\"Pentamond3-graphicSetting\");\r\n}\r\n\r\n//グラフィック設定\r\nexport let graphicSetting = {\r\n    putShake: true,\r\n    removeShake: true,\r\n    playBackground: true,\r\n};\r\n\r\nif (localStorage.getItem(\"Pentamond3-graphicSetting\")) {\r\n    const data = Number.parseInt(localStorage.getItem(\"Pentamond3-graphicSetting\")!, 10)\r\n        .toString(2)\r\n        .split(\"\")\r\n        .map((word) => (word == \"0\" ? false : true));\r\n    for (let i = 0; 3 - data.length; i++) {\r\n        data.unshift(false);\r\n    }\r\n    graphicSetting.putShake = data[0];\r\n    graphicSetting.removeShake = data[1];\r\n    graphicSetting.playBackground = data[2];\r\n    qs(\"#putShake\" + (data[0] ? \"On\" : \"Off\")).style.color = \"#ee8888\";\r\n    qs(\"#removeShake\" + (data[1] ? \"On\" : \"Off\")).style.color = \"#ee8888\";\r\n    qs(\"#playBackground\" + (data[2] ? \"On\" : \"Off\")).style.color = \"#ee8888\";\r\n} else {\r\n    saveGraphicSetting();\r\n}\r\n\r\nfunction saveGraphicSetting() {\r\n    const data = Number.parseInt([graphicSetting.putShake ? \"1\" : \"0\", graphicSetting.removeShake ? \"1\" : \"0\", graphicSetting.playBackground ? \"1\" : \"0\"].join(\"\"), 2) + \"\";\r\n    try {\r\n        localStorage.setItem(\"Pentamond3-graphicSetting\", data);\r\n    } catch (error) {\r\n        console.error(\"何らかの理由により設定の保存に失敗しました\");\r\n    }\r\n    qs(\"#putShakeOn\").style.color = graphicSetting.putShake ? \"#ee8888\" : \"\";\r\n    qs(\"#putShakeOff\").style.color = graphicSetting.putShake ? \"\" : \"#ee8888\";\r\n    qs(\"#removeShakeOn\").style.color = graphicSetting.removeShake ? \"#ee8888\" : \"\";\r\n    qs(\"#removeShakeOff\").style.color = graphicSetting.removeShake ? \"\" : \"#ee8888\";\r\n    qs(\"#playBackgroundOn\").style.color = graphicSetting.playBackground ? \"#ee8888\" : \"\";\r\n    qs(\"#playBackgroundOff\").style.color = graphicSetting.playBackground ? \"\" : \"#ee8888\";\r\n}\r\n\r\nqsAddEvent(\"#putShakeOn\", \"click\", () => {\r\n    if (graphicSetting.putShake) {\r\n        return;\r\n    }\r\n    graphicSetting.putShake = true;\r\n});\r\nqsAddEvent(\"#putShakeOff\", \"click\", () => {\r\n    if (!graphicSetting.putShake) {\r\n        return;\r\n    }\r\n    graphicSetting.putShake = false;\r\n});\r\nqsAddEvent(\"#removeShakeOn\", \"click\", () => {\r\n    if (graphicSetting.removeShake) {\r\n        return;\r\n    }\r\n    graphicSetting.removeShake = true;\r\n});\r\nqsAddEvent(\"#removeShakeOff\", \"click\", () => {\r\n    if (!graphicSetting.removeShake) {\r\n        return;\r\n    }\r\n    graphicSetting.removeShake = false;\r\n});\r\nqsAddEvent(\"#playBackgroundOn\", \"click\", () => {\r\n    if (graphicSetting.playBackground) {\r\n        return;\r\n    }\r\n    graphicSetting.playBackground = true;\r\n});\r\nqsAddEvent(\"#playBackgroundOff\", \"click\", () => {\r\n    if (!graphicSetting.playBackground) {\r\n        return;\r\n    }\r\n    graphicSetting.playBackground = false;\r\n});\r\n\r\nqsAddEvent(\"#graphicSetting button\", \"click\", () => {\r\n    saveGraphicSetting();\r\n});\r\n\r\npageManager.addEvent([\"setPage-dataSetting\"], () => {\r\n    const dataSize = new Blob([localStorage.getItem(\"Pentamond3-replayData\") ?? \"\", localStorage.getItem(\"Pentamond3-graphicSetting\") ?? \"\"]).size;\r\n    qs(\"#dataInformation\").innerHTML = `全データの容量：${dataSize} B`;\r\n});\r\n\r\npageManager.addEvent([\"setPage-allDataDeleteAlert\"], () => {\r\n    const confirmButton = qs(\"#allDataDeleteConfirmButton\") as HTMLButtonElement;\r\n    confirmButton.disabled = true;\r\n    confirmButton.style.opacity = \"0\";\r\n    sleep(1500).then(() => {\r\n        confirmButton.disabled = false;\r\n        confirmButton.style.opacity = \"1\";\r\n    });\r\n});\r\n\r\nqsAddEvent(\"#allDataDeleteConfirmButton\", \"click\", () => {\r\n    removeAllData();\r\n    pageManager.backPages(2);\r\n    pageManager.setPage(\"dataSetting\");\r\n});\r\n"],"names":["BGM","src","loopStart","loopEnd","sourceVolume","audioData","second","volume","resolve","buffer","reversedBuffer","channel","originalData","reversedData","i","Time","contextTime","currentTime","elapsedContextTime","loopDuration","EventManager","id","handler","classNames","ids","eventId","eventIds","className","PageManager","initialPageId","element","back","pageId","layer","prevElements","nextElements","prev","length","prevIndex","next","nextIndex","pageIds","options","nextPages","page","preliminaryCurrentPage","preliminaryMaxLayer","nextPage","nextDisplayingPages","currentLayer","nextLayer","number","valid","invalidPanel","index","memory","subPages","subPageLabel","subPage","pageManager","Sound","arrayBuffer","audioBuffer","audio","sleep","ms","mixArray","array","mixCount","a","b","j","k","qsAll","selector","qs","qsAddEvent","eventName","arrayPlus","n","getMinElement","minValue","result","value","removeMousePointerTemporary","TimeManager","startImmediately","goal","LoopManager","frequency","loopCount","AutoKeyboardManager","inputData","keydownEvent","keyCode","keyupEvent","keys","time","keyCodes","arePressing","existsPressingKey","GamepadInput","axisThreshold","loop","gamepad","gp","btn","isPressed","wasPressed","isActive","wasActive","GamepadManager","e","KeyboardManager","Input","type","InputManager","input","maxInputNumber","inputManager","gameEvents","GameMode","players","operateNames","p","operateName","player","width","height","hiddenHeight","playWidth","playHeight","displayMargin","blockHeight","blockWidth","initialX","initialY","backgroundColor","blockColor","canvasGrid","mondGrid","guideBorderColor","damageTime","damageWaitingTime","damageGrace","gameTimeRate","warningGameTime","penalty","gamepadConfigPresets","debounceOperateTime","maximumTemporaryReplaySavable","canvas","ctx","Triangle","colorAnimation","triangles","playBackgroundLoop","tri","playBackground","Mode1","_","graphicSetting","playingPlayers","max","resultLabel","operate","gamepadConfigs","updateLabel","lastOperateTime","moveKeys","latestKey","pressTime","Setting.input","Setting.warningGameTime","Setting.damageWaitingTime","Setting.penalty","lastTrick","Mode2","Block","kind","direction","visible","placement","spinCorrection","moveCorrection","trickInfos","BlockManager","Setting.playWidth","x","Setting.playHeight","y","blockX","block","mond","relativeX","monoiamond","rotate","displacement","moveDirection","lineShape","trickInfo","NextManager","Monoiamond","Setting.initialX","Setting.initialY","copy","Pentiamond","m","MondOperator","ghostMond","NuisanceMondManager","blockManager","spawnCoordinates","Setting.damageTime","Setting.damageGrace","nuisanceMond","task","damageBoard","dx","dy","remove","isGrounded","CanvasManager","Setting.blockHeight","Setting.height","Setting.displayMargin","Setting.blockWidth","Setting.width","Setting.next","data","state","property","isGhost","Setting.mondGrid","Setting.blockColor","position","p1","p2","p3","Setting.backgroundColor","Setting.guideBorderColor","Setting.canvasGrid","isHold","correction","scale","InformationLabelManager","gameTime","playTime","line","chain","score","GamePlayer","animation","damageTask","Setting.gameTimeRate","LZString","f","keyStrBase64","keyStrUriSafe","baseReverseDic","getBaseValue","alphabet","character","res","compressed","uncompressed","buf","TotalLen","current_value","c","bitsPerChar","getCharFromInt","context_dictionary","context_dictionaryToCreate","context_c","context_wc","context_w","context_enlargeIn","context_dictSize","context_numBits","context_data","context_data_val","context_data_position","ii","resetValue","getNextValue","dictionary","enlargeIn","dictSize","numBits","entry","w","bits","resb","maxpower","power","module","blockKinds","numbers","replayDataEncryption","playerInputData","nextData","playerNextData","nuisanceBlockData","playerNuisanceData","data1","replayDataDecryption","encryptedData","objectData","sum","filteredInputNumber","word","pageOperateEvents","listeningInputs","focusFlag","addPageOperateEvent","manager","operateWithInput","Setting.debounceOperateTime","optionInfos","option","Setting.gamepadConfigPresets","replay","game","selectElement","getMoveElement","sx","sy","move","button","readSavedReplayData","playSetting","modeClass","gameStart","readingReplayData","createReplayData","createDetailedResult","countString","countDown","startEffectLabel","registerInputs","typeIcon","subPageController","text","text2","text3","temporaryReplayData","convertOperateName","finishTime","replayData","operateMemory","replayContainer","replayButton","now","startReplay","saveButton","saveReplayData","Setting.maximumTemporaryReplaySavable","parsedData","container","replayContainers","replayButtons","deleteButtons","deleteButton","confirmButton","reject","resolveFunc","rejectFunc","removeReplayData","dataArray","removeAllData","saveGraphicSetting","dataSize"],"mappings":"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","x_google_ignoreList":[30]}